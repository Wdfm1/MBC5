 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 VERSION =   3.00      foxpro.h      dataenvironment      dataenvironment      Dataenvironment      ÅTop = -18
Left = -24
Width = 1584
Height = 723
InitialSelectedAlias = "cust"
DataSource = .NULL.
Name = "Dataenvironment"
      cursor      cursor      Cursor2      Dataenvironment      ¶Top = 286
Left = 674
Height = 198
Width = 91
Alias = "datecont"
BufferModeOverride = 3
Database = m:\mbc5\mbc.dbc
CursorSource = "datecont"
Name = "Cursor2"
      cursor      cursor      Cursor3      Dataenvironment      ãTop = 5
Left = 454
Height = 90
Width = 90
Alias = "contpstn"
Database = m:\mbc5\mbc.dbc
CursorSource = "contpstn"
Name = "Cursor3"
      cursor      cursor      Cursor5      Dataenvironment      çTop = 126
Left = 554
Height = 90
Width = 90
Alias = "refertbl"
Database = m:\mbc5\mbc.dbc
CursorSource = "refertbl"
Name = "Cursor5"
      cursor      cursor      Cursor6      Dataenvironment      ãTop = 7
Left = 253
Height = 90
Width = 90
Alias = "schgrade"
Database = m:\mbc5\mbc.dbc
CursorSource = "schgrade"
Name = "Cursor6"
      cursor      cursor      Cursor9      Dataenvironment      ßTop = 706
Left = 1424
Height = 217
Width = 91
Alias = "shipping"
BufferModeOverride = 3
Database = m:\mbc5\mbc.dbc
CursorSource = "shipping"
Name = "Cursor9"
      cursor      cursor      Cursor10      Dataenvironment      éTop = 127
Left = 453
Height = 90
Width = 90
Alias = "itemshpd"
Database = m:\mbc5\mbc.dbc
CursorSource = "itemshpd"
Name = "Cursor10"
      cursor      cursor      Cursor11      Dataenvironment      äTop = 5
Left = 352
Height = 90
Width = 90
Alias = "shipper"
Database = m:\mbc5\mbc.dbc
CursorSource = "shipper"
Name = "Cursor11"
      cursor      cursor      Cursor12      Dataenvironment      äTop = 5
Left = 560
Height = 90
Width = 90
Alias = "shpprty"
Database = m:\mbc5\mbc.dbc
CursorSource = "shpprty"
Name = "Cursor12"
      cursor      cursor      Cursor14      Dataenvironment      àTop = 7
Left = 152
Height = 90
Width = 90
Alias = "vendor"
Database = m:\mbc5\mbc.dbc
CursorSource = "vendor"
Name = "Cursor14"
      cursor      cursor      Cursor15      Dataenvironment      çTop = 520
Left = 1087
Height = 90
Width = 91
Alias = "produtn"
Database = m:\mbc5\mbc.dbc
CursorSource = "produtn"
Name = "Cursor15"
      cursor      cursor      Cursor16      Dataenvironment      ãTop = 288
Left = 828
Height = 187
Width = 91
Alias = "covers"
Database = m:\mbc5\mbc.dbc
CursorSource = "covers"
Name = "Cursor16"
      cursor      cursor      Cursor17      Dataenvironment      ÑTop = 755
Left = 242
Height = 90
Width = 90
Alias = "wip"
Database = m:\mbc5\mbc.dbc
CursorSource = "wip"
Name = "Cursor17"
      cursor      cursor      Cursor18      Dataenvironment      ÜTop = 602
Left = 166
Height = 90
Width = 91
Alias = "wipg"
Database = m:\mbc5\mbc.dbc
CursorSource = "wipg"
Name = "Cursor18"
      cursor      cursor      Cursor20      Dataenvironment      |Top = 128
Left = 350
Height = 90
Width = 90
Alias = "shiptype"
CursorSource = m:\mbc5\shiptype.dbf
Name = "Cursor20"
      cursor      cursor      Cursor21      Dataenvironment      £Top = 26
Left = 35
Height = 90
Width = 91
Alias = "upslist"
BufferModeOverride = 3
Order = "schcode"
CursorSource = m:\mbc5\upslist.dbf
Name = "Cursor21"
      cursor      cursor      Cursor22      Dataenvironment      àTop = 31
Left = 1123
Height = 90
Width = 91
Alias = "recv2"
Database = m:\mbc5\mbc.dbc
CursorSource = "recv2"
Name = "Cursor22"
      cursor      cursor      Cursor23      Dataenvironment      èTop = 16
Left = 998
Height = 90
Width = 91
Alias = "custstat"
Order = "custstat"
CursorSource = m:\mbc5\custstat.dbf
Name = "Cursor23"
      cursor      cursor      Cursor24      Dataenvironment      {Top = 133
Left = 1431
Height = 90
Width = 91
Alias = "coverlk"
CursorSource = m:\mbc5\coverlk.dbf
Name = "Cursor24"
      cursor      cursor      Cursor26      Dataenvironment      éTop = 302
Left = 469
Height = 90
Width = 91
Alias = "ordagree"
Database = m:\mbc5\mbc.dbc
CursorSource = "ordagree"
Name = "Cursor26"
      cursor      cursor      Cursor27      Dataenvironment      åTop = 126
Left = 147
Height = 90
Width = 91
Alias = "actvlook"
CursorSource = m:\mbc5\actvlook.dbf
ReadOnly = .F.
Name = "Cursor27"
      cursor      cursor      Cursor28      Dataenvironment      yTop = 8
Left = 1426
Height = 90
Width = 91
Alias = "custsrc"
CursorSource = m:\mbc5\custsrc.dbf
Name = "Cursor28"
      cursor      cursor      Cursor29      Dataenvironment      zTop = 695
Left = 518
Height = 90
Width = 91
Alias = "qtetemp"
CursorSource = m:\mbc5\qtetemp.dbf
Name = "Cursor29"
      cursor      cursor      Cursor30      Dataenvironment      àTop = 25
Left = 1273
Height = 90
Width = 91
Alias = "surv2"
Database = m:\mbc5\mbc.dbc
CursorSource = "surv2"
Name = "Cursor30"
      cursor      cursor      Cursor31      Dataenvironment      |Top = 784
Left = 366
Height = 90
Width = 91
Alias = "typelkup"
CursorSource = m:\mbc5\typelkup.dbf
Name = "Cursor31"
      cursor      cursor      Cursor32      Dataenvironment      |Top = 125
Left = 667
Height = 90
Width = 91
Alias = "dayslkup"
CursorSource = m:\mbc5\dayslkup.dbf
Name = "Cursor32"
      cursor      cursor      Cursor7      Dataenvironment      çTop = 741
Left = 704
Height = 90
Width = 91
Alias = "endsheet"
Database = m:\mbc5\mbc.dbc
CursorSource = "endsheet"
Name = "Cursor7"
      cursor      cursor      Cursor8      Dataenvironment      yTop = 157
Left = 787
Height = 90
Width = 91
Alias = "pltform"
CursorSource = m:\mbc5\pltform.dbf
Name = "Cursor8"
      cursor      cursor      Cursor33      Dataenvironment      ãTop = 13
Left = 882
Height = 90
Width = 91
Alias = "lkpschtype"
Order = ""
CursorSource = m:\mbc5\lkpschtype.dbf
Name = "Cursor33"
      cursor      cursor      Cursor34      Dataenvironment      åTop = 9
Left = 663
Height = 90
Width = 91
Alias = "lkpmultiyroptions"
CursorSource = m:\mbc5\lkpmultiyroptions.dbf
Name = "Cursor34"
      cursor      cursor      Cursor35      Dataenvironment      üTop = 512
Left = 1230
Height = 243
Width = 130
Alias = "xsupplies"
Order = ""
Database = m:\mbc5\mbc.dbc
CursorSource = "xsupplies"
Name = "Cursor35"
      cursor      cursor      Cursor36      Dataenvironment      ~Top = 869
Left = 870
Height = 90
Width = 91
Alias = "lkpxitems"
CursorSource = m:\mbc5\lkpxitems.dbf
Name = "Cursor36"
      cursor      cursor      Cursor38      Dataenvironment      ¿Top = 668
Left = 891
Height = 90
Width = 90
Alias = "lkppromotions"
Order = "ord"
CursorSource = m:\mbc5\lkppromotions.dbf
Filter = 'company="MER" or company="SYS"'
Name = "Cursor38"
      cursor      cursor      Cursor37      Dataenvironment      åTop = 268
Left = 384
Height = 90
Width = 90
Alias = "mktinfo"
Database = m:\mbc5\mbc.dbc
CursorSource = "mktinfo"
Name = "Cursor37"
      cursor      cursor      Cursor4      Dataenvironment      áTop = 304
Left = 18
Height = 365
Width = 90
Alias = "mcust"
Database = m:\mbc5\mbc.dbc
CursorSource = "mcust"
Name = "Cursor4"
      cursor      cursor      Cursor19      Dataenvironment      éTop = 303
Left = 148
Height = 180
Width = 166
Alias = "mquotes"
Database = m:\mbc5\mbc.dbc
CursorSource = "mquotes"
Name = "Cursor19"
      relation      relation      	Relation1      Dataenvironment      àParentAlias = "mcust"
RelationalExpr = "schcode"
ChildAlias = "mquotes"
ChildOrder = "schcode"
OneToMany = .T.
Name = "Relation1"
      relation      relation      	Relation2      Dataenvironment      âParentAlias = "mcust"
RelationalExpr = "schcode"
ChildAlias = "datecont"
ChildOrder = "schcode"
OneToMany = .T.
Name = "Relation2"
      relation      relation      	Relation3      Dataenvironment      wParentAlias = "mcust"
RelationalExpr = "schcode"
ChildAlias = "mktinfo"
ChildOrder = "schcode"
Name = "Relation3"
      relation      relation      	Relation4      Dataenvironment      xParentAlias = "mcust"
RelationalExpr = "schcode"
ChildAlias = "shipping"
ChildOrder = "schcode"
Name = "Relation4"
      relation      relation      	Relation5      Dataenvironment      tParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "covers"
ChildOrder = "invno"
Name = "Relation5"
      relation      relation      	Relation6      Dataenvironment      rParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "wipg"
ChildOrder = "invno"
Name = "Relation6"
      relation      relation      	Relation7      Dataenvironment      uParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "produtn"
ChildOrder = "invno"
Name = "Relation7"
      relation      relation      	Relation8      Dataenvironment      vParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "ordagree"
ChildOrder = "invno"
Name = "Relation8"
      cursor      cursor      Cursor1      Dataenvironment      Top = 20
Left = 10
Height = 90
Width = 90
Alias = "mercategory"
CursorSource = m:\mbc5\mercategory.dbf
Name = "Cursor1"
      cursor      cursor      Cursor13      Dataenvironment      óTop = 153
Left = 1267
Height = 90
Width = 90
Alias = "lkpleadsource"
Order = "name"
CursorSource = m:\mbc5\lkpleadsource.dbf
Name = "Cursor13"
      cursor      cursor      Cursor25      Dataenvironment      ÅTop = 20
Left = 749
Height = 90
Width = 90
Alias = "lkpgradelev"
CursorSource = m:\mbc5\lkpgradelev.dbf
Name = "Cursor25"
      cursor      cursor      Cursor39      Dataenvironment      ~Top = 20
Left = 10
Height = 90
Width = 90
Alias = "lkpjosname"
CursorSource = m:\mbc5\lkpjosname.dbf
Name = "Cursor39"
      relation      relation      	Relation9      Dataenvironment      qParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "wip"
ChildOrder = "invno"
Name = "Relation9"
      relation      relation      
Relation10      Dataenvironment      wParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "endsheet"
ChildOrder = "invno"
Name = "Relation10"
      cursor      cursor      Cursor40      Dataenvironment      íTop = 523
Left = 624
Height = 90
Width = 90
Alias = "merinvoice"
Database = m:\mbc5\mbc.dbc
CursorSource = "merinvoice"
Name = "Cursor40"
      relation      relation      
Relation11      Dataenvironment      yParentAlias = "mquotes"
RelationalExpr = "invno"
ChildAlias = "merinvoice"
ChildOrder = "invno"
Name = "Relation11"
      cursor      cursor      Cursor41      Dataenvironment      ñTop = 380
Left = 990
Height = 90
Width = 90
Alias = "merinvdetail"
Database = m:\mbc5\mbc.dbc
CursorSource = "merinvdetail"
Name = "Cursor41"
      relation      relation      
Relation12      Dataenvironment      ~ParentAlias = "merinvoice"
RelationalExpr = "invno"
ChildAlias = "merinvdetail"
ChildOrder = "invno"
Name = "Relation12"
      54      2      frmmaint      ..\..\common60\baseform.vcx      form      SCHOOLS     ,DataSession = 2
Top = 40
Left = 257
Height = 671
Width = 975
ScrollBars = 3
DoCreate = .T.
Comment = ""
ShowTips = .T.
BufferMode = 2
Caption = "MeridianSchools Entry/Edit"
Closable = .F.
MinHeight = 0
MinWidth = 965
WindowType = 0
WindowState = 0
BackColor = 221,249,230
custid = ""
sessid = ""
invid = 0
oldcyear = ''
telelog = .F.
primarytable = mcust
ctoolbar = tbrbasenav
company = MER
Name = "SCHOOLS"
Pgfbase1.ErasePage = .T.
Pgfbase1.Page1.Caption = "School"
Pgfbase1.Page1.BackColor = 221,249,230
Pgfbase1.Page1.ToolTipText = ""
Pgfbase1.Page1.Name = "Page1"
Pgfbase1.Page2.Caption = "Contact"
Pgfbase1.Page2.BackColor = 221,249,230
Pgfbase1.Page2.Name = "Page2"
Pgfbase1.Page3.FontBold = .F.
Pgfbase1.Page3.Caption = "Telephone"
Pgfbase1.Page3.BackColor = 221,249,230
Pgfbase1.Page3.Name = "Page3"
Pgfbase1.Page4.Caption = " Supplies"
Pgfbase1.Page4.Name = "Page4"
Pgfbase1.Page5.Caption = "Invoice Address"
Pgfbase1.Page5.BackColor = 221,249,230
Pgfbase1.Page5.Name = "Page5"
Pgfbase1.Page6.Caption = "Shipping"
Pgfbase1.Page6.BackColor = 221,249,230
Pgfbase1.Page6.Name = "Page6"
Pgfbase1.Page7.Name = "Page7"
Pgfbase1.Anchor = 11
Pgfbase1.Top = 2
Pgfbase1.Left = 3
Pgfbase1.Width = 957
Pgfbase1.Height = 658
Pgfbase1.Themes = .F.
Pgfbase1.Name = "Pgfbase1"
     ºwPROCEDURE schoolsrch
SELECT mcust

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE



thisform.ckchng
define window jbrowser from 15,5 to 23,100;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to schname
sele mquotes
set order to schcode
sele mcust
set skip to mquotes
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("U","","Search For: ")

brow window jbrowser fiel mcust.schname:35,mcust.schcity:13,mcust.schstate:4,contryear,mquotes.prodno:11:;
H="Production #" nodelete noappend nomenu noedit


=jkeycanc()
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
sele mcust
set orde to schcode
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase
	
ENDPROC
PROCEDURE prodsrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE


	thisform.ckchng
DEFINE window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
SELE mquotes
SET order to prodno
_jexitkey=13
_jdblclick=-1
STORE -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk
=jkeyinit("A","","Search For: ")
BROW window jbrowser fiel prodno,schname,contryear,invno,schcode noedit nodelete
=jkeycanc()

m.schcode=mquotes.schcode
m.invno=mquotes.invno
SELE mquotes
SET order to schcode
SELE mcust
SET order to schcode
SET skip to mquotes
SEEK m.schcode

thisform.refresh
TRY
thisform.pgfbase1.page1.grdQuotes.SetFocus
CATCH

ENDTRY
SELECT mquotes
LOCATE FOR mquotes.invno=m.invno
thisform.invid=m.invno &&do not set above or esle invno is changed in another event
Release wind jbrowser
thisform.custid=m.schcode
*thisform.invid=mquotes.invno

*thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
*sele mcust
*set order to schname

thisform.refresh
ENDCASE

ENDPROC
PROCEDURE citysrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to schcity
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")
*on key label leftmouse do i_dblclk
brow window jbrowser fiel schcity:15,contryear,mquotes.prodno:11:;
H="Production #",schname,schzip,schcity,schcode noedit nodelete

*on key label leftmouse
=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase
	
ENDPROC
PROCEDURE zipsrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to schzip
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")

brow window jbrowser fiel schzip:10,schname:20,mquotes.prodno:11:;
H="Production #",schcity,schcode noedit nodelete


=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase
	
ENDPROC
PROCEDURE fstsrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
	OTHERWISE		
	
thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to contfname
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")
*on key label leftmouse do i_dblclk
brow window jbrowser fiel contfname:15,contlname:15,contryear,mquotes.prodno:11:;
H="Production #",schname,schcity,schcode noedit nodelete

*on key label leftmouse
=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
endcase	
ENDPROC
PROCEDURE lstsrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE


thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to contlname
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")
*on key label leftmouse do i_dblclk
brow window jbrowser fiel contlname:15,contfname:15,contryear,mquotes.prodno:11:;
H="Production #",schname,schcity,schcode noedit nodelete

*on key label leftmouse
=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh

thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase	
ENDPROC
PROCEDURE codesrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
otherwise


thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to schcode
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")
*on key label leftmouse do i_dblclk
brow window jbrowser fiel schcode,contryear,mquotes.prodno:11:;
H="Production #",schname,schcity,schzip noedit nodelete

*on key label leftmouse
=jkeycanc()
*set order to schname
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0

thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase	
ENDPROC
PROCEDURE ckchng
local uCust,uCntCust,nCntCust,lCustChng,uCont,uCntCont,nCntCont,lContChng,;
uShip,uCntShip,nCntShip,lShipChng
set multilocks on
nCntCust=1
lCustChng=.f.
nCntCont=1
lContChng=.f.
nCntShip=1
lShipChng=.f.
sele mcust

uCust=GetFldState(-1,"mcust")
uCntCust=Fcount("mcust")
for nCntCust=1 to uCntCust
if substr(uCust,nCntCust,1)<>"1"
lCustChng=.t.

exit
endif
endfor
sele datecont
uCont=GetFldState(-1,"datecont")
uCntCont=Fcount("datecont")
for nCntCont=1 to uCntCont
if substr(uCont,nCntCont,1)<>"1"
lContChng=.t.
exit
endif
endfor

sele shipping
uShip=GetFldState(-1,"Shipping")
uCntShip=Fcount("Shipping")
for nCntShip=1 to uCntShip
if substr(uShip,nCntShip,1)<>"1"
lShipChng=.t.
exit
endif
endfor

if lCustChng=.t.

thisform.upsupdte
*!*	endif
sele mcust
=tableupdate(.t.)
thisform.updatemysqlcust
ENDIF

if lContChng=.t.
sele datecont
=tableupdate(.t.)
endif

if lShipChng=.t.
sele shipping
=tableupdate(.t.)
endif

sele mcust


ENDPROC
PROCEDURE upsupdte
* Run in m:\mbc5 directory
*use upslist order tag schcode of upslist in 0 share

m.schsrch=mcust.schcode+'Y'
sele upslist
seek m.schsrch
if !found()
append blank
repl upslist.schcode with m.schsrch
endif

	repl upslist.name with ALLTRIM(mcust.schname)
	repl upslist.attn with alltrim(mcust.shpname)
	repl upslist.add1 with mcust.shpaddr
	repl upslist.add2 with mcust.shpaddr2
	repl upslist.city with mcust.shpcity
	repl upslist.state with mcust.shpstate
	repl upslist.zip with substr(mcust.shpzip,1,5)
	repl upslist.fax with space(10)
	repl upslist.option1 with .f.
	repl upslist.type1 with space(5)
	if !isblank(mcust.contemail) .or. !isblank(mcust.schemail)
	repl upslist.option2 with .t.
	repl upslist.type2 with 'email'
	if !isblank(mcust.contemail)
	repl upslist.email with mcust.contemail
	else
	repl upslist.email with mcust.schemail
	endif
	else
	repl upslist.email with space(40)
	repl upslist.option2 with .f.
	repl upslist.type2 with space(5)
	endif
	if isblank(mcust.svdesc1)
	repl upslist.svdesc with "Ground"
	else
	repl upslist.svdesc with mcust.svdesc1
	endif
*!*		endif

m.schsrch=mcust.schcode+'K'
seek m.schsrch
if !found()
append blank
repl upslist.schcode with m.schsrch
endif

	repl upslist.name with mcust.schname
	repl upslist.attn with alltrim(mcust.shpname)
	repl upslist.add1 with mcust.shpaddr
	repl upslist.add2 with mcust.shpaddr2
	repl upslist.city with mcust.shpcity
	repl upslist.state with mcust.shpstate
	repl upslist.zip with substr(mcust.shpzip,1,5)
	repl upslist.fax with space(10)
	repl upslist.option1 with .f.
	repl upslist.type1 with space(5)
	if !isblank(mcust.contemail) .or. !isblank(mcust.schemail)
	repl upslist.option2 with .t.
	repl upslist.type2 with 'email'
	if !isblank(mcust.contemail)
	repl upslist.email with mcust.contemail
	else
	repl upslist.email with mcust.schemail
	endif
	else
	repl upslist.email with space(40)
	repl upslist.option2 with .f.
	repl upslist.type2 with space(5)
	endif
	if isblank(mcust.svdesc2)
	repl upslist.svdesc with "Ground"
	else
	repl upslist.svdesc with mcust.svdesc2
	endif
*!*	endif		
sele upslist
valtable=tableupdate()

if produtn.vendcd='BON' .OR. produtn.vendcd='BN4'
*if substr(produtn.prodno,1,2)='S5'
thisform.boonupdt
endif
ENDPROC
PROCEDURE stesrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault	
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to schstate
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("U","","Search For: ")

brow window jbrowser fiel schstate:15,schname:20,mquotes.prodno:11:;
H="Production #",schcity,schcode,csrep noedit nodelete

=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase	
ENDPROC
PROCEDURE boonupdt
* Run in m:\mbc5 directory
*use boonlist order tag schcode of boonlist in 0 share
m.schsrch=mcust.schcode+'Y'
sele boonlist
set orde to schcode
seek m.schsrch
if !found()
append blank
repl boonlist.schcode with m.schsrch
endif

if upper(mcust.yb_sth)='Y'
	repl boonlist.name with "Residence"
	repl boonlist.attn with alltrim(mcust.contfname)+" "+alltrim(mcust.contlname)
	repl boonlist.add1 with mcust.contaddr
	repl boonlist.add2 with mcust.contaddr2
	repl boonlist.city with mcust.contcity
	repl boonlist.state with mcust.contstate
	repl boonlist.zip with substr(mcust.contzip,1,5)
	repl boonlist.fax with space(10)
	repl boonlist.option1 with 'N'
	repl boonlist.type1 with space(5)
	if !isblank(mcust.contemail) .or. !isblank(mcust.schemail)
	repl boonlist.option2 with 'Y'
	repl boonlist.type2 with 'email'
	if !isblank(mcust.contemail)
	repl boonlist.email with mcust.contemail
	else
	repl boonlist.email with mcust.schemail
	endif
	else
	repl boonlist.email with space(40)
	repl boonlist.option2 with 'N'
	repl boonlist.type2 with space(5)
	endif
	
	if isblank(mcust.svdesc1)
	repl boonlist.svdesc with "Ground"
	else
	repl boonlist.svdesc with mcust.svdesc1
	endif
else
	repl boonlist.name with mcust.schname
	repl boonlist.attn with alltrim(mcust.contfname)+" "+alltrim(mcust.contlname)
	repl boonlist.add1 with mcust.schaddr
	repl boonlist.add2 with mcust.schaddr2
	repl boonlist.city with mcust.schcity
	repl boonlist.state with mcust.schstate
	repl boonlist.zip with substr(mcust.schzip,1,5)
	repl boonlist.fax with space(10)
	repl boonlist.option1 with 'N'
	repl boonlist.type1 with space(5)
	if !isblank(mcust.contemail) .or. !isblank(mcust.schemail)
	repl boonlist.option2 with 'Y'
	repl boonlist.type2 with 'email'
	if !isblank(mcust.contemail)
	repl boonlist.email with mcust.contemail
	else
	repl boonlist.email with mcust.schemail
	endif
	else
	repl boonlist.email with space(40)
	repl boonlist.option2 with 'N'
	repl boonlist.type2 with space(5)
	endif
	if isblank(mcust.svdesc1)
	repl boonlist.svdesc with "Ground"
	else
	repl boonlist.svdesc with mcust.svdesc1
	endif
	endif

m.schsrch=mcust.schcode+'K'
seek m.schsrch
if !found()
append blank
repl boonlist.schcode with m.schsrch
endif
if upper(mcust.shiptocont)='Y'
	repl boonlist.name with "Residence"
	repl boonlist.attn with alltrim(mcust.contfname)+" "+alltrim(mcust.contlname)
	repl boonlist.add1 with mcust.contaddr
	repl boonlist.add2 with mcust.contaddr2
	repl boonlist.city with mcust.contcity
	repl boonlist.state with mcust.contstate
	repl boonlist.zip with substr(mcust.contzip,1,5)
	repl boonlist.fax with space(10)
	repl boonlist.option1 with 'N'
	repl boonlist.type1 with space(5)
	if !isblank(mcust.contemail) .or. !isblank(mcust.schemail)
	repl boonlist.option2 with 'Y'
	repl boonlist.type2 with 'email'
	if !isblank(mcust.contemail)
	repl boonlist.email with mcust.contemail
	else
	repl boonlist.email with mcust.schemail
	endif
	else
	repl boonlist.email with space(40)
	repl boonlist.option2 with 'N'
	repl boonlist.type2 with space(5)
	endif
	if isblank(mcust.svdesc2)
	repl boonlist.svdesc with "Ground"
	else
	repl boonlist.svdesc with mcust.svdesc2
	endif
else
	repl boonlist.name with mcust.schname
	repl boonlist.attn with alltrim(mcust.contfname)+" "+alltrim(mcust.contlname)
	repl boonlist.add1 with mcust.schaddr
	repl boonlist.add2 with mcust.schaddr2
	repl boonlist.city with mcust.schcity
	repl boonlist.state with mcust.schstate
	repl boonlist.zip with substr(mcust.schzip,1,5)
	repl boonlist.fax with space(10)
	repl boonlist.option1 with 'N'
	repl boonlist.type1 with space(5)
	if !isblank(mcust.contemail) .or. !isblank(mcust.schemail)
	repl boonlist.option2 with 'Y'
	repl boonlist.type2 with 'email'
	if !isblank(mcust.contemail)
	repl boonlist.email with mcust.contemail
	else
	repl boonlist.email with mcust.schemail
	endif
	else
	repl boonlist.email with space(40)
	repl boonlist.option2 with 'N'
	repl boonlist.type2 with space(5)
	endif
	if isblank(mcust.svdesc2)
	repl boonlist.svdesc with "Ground"
	else
	repl boonlist.svdesc with mcust.svdesc2
	endif
endif		
*sele boonlist
*=tableupdate()

ENDPROC
PROCEDURE bfstrsrch
*This method finds the 2nd advisors first name after checking that a phone log has been made or is needed

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to bcontfname
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")
*on key label leftmouse do i_dblclk
brow window jbrowser fiel bcontfname:15,bcontlname:15,contryear,mquotes.prodno:11:;
H="Production #",schname,schcity,schcode noedit nodelete

*on key label leftmouse
=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase	
ENDPROC
PROCEDURE blstsrch

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
		
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to bcontlname
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")
*on key label leftmouse do i_dblclk
brow window jbrowser fiel bcontlname:15,bcontfname:15,contryear,mquotes.prodno:11:;
H="Production #",schname,schcity,schcode noedit nodelete

*on key label leftmouse
=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase	
ENDPROC
PROCEDURE novalueinlkp
m.refby=alltrim(mcust.refby)
recordnothere=.t.
cexact=set("EXACT")
set exact on
use refertbl again in 0 alias tmprefertbl &&open another instance of table so record is not changed on combo during search
select tmprefertbl
scan for alltrim(tmprefertbl.refby)=m.refby
recordnothere=.f.
endscan
set exact &cexact
use 
return recordnothere
ENDPROC
PROCEDURE nxtcontdate
PARAMETERS ntime

replace datecont.nxtdate WITH DATE()+ntime
thisform.Refresh 
ENDPROC
PROCEDURE prntaddresslabels
SELECT mcust
TABLEUPDATE(.t.,.t.) && make sure all data is saved before printing
m.sid=thisform.custid

cprintername= getprinter()
	IF !empty(cprintername)
		SET printer to name (cprintername)
		label form dymo1 to prin for mcust.schcode=m.sid noconsole 
        set printer to default
	ELSE
		MESSAGEBOX("No printer has been selected.",16,"No Printer")
	ENDIF
set printer to default




		 
        
	
ENDPROC
PROCEDURE getprodno
If ! Used('prodnum')
				Use prodnum In 0
			Endif
			Sele prodnum
			Repl prodnum.lstprodno With prodnum.lstprodno+1
			retval=Str(prodnum.lstprodno,5)

			If Used('prodnum')
				Sele prodnum
				Use
			ENDIF
			RETURN retval
ENDPROC
PROCEDURE getcovernum
LOCAL msrch,msrch1

IF !USED("spcover")
USE spcover IN 0
ENDIF
SELECT spcover
	Repl spcover.speccvno With spcover.speccvno+1
	msrch1=spcover.speccvno
	msrch=Str(msrch1,5)
	Use covers In 0 Again Alias secover Order specovr
	Sele secover
	Seek msrch
	If Found()
	DO WHILE FOUND()&& make sure cover number is unique
	msrch1=msrch1+1
	replace spcover.speccvno WITH msrch1 &&correct covernumber table
	msrch=Str(msrch1,5)
	Sele secover
	Seek msrch
	enddo	
	ENDIF
	Sele secover
	Use
	RETURN msrch
	
*repl COVERS.PRTVEND with vendor.vendcd
*!*			Repl covers.specovr With Str(spcover.speccvno,4)
*!*			Repl produtn.prodno With Substr(produtn.prodno,1,7)+Str(spcover.speccvno,4)
*!*			Repl quotes.prodno With Substr(produtn.prodno,1,7)+Str(spcover.speccvno,4)
*!*			Repl produtn.speccover With Str(spcover.speccvno,4)
*!*			Sele produtn
ENDPROC
PROCEDURE prntenvelope
SELECT mcust
repo form menvel to prin for mcust.schcode=thisform.custid
LOCATE FOR mcust.schcode=thisform.custid &&make sure record is on correct line
thisform.Refresh 
ENDPROC
PROCEDURE printpkglist

PARAMETERS ptype,schname

#include registry.h
*on erro do errhandler with ERROR( ), MESSAGE( ), MESSAGE(1), PROGRAM( ), LINENO( ),alias()

if !used('mbidsinvoice')
use c:\mbc5\mbidsinvoice in 0 excl
ENDIF
if used('mbidsinvoice')
sele mbidsinvoice
dele all
pack
*!*	use
ENDIF
if !used('bidinvdetail')
use c:\mbc5\mbidsinvdetail in 0 excl
endif
if used('mbidsinvdetail')
sele mbidsinvdetail
dele all
pack
*!*	use
endif
SELECT mquotes
scatter memvar memo
 
m.invno=111111&&just so I can create a relation ship in the report, record is deleted each time so I don't need to worry about being unique
m.schcode=mquotes.schcode
m.schtype=mquotes.SCHTYPE
IF INLIST(m.schtype,"PERS FOLDERS","STD FOLDERS")
m.folder=.t.
ELSE
m.folder=.f.
endif
m.qtedate=mquotes.qtedate
m.nopages=mquotes.nopages
m.nostcopies=mquotes.qtystud
m.notecopies=mquotes.qtyteacher
m.book_ea=mquotes.fplnprc
m.source=mquotes.source
m.ponum=mquotes.ponum
m.invtot=mquotes.fplntot
m.baldue=mquotes.adjbef

&&addrr_______________________________________
&&bill to
m.invaddnote=mcust.invnotes &&address notes

m.invname=mcust.invname
m.invaddr=mcust.invaddr
m.invaddr2=mcust.invaddr2
m.invcity=mcust.invcity
m.invstate=mcust.invstate
m.invzip=mcust.invzip
&&ship to
m.shpname=mcust.shpname
m.contfname=mcust.contfname
m.contlname=mcust.contlname
m.schname=mcust.schname
m.schaddr=mcust.shpaddr
m.schaddr2=mcust.shpaddr2
m.schcity=mcust.shpcity
m.schstate=mcust.shpstate
m.generic=mquotes.generic
m.schzip=mcust.shpzip
&&__________________________________________________________________
m.contryear=mquotes.contryear
m.basetot=mquotes.qtystud*mquotes.baseprc
m.baseprc=mquotes.baseprc
m.tebaseprc=mquotes.baseprc+(mquotes.teachedtprc/mquotes.teachedtqty)
m.tebasetot=m.tebaseprc*mquotes.teachedtqty
m.formattype=IIF(mquotes.sf=.t.,"Small Format","Large Format")
m.dteschstar=mcust.dteschstart
m.asbtot=mquotes.afterdisctot
m.sbtot=mquotes.sbtot
m.erldiscamt =mquotes.erldiscamt
m.dp1 =ALLTRIM(STR(mquotes.dp1*100))+"% Discount"
m.desc1=mquotes.desc1
m.desc1amt=mquotes.desc1amt
m.desc2=mquotes.desc2
m.descamt=mquotes.descamt


m.desc3amt=mquotes.desc3amt
m.desc3=mquotes.desc3
m.desc4amt=mquotes.desc4amt
m.desc4=mquotes.desc4

m.salestx=mquotes.salestx
m.shpphndl=mquotes.shpphndl
m.afttxadjde="" &&mquotes.afttxadjde
m.afttxadj=0 &&mquotes.afttxadj

sele mbidsinvoice
insert into mbidsinvoice from memvar

SELECT mbidsinvdetail



if mquotes.hallpqty>0
m.descr='Hall Pass per Planner(' + ALLTRIM(STR(mquotes.hallpqty)) +') * No. of Students('+ ALLTRIM(STR(m.nostcopies))+')' 
m.qty=mquotes.hallpqty * m.nostcopies 
m.price=mquotes.hallpprice
m.unitprice=mquotes.hallpprice/(mquotes.hallpqty*mquotes.qtystud)
insert into mbidsinvdetail from memvar

endif

if mquotes.bmarkqty>0
m.descr='Book Mark'
m.qty=mquotes.bmarkqty
m.price=mquotes.bmarkprc
m.unitprice=mquotes.bmarkprc/mquotes.bmarkqty
insert into mbidsinvdetail from memvar

endif

if mquotes.vpaqty>0
m.descr='Vinyl Pocket A'
m.price=mquotes.vpprc
m.qty=mquotes.vpaqty
m.unitprice=mquotes.vpprc/mquotes.vpaqty
insert into mbidsinvdetail from memvar

endif

if mquotes.vpbqty>0
m.descr='Vinyl Pocket B'
m.price=mquotes.vpbprc
m.qty=mquotes.vpbqty
m.unitprice=mquotes.vpbprc/mquotes.vpbqty
insert into mbidsinvdetail from memvar
m.qty=0
endif

if mquotes.idpouchqty>0
m.descr='Id Pouch'
m.price=mquotes.idpouchprc
m.qty=mquotes.idpouchqty
m.unitprice=mquotes.idpouchprc/mquotes.idpouchqty
insert into mbidsinvdetail from memvar
m.qty=0
endif

if mquotes.stdtitpgqty>0
m.descr='Standard Title Page'
m.price=mquotes.stdtitpgprc
m.qty=mquotes.stdtitpgqty
m.unitprice=mquotes.stdtitpgprc/mquotes.stdtitpgqty
insert into mbidsinvdetail from memvar
m.qty=0
endif

if mquotes.duraglzqty>0
m.descr='Duraglaze Cover'
m.price=mquotes.duraglzprc
m.qty=mquotes.duraglzqty
m.unitprice=mquotes.duraglzprc/mquotes.duraglzqty
insert into mbidsinvdetail from memvar
m.qty=0
endif

if mquotes.wallchqty>0
m.descr='Elementary Wall Chart'
m.price=mquotes.wallchprc
m.qty=mquotes.wallchqty
m.unitprice=mquotes.wallchprc/mquotes.wallchqty
insert into mbidsinvdetail from memvar
m.qty=0
endif

*!*	if mquotes.teachedtqty>0
*!*	m.descr='Teacher Edition'
*!*	m.price=mquotes.teachedtprc
*!*	m.qty=mquotes.teachedtqty
*!*	m.unitprice=mquotes.teachedtprc/mquotes.teachedtqty
*!*	insert into mbidsinvdetail from memvar
*!*	m.qty=0
*!*	endif

if mquotes.typesetqty>0
m.descr='Typesetting Service'
m.price=mquotes.typesetprc
m.qty=mquotes.typesetqty
m.unitprice=mquotes.typesetprc/mquotes.typesetqty
insert into mbidsinvdetail from memvar
m.qty=0
endif

if mquotes.impguidqty>0
m.descr='Implementation Guides'
m.price=0.00
m.qty=mquotes.impguidqty
m.unitprice=0.00
insert into mbidsinvdetail from memvar
m.qty=0
endif




&&discount\charges before subtotal
if mquotes.misc<>0
m.descr=mquotes.mdesc
m.price=mquotes.misc
insert into mbidsinvdetail from memvar

else
if .not. empty(mquotes.mdesc)
m.descr=mquotes.mdesc
m.price=0
insert into mbidsinvdetail from memvar

endif
ENDIF


DO case
CASE mquotes.fourclr=.t.
numclrs="Four Colors"
CASE mquotes.threeclr=.t.
numclrs="Three Colors"
CASE mquotes.twoclr=.t.
numclrs="Two Colors"
CASE mquotes.oneclr=.t.
numclrs="One Color"
otherwise
numclrs=""
ENDCASE


m.descr='Cover - '+IIF(!EMPTY(numclrs)," "+numclrs,"")
m.price=mquotes.cvrtotprc
IF !EMPTY(numclrs)
insert into mbidsinvdetail from memvar
else
*dont insert
endif
if mquotes.specprc>0
insidfr='Inside Front '
insidbk='Inside Back '
outsidbk='Outside Back ' 
prntsc=IIF(!EMPTY(covers.desc2),insidfr+',',"")+IIF(!EMPTY(covers.desc3)," "+insidbk +',',"")+IIF(!EMPTY(covers.desc4),+ outsidbk,"")
m.descr='Special Cover - '+prntsc
m.price=mquotes.specprc
insert into mbidsinvdetail from memvar
m.qty=0
endif


sele mbidsinvdetail


&&---------------------------------------------------------------------

sele mbidsinvoice
repl mbidsinvoice.baldue with mbidsinvoice.invtot

use
select mbidsinvdetail
use
sele mquotes
thisform.refresh

IF ptype="email"

lcfilepathval="C:\mbc5\pdf\" + alltrim(schname) + " packingslip.pdf"&&set name of file to be created and create it in given directory		
thisform.reg.setregkey("OutputFilePerm",@lcfilepathval,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)&&sets file name
	REPORT FORM mpkgslip NOCONSOLE TO PRINTER 

	

 
ELSE
set printer to default
REPORT FORM mpkgslip NOCONSOLE TO PRINTER 

endif


*-------------------------------------------------------------


on error




















ENDPROC
PROCEDURE updatemysqlcust
SELECT mcust

SCATTER memvar
TRY
nConnectionHandle = SQLStringConnect( "DRIVER={MySQL ODBC 5.1 Driver};DESC=;DATABASE=meridian;SERVER=databases;UID=root;PASSWORD=3l3phant1;PORT=;OPTION=16;" )
*nConnectionHandle = SQLStringConnect( "DRIVER={MySQL ODBC 5.1 Driver};DESC=;DATABASE=meridian;SERVER=databases;UID=root;PASSWORD=3l3phant1;PORT=;OPTION=16;" )
	
	CATCH

endtry
IF nConnectionHandle>0 &&connection good
TRY

SQLEXEC(nConnectionHandle,"select * from cust where schcode="+m.schcode+";","records")
SELECT records
IF RECCOUNT()>0


	a=SQLEXEC(nConnectionHandle,'update cust set schname="'+ALLTRIM(m.schname)+'",schaddr="'+m.schaddr+'",schaddr2="'+m.schaddr2+'",schcity="'+ALLTRIM(m.schcity)+'",schstate="'+ALLTRIM(m.schstate) +'",schzip="'+ m.schzip+'",schphone="'+m.schphone +'",schfax="'+m.schfax +'"where schcode="'+ALLTRIM(m.schcode)+'";')

ELSE


	a=SQLEXEC(nConnectionHandle,'insert into cust (schname,schaddr,schaddr2,schcity,schstate,schzip,schphone,schfax,schcode) values("'+m.schname+'","'+m.schaddr+'","'+m.schaddr2+'","'+m.schcity+'","'+m.schstate+'","'+m.schzip+'","'+m.schphone+'","'+m.schfax + '","'+m.schcode+'");')

endif
SQLDISCONNECT(nConnectionHandle)
CATCH

endtry
endif
ENDPROC
PROCEDURE GotFocus
oapp.schoolform=.t.
ENDPROC
PROCEDURE Destroy

thisform.ckchng 
DODEFAULT()
ENDPROC
PROCEDURE save
select mcust
thisform.pgfbase1.page1.container2.txtSchaddr .setfocus

*!*	thisform.pgfbase1.page1.setfocus   commented out because of mkt info log deactivate code is not ran
thisform.updatemysqlcust 
dodefault()

thisform.refresh

ENDPROC
PROCEDURE Release


DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
	OTHERWISE
		thisform.ckchng
		DoDefault()
		SYS(1104)
ENDCASE
thisform.ckchng
thisform.upsupdte 

ENDPROC
PROCEDURE Activate
ThisForm.SessID=ThisForm.DataSessionId
thisform.invid=mquotes.invno
thisform.refresh

ENDPROC
PROCEDURE previous

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault	
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
	OTHERWISE
	
thisform.ckchng
		DoDefault()

		thisform.custid=mcust.schcode
		thisform.invid=0
		IF mquotes.schcode=mcust.schcode
			thisform.invid=mquotes.invno
		ENDIF
		thisform.telelog=.f.
		thisform.mktlog=.f.
		thisform.pgfbase1.page3.container1.chkmkt.value=0
		thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
ENDCASE
ENDPROC
PROCEDURE next


DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
	OTHERWISE
	thisform.ckchng
		DoDefault()
    
		thisform.custid=mcust.schcode
		thisform.invid=0
		IF mquotes.schcode=mcust.schcode
			thisform.invid=mquotes.invno
		ENDIF
		thisform.telelog=.f.
		thisform.mktlog=.f.
		thisform.pgfbase1.page3.container1.chkmkt.value=0
		thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
ENDCASE

ENDPROC
PROCEDURE last

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
	OTHERWISE
	thisform.ckchng
		DoDefault()

		thisform.custid=mcust.schcode
		thisform.invid=0
		IF mquotes.schcode=mcust.schcode
			thisform.invid=mquotes.invno
		ENDIF
		thisform.telelog=.f.
		thisform.mktlog=.f.
		thisform.pgfbase1.page3.container1.chkmkt.value=0
		thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
ENDCASE
ENDPROC
PROCEDURE first

DO case
	CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
		cMessageTitle = 'Telephone log ENTRY required'
		cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
		nDialogType = 16
		nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
		NODEFAULT
	Case thisform.mktlog=.f. and substr(oApp.cNaUser,1,2)='CS' and mcust.schname <>'CS'
		messagebox('Please fill in marketing information and then click the "Marketing Info Completed" check box',64,"Market Information")
        nodefault
*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT

*!*		CASE thisform.telelog=.t. and substr(oApp.cNaUser,1,2)='CS' and thisform.NoValueInLkp()
*!*			MESSAGEBOX("Current value in Refer By/Status field is no longer valid." + chr(13) + "Please select a new vaule.",48,"Invalid Value")
*!*			NODEFAULT
	OTHERWISE
	   thisform.ckchng
		DoDefault()
  
		thisform.custid=mcust.schcode
		thisform.invid=0
		IF mquotes.schcode=mcust.schcode
			thisform.invid=mquotes.invno
		ENDIF
		thisform.telelog=.f.
		thisform.mktlog=.f.
		thisform.pgfbase1.page3.container1.chkmkt.value=0
		thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
ENDCASE
ENDPROC
PROCEDURE Init
parameter msrch
dodefault()

oapp.schoolform=.t.
set multilocks on
*!*	if (oApp.cCdPermLev == "AAAAE")&&if mbc user set read only
*!*	this.setall("readonly",.t.,"TextBox")
*!*	this.setall("readonly",.t.,"TxtBase")
*!*	this.setall("readonly",.t.,"editbox")
*!*	this.setall("readonly",.t.,"edtbase")
*!*	this.setall("readonly",.t.,"checkbox")
*!*	this.setall("readonly",.t.,"chkbase")
*!*	this.setall("readonly",.t.,"cbobase")
*!*	this.setall("enabled",.f.,"combobox")
*!*	this.setall("enabled",.f.,"cmdbase")
*!*	this.setall("enabled",.f.,"commandbutton")
*!*	this.setall("readonly",.t.,"grid")
*!*	this.setall("readonly",.t.,"gridbase")
*!*	this.setall("readonly",.t.,"cboalsqfill")
*!*	endif
&&reset telephone log so CS can get out
WITH thisform.pgfbase1.page3
.edtbase1.readonly=.f.

.grddatecont.readonly=.f.
.container1.chkmkt.readonly=.f.
endwith



*
m.schsrch=space(7)
sele mcust
set order to schcode
set skip to mquotes
if msrch='CS'
set orde to schname
seek msrch
set orde to schcode
else
seek msrch
endif

thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif

this.setall("SelectOnEntry",.t.,"TextBox")
this.setall("SelectOnEntry",.t.,"TextBase")
Days1=.f.
Days2=.f.
Days3=.f.
Days4=.f.
Days7=.f.
Days14=.f.
Days21=.f.
Days30=.f.
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
sele qtetemp
set orde to schcode
sele mcust
set rela to schcode into qtetemp addi
oapp.schoolform=.t.


ENDPROC
PROCEDURE add
NODEFAULT
if (oApp.cCdPermLev <> "AAAAE")&&if  not mbc user 
IsOK=messagebox("If you are NOT on the SCHOOL page"+;
	chr(13)+"Select Cancel, otherwise"+;
	chr(13)+"Select OK",289,;
	"Correct Page for ADD?")
if IsOK=1	
use codecnt in 0
sele codecnt
repl codecnt.schcode with codecnt.schcode+1
m.schcode=codecnt.precode+str(codecnt.schcode,4)
m.schname=space(34)
m.schout=ctod('  /  /  ')
use
insert into mcust from memvar
sele mcust
thisform.pgfbase1.page1.txtschname.enabled=.t.
thisform.refresh
thisform.custid=mcust.schcode
*!*	thisform.pgfbase1.page1.txtsource.setfocus()
thisform.addnew=.t.
endif
sele mcust
=tableupdate(.t.)
nodefault
endif
ENDPROC
PROCEDURE delete
messagebox("Delete is not implemented for this screen";
+chr(13)+"See Administrator",48,"Delete Record")
nodefault

ENDPROC
PROCEDURE LostFocus
thisform.ckchng
dodefault()
oapp.schoolform=.f.
ENDPROC
PROCEDURE Refresh
oapp.schoolform=.t.
ENDPROC
PROCEDURE QueryUnload

thisform.updatemysqlcust 
ENDPROC
PROCEDURE Pgfbase1.Page1.Activate
thisform.invid=mquotes.invno
thisform.refresh

ENDPROC
PROCEDURE Pgfbase1.Page2.Activate
thisform.refresh

ENDPROC
PROCEDURE Pgfbase1.Page3.Activate
set nulldisplay to ""

this.refresh

ENDPROC
PROCEDURE Pgfbase1.Page3.Deactivate


ENDPROC
PROCEDURE Pgfbase1.Page4.Init
RETURN .f.
ENDPROC
PROCEDURE Pgfbase1.Page4.Activate
if mquotes.contryear=mcust.contryear
mprodno=mquotes.prodno 
else
mprodno=""
endif


** put on last record entered
**skipping breaks relation ship so don't let it go past the last record for parent
select xsupplies
do while xsupplies.schcode=mcust.schcode
skip
enddo
if !empty(xsupplies.schcode)&&if no xsupply records pointer was not need moved
skip -1 && has skipped 1 record past parent put it back
endif



if alltrim(mcust.shiptocont)="Y"
this.contcontact.visible=.t.
this.contschool.visible=.f.
else
this.contcontact.visible=.f.
this.contschool.visible=.t.
endif
thisform.refresh

ENDPROC
PROCEDURE Pgfbase1.Page5.Activate
sele mcust
*!*	&&makes sure relation is set
*!*	IF !BOF()
*!*	skip -1
*!*	skip
*!*	thisform.refresh
*!*	ELSE
*!*	SKIP 
*!*	SKIP -1
*!*	thisform.Refresh
*!*	endif

ENDPROC
PROCEDURE Pgfbase1.Page5.Init


ENDPROC
PROCEDURE Pgfbase1.Page6.Deactivate
thisform.ckchng 
ENDPROC
PROCEDURE Pgfbase1.Page6.Activate
thisform.refresh

ENDPROC
PROCEDURE Pgfbase1.Page7.Init
return .f.

ENDPROC
     äG˛Úˇ    .ä  .ä                        |K/   %   ·y      á  ô  ”}          ¸  U  £ F˜  ˛ H˘ ˘ú˛: ¸Ù ˜ - CÙ ˜ ¯¯\˚ CS	 Ù  ˜ ˚ CS	˝˘Ë ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù  ˜ ˚ CS	˝˘¶˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘ú˛
 ôÙ ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯d˝N¸¯
˝¡ø’˛ F˜  ˛ G((˚ schname˛ F˜ ˛ G((˚ schcode˛ F˜  ˛	 GN(˜ ˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ UŸ  Ÿ Search For: ˆ ˝˛O 	Ù  ˜ …¯#Ù  ˜ …¯Ù  ˜ …¯˜ Ù ˜ …¯ø¸Ÿ Production #˝ ¡≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ <,˜ ˛ TÙ ˜ ¸Ù  ˜ ˝˛ TÙ ˜ ¸¯ ˝˛ %¸Ù ˜ Ù  ˜ ˝˘%˛ TÙ ˜ ¸Ù ˜ ˝˛ ˛ F˜  ˛ G((˚ schcode˛
 ôÙ ˜ ˛ TÙ ˜ ¸-˝˛ TÙ ˜
 ¸-˝˛ TÙ Ù Ù Ù  Ù! ˜" ¸¯ ˝˛ TÙ Ù Ù Ù  Ù# ˜$ ¸a˝˛ ˛ U%  MCUST THISFORM TELELOG OAPP CNAUSER SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER MQUOTES SCHCODE	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT SCHCITY SCHSTATE	 CONTRYEAR PRODNO JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDÚ H˘ ˘Î˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛ 2˘Î˛
 ôÙ  ˜
 ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚ prodno˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛ 	˜ ˜ ˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ F˜ ˛ G((˚ schcode˛ F˜ ˛ G((˚ schcode˛	 GN(˜ ˛ E¸ı˜ ˝˛
 ôÙ  ˜ ˛ ∫˘=˛ ôÙ  Ù Ù Ù ˜ ˛ ª˘E˛ æ˛ F˜ ˛ -¸Ù ˜ ı˜ ˝˛ TÙ  ˜ ¸ı˜ ˝˛ <,˜ ˛ TÙ  ˜ ¸ı˜ ˝˛ TÙ  ˜ ¸-˝˛ TÙ  ˜ ¸-˝˛ TÙ  Ù Ù  Ù! Ù" ˜# ¸¯ ˝˛ TÙ  Ù Ù  Ù! Ù$ ˜% ¸a˝˛
 ôÙ  ˜ ˛ ˛ U&  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER CKCHNG JBROWSER MQUOTES PRODNO	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT	 CONTRYEAR INVNO SCHCODE JKEYCANC REFRESH PGFBASE1 PAGE1	 GRDQUOTES SETFOCUS INVID CUSTID MKTLOG PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDc H˘ ˘\˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘\˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚ schcity˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛D 	˜ …¯˜ Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘¸˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù  Ù! ˜" ¸¯ ˝˛ TÙ  Ù Ù Ù  Ù# ˜$ ¸a˝˛ ˛ U%  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER SCHCITY	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT	 CONTRYEAR MQUOTES PRODNO SCHZIP SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLED^ H˘ ˘W˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘W˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚ schzip˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛@ 	˜ …¯
˜ …¯Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˜˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù Ù  ˜! ¸¯ ˝˛ TÙ  Ù Ù Ù Ù" ˜# ¸a˝˛ ˛ U$  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER SCHZIP	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDO H˘ ˘H˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘H˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚	 contfname˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛H 	˜ …¯˜ …¯˜ Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù  Ù! Ù" ˜# ¸¯ ˝˛ ˛ U$  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER	 CONTFNAME	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT	 CONTLNAME	 CONTRYEAR MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUEi H˘ ˘b˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘b˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚	 contlname˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛H 	˜ …¯˜ …¯˜ Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù  Ù! Ù" ˜# ¸¯ ˝˛ TÙ  Ù Ù  Ù! Ù$ ˜% ¸a˝˛ ˛ U&  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER	 CONTLNAME	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT	 CONTFNAME	 CONTRYEAR MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDK H˘ ˘D˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘D˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚ schcode˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛< 	˜ ˜ Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘‰˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù  Ù! ˜" ¸¯ ˝˛ TÙ  Ù Ù Ù  Ù# ˜$ ¸a˝˛ ˛ U%  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER SCHCODE	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT	 CONTRYEAR MQUOTES PRODNO SCHCITY SCHZIP JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDã3 Æ˜  ˜ ˜ ˜ ˜ ˜ ˜ ˜ ˜ ˜	 ˜
 ˜ ˛ G_ ˛ T˜ ¸¯˝˛ T˜ ¸-˝˛ T˜ ¸¯˝˛ T˜ ¸-˝˛ T˜
 ¸¯˝˛ T˜ ¸-˝˛ F˜ ˛ T˜  ¸C˘ˇˇŸ mcustÍê˝˛ T˜ ¸CŸ mcust.˝˛ Ñ˜ ¸¯˝(¸˜ ˝˘˘ ˛ %¸C˜  ˜ ¯\Ÿ 1˝˘ı ˛ T˜ ¸a˝˛ !˛ ˛ Ö˛ F˜ ˛ T˜ ¸C˘ˇˇŸ datecontÍê˝˛ T˜ ¸CŸ datecont.˝˛ Ñ˜ ¸¯˝(¸˜ ˝˘{˛ %¸C˜ ˜ ¯\Ÿ 1˝˘w˛ T˜ ¸a˝˛ !˛ ˛ Ö˛ F˜ ˛ T˜ ¸C˘ˇˇŸ ShippingÍê˝˛ T˜	 ¸CŸ Shipping.˝˛ Ñ˜
 ¸¯˝(¸˜	 ˝˘˝˛ %¸C˜ ˜
 ¯\Ÿ 1˝˘˘˛ T˜ ¸a˝˛ !˛ ˛ Ö˛ %¸˜ a˝˘5˛
 ôÙ ˜ ˛ F˜ ˛
 Ü¸CaÍì˝˛
 ôÙ ˜ ˛ ˛ %¸˜ a˝˘Y˛ F˜ ˛
 Ü¸CaÍì˝˛ ˛ %¸˜ a˝˘}˛ F˜ ˛
 Ü¸CaÍì˝˛ ˛ F˜ ˛ U  UCUST UCNTCUST NCNTCUST	 LCUSTCHNG UCONT UCNTCONT NCNTCONT	 LCONTCHNG USHIP UCNTSHIP NCNTSHIP	 LSHIPCHNG MCUST DATECONT SHIPPING THISFORM UPSUPDTE UPDATEMYSQLCUSTé Tı˜  ¸Ù ˜ ˚ Y˝˛ F˜ ˛ E¸ı˜  ˝˛ %¸C4
˝˘M ˛ ˛ >Ù ˜ —¸ı˜  ˝˛ ˛ >Ù ˜ —¸CÙ ˜ õ˝˛ >Ù ˜ —¸CÙ ˜ õ˝˛ >Ù ˜ —¸Ù ˜	 ˝˛ >Ù ˜
 —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸CÙ ˜ ¯¯\˝˛ >Ù ˜ —¸C¯
X˝˛ >Ù ˜ —¸-˝˛ >Ù ˜ —¸C¯X˝˛" %¸CÙ ‡ ÍZ
Ò CÙ ‡ ÍZ
˝˘ü˛ >Ù ˜ —¸a˝˛ >Ù ˜ —¸˚ email˝˛ %¸CÙ ‡ ÍZ
˝˘Ä˛ >Ù ˜ —¸Ù ˜ ˝˛ ˘õ˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘Ÿ˛ >Ù ˜ —¸C¯(X˝˛ >Ù ˜ —¸-˝˛ >Ù ˜ —¸C¯X˝˛ ˛ %¸CÙ ‡ ÍZ˝˘˛ >Ù ˜ —¸Ÿ Ground˝˛ ˘!˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ Tı˜  ¸Ù ˜ ˚ K˝˛ E¸ı˜  ˝˛ %¸C4
˝˘k˛ ˛ >Ù ˜ —¸ı˜  ˝˛ ˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸CÙ ˜ õ˝˛ >Ù ˜ —¸Ù ˜	 ˝˛ >Ù ˜
 —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸CÙ ˜ ¯¯\˝˛ >Ù ˜ —¸C¯
X˝˛ >Ù ˜ —¸-˝˛ >Ù ˜ —¸C¯X˝˛" %¸CÙ ‡ ÍZ
Ò CÙ ‡ ÍZ
˝˘ª˛ >Ù ˜ —¸a˝˛ >Ù ˜ —¸˚ email˝˛ %¸CÙ ‡ ÍZ
˝˘ú˛ >Ù ˜ —¸Ù ˜ ˝˛ ˘∑˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘ı˛ >Ù ˜ —¸C¯(X˝˛ >Ù ˜ —¸-˝˛ >Ù ˜ —¸C¯X˝˛ ˛ %¸CÙ ‡ ÍZ˝˘"˛ >Ù ˜ —¸Ÿ Ground˝˛ ˘=˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ F˜ ˛ T˜ ¸CÍì˝˛( %¸Ù ˜ ˚ BONÒ Ù ˜ ˚ BN4˝˘á˛
 ôÙ  ˜! ˛ ˛ U"  SCHSRCH MCUST SCHCODE UPSLIST NAME SCHNAME ATTN SHPNAME ADD1 SHPADDR ADD2 SHPADDR2 CITY SHPCITY STATE SHPSTATE ZIP SHPZIP FAX OPTION1 TYPE1	 CONTEMAIL SCHEMAIL OPTION2 TYPE2 EMAIL SVDESC1 SVDESC SVDESC2 VALTABLE PRODUTN VENDCD THISFORM BOONUPDTd H˘ ˘]˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘]˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚ schstate˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ UŸ  Ÿ Search For: ˆ ˝˛D 	˜ …¯˜ …¯Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˝˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù  Ù! ˜" ¸¯ ˝˛ TÙ  Ù Ù Ù  Ù# ˜$ ¸a˝˛ ˛ U%  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER SCHSTATE	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT MQUOTES PRODNO SCHCITY SCHCODE CSREP JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLED§ Tı˜  ¸Ù ˜ ˚ Y˝˛ F˜ ˛ G((˚ schcode˛ E¸ı˜  ˝˛ %¸C4
˝˘] ˛ ˛ >Ù ˜ —¸ı˜  ˝˛ ˛ %¸CÙ ˜ f˚ Y˝˘g˛ >Ù ˜ —¸Ÿ	 Residence˝˛# >Ù ˜ —¸CÙ ˜ õŸ  CÙ ˜ õ˝˛ >Ù ˜	 —¸Ù ˜
 ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸CÙ ˜ ¯¯\˝˛ >Ù ˜ —¸C¯
X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛" %¸CÙ ‡ ÍZ
Ò CÙ ‡ ÍZ
˝˘ﬁ˛ >Ù ˜ —¸˚ Y˝˛ >Ù ˜ —¸˚ email˝˛ %¸CÙ ‡ ÍZ
˝˘ø˛ >Ù ˜ —¸Ù ˜ ˝˛ ˘⁄˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘˛ >Ù ˜ —¸C¯(X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛ ˛ %¸CÙ ‡ ÍZ˝˘H˛ >Ù ˜ —¸Ÿ Ground˝˛ ˘c˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘X˛ >Ù ˜ —¸Ù ˜ ˝˛# >Ù ˜ —¸CÙ ˜ õŸ  CÙ ˜ õ˝˛ >Ù ˜	 —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜  ˝˛ >Ù ˜ —¸Ù ˜! ˝˛ >Ù ˜ —¸CÙ ˜" ¯¯\˝˛ >Ù ˜ —¸C¯
X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛" %¸CÙ ‡ ÍZ
Ò CÙ ‡ ÍZ
˝˘œ˛ >Ù ˜ —¸˚ Y˝˛ >Ù ˜ —¸˚ email˝˛ %¸CÙ ‡ ÍZ
˝˘∞˛ >Ù ˜ —¸Ù ˜ ˝˛ ˘À˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘˛ >Ù ˜ —¸C¯(X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛ ˛ %¸CÙ ‡ ÍZ˝˘9˛ >Ù ˜ —¸Ÿ Ground˝˛ ˘T˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˛ Tı˜  ¸Ù ˜ ˚ K˝˛ E¸ı˜  ˝˛ %¸C4
˝˘¢˛ ˛ >Ù ˜ —¸ı˜  ˝˛ ˛ %¸CÙ ˜# f˚ Y˝˘¨˛ >Ù ˜ —¸Ÿ	 Residence˝˛# >Ù ˜ —¸CÙ ˜ õŸ  CÙ ˜ õ˝˛ >Ù ˜	 —¸Ù ˜
 ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸CÙ ˜ ¯¯\˝˛ >Ù ˜ —¸C¯
X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛" %¸CÙ ‡ ÍZ
Ò CÙ ‡ ÍZ
˝˘#˛ >Ù ˜ —¸˚ Y˝˛ >Ù ˜ —¸˚ email˝˛ %¸CÙ ‡ ÍZ
˝˘˛ >Ù ˜ —¸Ù ˜ ˝˛ ˘˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘`˛ >Ù ˜ —¸C¯(X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛ ˛ %¸CÙ ‡$ ÍZ˝˘ç˛ >Ù ˜ —¸Ÿ Ground˝˛ ˘®˛ >Ù ˜ —¸Ù ˜$ ˝˛ ˛ ˘ù˛ >Ù ˜ —¸Ù ˜ ˝˛# >Ù ˜ —¸CÙ ˜ õŸ  CÙ ˜ õ˝˛ >Ù ˜	 —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜  ˝˛ >Ù ˜ —¸Ù ˜! ˝˛ >Ù ˜ —¸CÙ ˜" ¯¯\˝˛ >Ù ˜ —¸C¯
X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛" %¸CÙ ‡ ÍZ
Ò CÙ ‡ ÍZ
˝˘˛ >Ù ˜ —¸˚ Y˝˛ >Ù ˜ —¸˚ email˝˛ %¸CÙ ‡ ÍZ
˝˘ı˛ >Ù ˜ —¸Ù ˜ ˝˛ ˘˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛ ˘Q˛ >Ù ˜ —¸C¯(X˝˛ >Ù ˜ —¸˚ N˝˛ >Ù ˜ —¸C¯X˝˛ ˛ %¸CÙ ‡$ ÍZ˝˘~˛ >Ù ˜ —¸Ÿ Ground˝˛ ˘ô˛ >Ù ˜ —¸Ù ˜$ ˝˛ ˛ ˛ U%  SCHSRCH MCUST SCHCODE BOONLIST YB_STH NAME ATTN	 CONTFNAME	 CONTLNAME ADD1 CONTADDR ADD2	 CONTADDR2 CITY CONTCITY STATE	 CONTSTATE ZIP CONTZIP FAX OPTION1 TYPE1	 CONTEMAIL SCHEMAIL OPTION2 TYPE2 EMAIL SVDESC1 SVDESC SCHNAME SCHADDR SCHADDR2 SCHCITY SCHSTATE SCHZIP
 SHIPTOCONT SVDESC2j H˘ ˘c˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘c˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚
 bcontfname˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛H 	˜ …¯˜ …¯˜ Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù  Ù! Ù" ˜# ¸¯ ˝˛ TÙ  Ù Ù  Ù! Ù$ ˜% ¸a˝˛ ˛ U&  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER
 BCONTFNAME	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT
 BCONTLNAME	 CONTRYEAR MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDj H˘ ˘c˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘c˛
 ôÙ  ˜ ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚
 bcontlname˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛H 	˜ …¯˜ …¯˜ Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù  Ù! Ù" ˜# ¸¯ ˝˛ TÙ  Ù Ù  Ù! Ù$ ˜% ¸a˝˛ ˛ U&  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG JBROWSER
 BCONTLNAME	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT
 BCONTFNAME	 CONTRYEAR MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLED¶  Tı˜  ¸CÙ ˜  õ˝˛ T˜ ¸a˝˛ T˜ ¸CŸ EXACTv˝˛ G ˛ Q˘  ˚ refertblº˜ ˛ F˜ ˛ ~¸CÙ ˜  õı˜  ˝˘} ˛ T˜ ¸-˝˛ ˛ set exact &cexact
 Q˛	 B¸˜ ˝˛ U  REFBY MCUST RECORDNOTHERE CEXACT REFERTBL TMPREFERTBL'  4˜  ˛ >Ù ˜ —¸C$˜  ˝˛
 ôÙ ˜ ˛ U  NTIME DATECONT NXTDATE THISFORM REFRESH√  F˜  ˛ ô¸CaaÍì˝˛ Tı˜ ¸Ù ˜ ˝˛ T˜ ¸CÍö˝˛ %¸C˜ °
˝˘t ˛ G*(J¸˜ ˝˛ *˚ dymo1(!9¸Ù  ˜ ı˜ ˝˛ G*(˛ ˘µ ˛9 ô¸CŸ No printer has been selected.¯Ÿ
 No PrinterÍx˝˛ ˛ G*(˛ U  MCUST SID THISFORM CUSTID CPRINTERNAME DYMO1 SCHCODEí  %¸C˚ prodnum™
˝˘* ˛ Q˘  ˚ prodnum˛ ˛ F˜  ˛ >Ù  ˜ —¸Ù  ˜ ¯˝˛ T˜ ¸CÙ  ˜ ¯Z˝˛ %¸C˚ prodnum™˝˘Ç ˛ F˜  ˛ Q˛ ˛	 B¸˜ ˝˛ U  PRODNUM	 LSTPRODNO RETVAL& Æ˜  ˜ ˛ %¸CŸ spcover™
˝˘5 ˛ Q˘  ˚ spcover˛ ˛ F˜ ˛ >Ù ˜ —¸Ù ˜ ¯˝˛ T˜ ¸Ù ˜ ˝˛ T˜  ¸C˜ ¯Z˝˛" Q˘  ˚ coversº˜ √˚ specovr˛ F˜ ˛	 E¸˜  ˝˛ %¸C4˝˘˛ +¸C4˝˘˛ T˜ ¸˜ ¯˝˛ >Ù ˜ —¸˜ ˝˛ T˜  ¸C˜ ¯Z˝˛ F˜ ˛	 E¸˜  ˝˛ ˛ ˛ F˜ ˛ Q˛	 B¸˜  ˝˛ U  MSRCH MSRCH1 SPCOVER SPECCVNO COVERS SECOVER SPECOVRH  F˜  ˛  ?˚ menvel(!¸Ù  ˜ Ù ˜ ˝˛ -¸Ù  ˜ Ù ˜ ˝˛
 ôÙ ˜ ˛ U  MCUST MENVEL SCHCODE THISFORM CUSTID REFRESH„ 4˜  ˜ ˛ %¸C˚ mbidsinvoice™
˝˘H ˛! Q˘  º˚ c:\mbc5\mbidsinvoice˛ ˛ %¸C˚ mbidsinvoice™˝˘w ˛ F˜ ˛ ˛ 3˛ ˛ %¸C˚ bidinvdetail™
˝˘∫ ˛# Q˘  º˚ c:\mbc5\mbidsinvdetail˛ ˛ %¸C˚ mbidsinvdetail™˝˘Î ˛ F˜ ˛ ˛ 3˛ ˛ F˜ ˛ ^¬˛ Tı˜ ¸È≤ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜	 ¸Ù ˜	 ˝˛. %¸Cı˜	 Ÿ PERS FOLDERSŸ STD FOLDERS≠˝˘m˛ Tı˜
 ¸a˝˛ ˘Ç˛ Tı˜
 ¸-˝˛ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜  ¸Ù ˜  ˝˛ Tı˜! ¸Ù ˜! ˝˛ Tı˜" ¸Ù ˜" ˝˛ Tı˜# ¸Ù ˜# ˝˛ Tı˜$ ¸Ù ˜$ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜% ¸Ù ˜& ˝˛ Tı˜' ¸Ù ˜( ˝˛ Tı˜) ¸Ù ˜* ˝˛ Tı˜+ ¸Ù ˜, ˝˛ Tı˜- ¸Ù ˜- ˝˛ Tı˜. ¸Ù ˜/ ˝˛ Tı˜0 ¸Ù ˜0 ˝˛ Tı˜1 ¸Ù ˜ Ù ˜2 ˝˛ Tı˜2 ¸Ù ˜2 ˝˛! Tı˜3 ¸Ù ˜2 Ù ˜4 Ù ˜5 ˝˛ Tı˜6 ¸ı˜3 Ù ˜5 ˝˛: Tı˜7 ¸CÙ ˜8 aÚ Ÿ Small FormatÛ Ÿ Large Format6˝˛ Tı˜9 ¸Ù ˜: ˝˛ Tı˜; ¸Ù ˜< ˝˛ Tı˜= ¸Ù ˜= ˝˛ Tı˜> ¸Ù ˜> ˝˛( Tı˜? ¸CCÙ ˜? ¯dZõŸ
 % Discount˝˛ Tı˜@ ¸Ù ˜@ ˝˛ Tı˜A ¸Ù ˜A ˝˛ Tı˜B ¸Ù ˜B ˝˛ Tı˜C ¸Ù ˜C ˝˛ Tı˜D ¸Ù ˜D ˝˛ Tı˜E ¸Ù ˜E ˝˛ Tı˜F ¸Ù ˜F ˝˛ Tı˜G ¸Ù ˜G ˝˛ Tı˜H ¸Ù ˜H ˝˛ Tı˜I ¸Ù ˜I ˝˛ Tı˜J ¸Ÿ  ˝˛ Tı˜K ¸¯ ˝˛ F˜ ˛ rº˚ mbidsinvoice¬˛ F˜ ˛ %¸Ù ˜L ¯ ˝˘>˛W Tı˜M ¸˚ Hall Pass per Planner(CCÙ ˜L Zõ˚ ) * No. of Students(CCı˜ Zõ˚ )˝˛ Tı˜N ¸Ù ˜L ı˜ ˝˛ Tı˜O ¸Ù ˜P ˝˛! Tı˜Q ¸Ù ˜P Ù ˜L Ù ˜ ˝˛ rº˚ mbidsinvdetail¬˛ ˛ %¸Ù ˜R ¯ ˝˘√˛ Tı˜M ¸˚	 Book Mark˝˛ Tı˜N ¸Ù ˜R ˝˛ Tı˜O ¸Ù ˜S ˝˛ Tı˜Q ¸Ù ˜S Ù ˜R ˝˛ rº˚ mbidsinvdetail¬˛ ˛ %¸Ù ˜T ¯ ˝˘M˛ Tı˜M ¸˚ Vinyl Pocket A˝˛ Tı˜O ¸Ù ˜U ˝˛ Tı˜N ¸Ù ˜T ˝˛ Tı˜Q ¸Ù ˜U Ù ˜T ˝˛ rº˚ mbidsinvdetail¬˛ ˛ %¸Ù ˜V ¯ ˝˘Ê˛ Tı˜M ¸˚ Vinyl Pocket B˝˛ Tı˜O ¸Ù ˜W ˝˛ Tı˜N ¸Ù ˜V ˝˛ Tı˜Q ¸Ù ˜W Ù ˜V ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜X ¯ ˝˘y˛ Tı˜M ¸˚ Id Pouch˝˛ Tı˜O ¸Ù ˜Y ˝˛ Tı˜N ¸Ù ˜X ˝˛ Tı˜Q ¸Ù ˜Y Ù ˜X ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜Z ¯ ˝˘	˛" Tı˜M ¸˚ Standard Title Page˝˛ Tı˜O ¸Ù ˜[ ˝˛ Tı˜N ¸Ù ˜Z ˝˛ Tı˜Q ¸Ù ˜[ Ù ˜Z ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜\ ¯ ˝˘±	˛ Tı˜M ¸˚ Duraglaze Cover˝˛ Tı˜O ¸Ù ˜] ˝˛ Tı˜N ¸Ù ˜\ ˝˛ Tı˜Q ¸Ù ˜] Ù ˜\ ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜^ ¯ ˝˘Q
˛$ Tı˜M ¸˚ Elementary Wall Chart˝˛ Tı˜O ¸Ù ˜_ ˝˛ Tı˜N ¸Ù ˜^ ˝˛ Tı˜Q ¸Ù ˜_ Ù ˜^ ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜` ¯ ˝˘Ô
˛" Tı˜M ¸˚ Typesetting Service˝˛ Tı˜O ¸Ù ˜a ˝˛ Tı˜N ¸Ù ˜` ˝˛ Tı˜Q ¸Ù ˜a Ù ˜` ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜b ¯ ˝˘í˛$ Tı˜M ¸˚ Implementation Guides˝˛ Tı˜O ¸˙        ˝˛ Tı˜N ¸Ù ˜b ˝˛ Tı˜Q ¸˙        ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ %¸Ù ˜c ¯ ˝˘Ê˛ Tı˜M ¸Ù ˜d ˝˛ Tı˜O ¸Ù ˜c ˝˛ rº˚ mbidsinvdetail¬˛ ˘>˛ %¸CÙ ˜d °
˝˘:˛ Tı˜M ¸Ù ˜d ˝˛ Tı˜O ¸¯ ˝˛ rº˚ mbidsinvdetail¬˛ ˛ ˛ H˘O˘
˛ ¸Ù ˜e a˝˘y˛ T˜f ¸Ÿ Four Colors˝˛ ¸Ù ˜g a˝˘§˛ T˜f ¸Ÿ Three Colors˝˛ ¸Ù ˜h a˝˘Õ˛ T˜f ¸Ÿ
 Two Colors˝˛ ¸Ù ˜i a˝˘ı˛ T˜f ¸Ÿ	 One Color˝˛ 2˘
˛ T˜f ¸Ÿ  ˝˛ ˛1 Tı˜M ¸˚ Cover - CC˜f °
Ú Ÿ  ˜f Û Ÿ  6˝˛ Tı˜O ¸Ù ˜j ˝˛ %¸C˜f °
˝˘y˛ rº˚ mbidsinvdetail¬˛ ˘Å˛ ˛ %¸Ù ˜k ¯ ˝˘¢˛ T˜l ¸˚ Inside Front ˝˛ T˜m ¸˚ Inside Back ˝˛ T˜n ¸˚ Outside Back ˝˛` T˜o ¸CCÙp ˜B °
Ú ˜l ˚ ,Û Ÿ  6CCÙp ˜E °
Ú Ÿ  ˜m ˚ ,Û Ÿ  6CCÙp ˜G °
Ú ˜n Û Ÿ  6˝˛# Tı˜M ¸˚ Special Cover - ˜o ˝˛ Tı˜O ¸Ù ˜k ˝˛ rº˚ mbidsinvdetail¬˛ Tı˜N ¸¯ ˝˛ ˛ F˜ ˛ F˜ ˛ >Ù ˜ —¸Ù ˜ ˝˛ Q˛ F˜ ˛ Q˛ F˜ ˛
 ôÙq ˜r ˛ %¸˜  Ÿ email˝˘≤˛3 T˜s ¸Ÿ C:\mbc5\pdf\C˜ õŸ  packingslip.pdf˝˛o ô¸CŸ OutputFilePerm˜s Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙq Ùt ˆu ˝˛ ?˚ mpkgslip(!9˛ ˘‘˛ G*(˛ ?˚ mpkgslip(!9˛ ˛ {˚  ˛ Uw  PTYPE SCHNAME C MBIDSINVOICE ALL MBIDSINVDETAIL MQUOTES INVNO SCHCODE SCHTYPE FOLDER QTEDATE NOPAGES
 NOSTCOPIES QTYSTUD
 NOTECOPIES
 QTYTEACHER BOOK_EA FPLNPRC SOURCE PONUM INVTOT FPLNTOT BALDUE ADJBEF
 INVADDNOTE MCUST INVNOTES INVNAME INVADDR INVADDR2 INVCITY INVSTATE INVZIP SHPNAME	 CONTFNAME	 CONTLNAME SCHADDR SHPADDR SCHADDR2 SHPADDR2 SCHCITY SHPCITY SCHSTATE SHPSTATE GENERIC SCHZIP SHPZIP	 CONTRYEAR BASETOT BASEPRC	 TEBASEPRC TEACHEDTPRC TEACHEDTQTY	 TEBASETOT
 FORMATTYPE SF
 DTESCHSTAR DTESCHSTART ASBTOT AFTERDISCTOT SBTOT
 ERLDISCAMT DP1 DESC1 DESC1AMT DESC2 DESCAMT DESC3AMT DESC3 DESC4AMT DESC4 SALESTX SHPPHNDL
 AFTTXADJDE AFTTXADJ HALLPQTY DESCR QTY PRICE
 HALLPPRICE	 UNITPRICE BMARKQTY BMARKPRC VPAQTY VPPRC VPBQTY VPBPRC
 IDPOUCHQTY
 IDPOUCHPRC STDTITPGQTY STDTITPGPRC
 DURAGLZQTY
 DURAGLZPRC	 WALLCHQTY	 WALLCHPRC
 TYPESETQTY
 TYPESETPRC
 IMPGUIDQTY MISC MDESC FOURCLR NUMCLRS THREECLR TWOCLR ONECLR	 CVRTOTPRC SPECPRC INSIDFR INSIDBK OUTSIDBK PRNTSC COVERS THISFORM REFRESH LCFILEPATHVAL REG	 SETREGKEY MPKGSLIP F˜  ˛ ^¬˛ ∫˘ò ˛Ñ T˜ ¸CŸt DRIVER={MySQL ODBC 5.1 Driver};DESC=;DATABASE=meridian;SERVER=databases;UID=root;PASSWORD=3l3phant1;PORT=;OPTION=16;Íü˝˛ ª˘† ˛ æ˛ %¸˜ ¯ ˝˘˛ ∫˘˛E ô¸C˜ Ÿ! select * from cust where schcode=ı˜ Ÿ ;Ÿ recordsÍi˝˛ F˜ ˛ %¸CN¯ ˝˘˛Ó T˜ ¸C˜ ˚ update cust set schname="Cı˜ õ˚ ",schaddr="ı˜ ˚ ",schaddr2="ı˜ ˚ ",schcity="Cı˜ õ˚ ",schstate="Cı˜	 õ˚
 ",schzip="ı˜
 ˚ ",schphone="ı˜ ˚
 ",schfax="ı˜ ˚ "where schcode="Cı˜ õ˚ ";Íi˝˛ ˘˚˛Ï T˜ ¸C˜ ˚d insert into cust (schname,schaddr,schaddr2,schcity,schstate,schzip,schphone,schfax,schcode) values("ı˜ ˚ ","ı˜ ˚ ","ı˜ ˚ ","ı˜ ˚ ","ı˜	 ˚ ","ı˜
 ˚ ","ı˜ ˚ ","ı˜ ˚ ","ı˜ ˚ ");Íi˝˛ ˛ ô¸C˜ Íg˝˛ ª˘˛ æ˛ ˛ U  MCUST NCONNECTIONHANDLE SCHCODE RECORDS A SCHNAME SCHADDR SCHADDR2 SCHCITY SCHSTATE SCHZIP SCHPHONE SCHFAX  TÙ  ˜ ¸a˝˛ U  OAPP
 SCHOOLFORM 
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ U  THISFORM CKCHNG=  F˜  ˛ ôÙ Ù Ù Ù Ù ˜ ˛
 ôÙ ˜ ˛	 ô¸CÍ°˝˛
 ôÙ ˜ ˛ U	  MCUST THISFORM PGFBASE1 PAGE1
 CONTAINER2
 TXTSCHADDR SETFOCUS UPDATEMYSQLCUST REFRESH· H˘ ˘∆˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘∆˛
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ ô¸C˘P]˝˛ ˛
 ôÙ  ˜ ˛
 ôÙ  ˜ ˛ U  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG UPSUPDTE3  TÙ  ˜ ¸Ù  ˜ ˝˛ TÙ  ˜ ¸Ù ˜ ˝˛
 ôÙ  ˜ ˛ U  THISFORM SESSID DATASESSIONID INVID MQUOTES INVNO REFRESHd H˘ ˘]˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘]˛
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù Ù ˜ ¸¯ ˝˛ TÙ  Ù Ù Ù Ù ˜ ¸a˝˛ ˛ U  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG CUSTID SCHCODE INVID MQUOTES INVNO PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDd H˘ ˘]˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘]˛
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù Ù ˜ ¸¯ ˝˛ TÙ  Ù Ù Ù Ù ˜ ¸a˝˛ ˛ U  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG CUSTID SCHCODE INVID MQUOTES INVNO PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDd H˘ ˘]˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘]˛
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù Ù ˜ ¸¯ ˝˛ TÙ  Ù Ù Ù Ù ˜ ¸a˝˛ ˛ U  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG CUSTID SCHCODE INVID MQUOTES INVNO PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDd H˘ ˘]˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛: ¸Ù  ˜
 - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘ü˛Ä ô¸C˚\ Please fill in marketing information and then click the "Marketing Info Completed" check box¯@Ÿ Market InformationÍx˝˛ ¨˛ 2˘]˛
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜
 ¸-˝˛ TÙ  Ù Ù Ù Ù ˜ ¸¯ ˝˛ TÙ  Ù Ù Ù Ù ˜ ¸a˝˛ ˛ U  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER MKTLOG CKCHNG CUSTID SCHCODE INVID MQUOTES INVNO PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLEDx 4˜  ˛	 ô¸CÍ°˝˛ TÙ ˜ ¸a˝˛ G_ ˛ ¶¸Ù Ù ˜ ˝˘g ˛ T‚Ù ˜ ¸-˝˛ T‚Ù ˜ ¸-˝˛ T‚Ù	 Ù
 ˜ ¸-˝˛ ß˛ Tı˜ ¸C¯X˝˛ F˜ ˛ G((˚ schcode˛	 GN(˜ ˛ %¸˜  ˚ CS˝˘ÿ ˛ G((˚ schname˛	 E¸˜  ˝˛ G((˚ schcode˛ ˘È ˛	 E¸˜  ˝˛ ˛ TÙ ˜ ¸Ù ˜ ˝˛ TÙ ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘:˛ TÙ ˜ ¸Ù ˜ ˝˛ ˛( ô¸CŸ SelectOnEntryaŸ TextBoxÙ ˆ ˝˛) ô¸CŸ SelectOnEntryaŸ TextBaseÙ ˆ ˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ T˜ ¸-˝˛ TÙ ˜ ¸-˝˛ TÙ ˜ ¸-˝˛ TÙ Ù Ù Ù	 Ù
 ˜ ¸¯ ˝˛ TÙ Ù Ù Ù	 Ù  ˜! ¸a˝˛ F˜" ˛ G((˚ schcode˛ F˜ ˛ G-(¸˜ ˝º˜" ˛ TÙ ˜ ¸a˝˛ U#  MSRCH OAPP
 SCHOOLFORM THISFORM PGFBASE1 PAGE3 EDTBASE1 READONLY GRDDATECONT
 CONTAINER1 CHKMKT SCHSRCH MCUST SCHCODE MQUOTES SCHNAME CUSTID INVID INVNO THIS SETALL DAYS1 DAYS2 DAYS3 DAYS4 DAYS7 DAYS14 DAYS21 DAYS30 TELELOG MKTLOG VALUE	 CMDNEWMKT ENABLED QTETEMP¶ ¨˛ %¸Ù  ˜ Ÿ AAAAE˝˘ü˛Ç T˜ ¸CŸ! If you are NOT on the SCHOOL pageC¯ Ÿ Select Cancel, otherwiseC¯ Ÿ	 Select OK˘!Ÿ Correct Page for ADD?Íx˝˛ %¸˜ ¯˝˘Ü˛ Q˘  ˚ codecnt˛ F˜ ˛ >Ù ˜ —¸Ù ˜ ¯˝˛ Tı˜ ¸Ù ˜ CÙ ˜ ¯Z˝˛ Tı˜ ¸C¯"X˝˛ Tı˜ ¸C˚   /  /  #˝˛ Q˛ rº˚ mcust¬˛ F˜ ˛ TÙ	 Ù
 Ù Ù ˜ ¸a˝˛
 ôÙ	 ˜ ˛ TÙ	 ˜ ¸Ù ˜ ˝˛ TÙ	 ˜ ¸a˝˛ ˛ F˜ ˛
 Ü¸CaÍì˝˛ ¨˛ ˛ U  OAPP
 CCDPERMLEV ISOK CODECNT SCHCODE PRECODE SCHNAME SCHOUT MCUST THISFORM PGFBASE1 PAGE1
 TXTSCHNAME ENABLED REFRESH CUSTID ADDNEWj c ô¸CŸ) Delete is not implemented for this screenC¯ Ÿ See Administrator¯0Ÿ Delete RecordÍx˝˛ ¨˛ U  $ 
 ôÙ  ˜ ˛	 ô¸CÍ°˝˛ TÙ ˜ ¸-˝˛ U  THISFORM CKCHNG OAPP
 SCHOOLFORM  TÙ  ˜ ¸a˝˛ U  OAPP
 SCHOOLFORM 
 ôÙ  ˜ ˛ U  THISFORM UPDATEMYSQLCUST   TÙ  ˜ ¸Ù ˜ ˝˛
 ôÙ  ˜ ˛ U  THISFORM INVID MQUOTES INVNO REFRESH 
 ôÙ  ˜ ˛ U  THISFORM REFRESH  Gà(¸Ÿ  ˝˛
 ôÙ  ˜ ˛ U  THIS REFRESH  U  
  B¸-˝˛ U  ¸  %¸Ù  ˜ Ù ˜ ˝˘' ˛ T˜ ¸Ù  ˜ ˝˛ ˘< ˛ T˜ ¸Ÿ  ˝˛ ˛ F˜ ˛ +¸Ù ˜ Ù ˜ ˝˘c ˛ H˛ ˛ %¸CÙ ˜ °
˝˘Ñ ˛
 H¸˘ˇˇ˝˛ ˛ %¸CÙ ˜ õŸ Y˝˘¡ ˛ TÙ Ù	 ˜
 ¸a˝˛ TÙ Ù ˜
 ¸-˝˛ ˘Î ˛ TÙ Ù	 ˜
 ¸-˝˛ TÙ Ù ˜
 ¸a˝˛ ˛
 ôÙ ˜ ˛ U  MQUOTES	 CONTRYEAR MCUST MPRODNO PRODNO	 XSUPPLIES SCHCODE
 SHIPTOCONT THIS CONTCONTACT VISIBLE
 CONTSCHOOL THISFORM REFRESH
  F˜  ˛ U  MCUST  U   
 ôÙ  ˜ ˛ U  THISFORM CKCHNG 
 ôÙ  ˜ ˛ U  THISFORM REFRESH
  B¸-˝˛ U  
 schoolsrch,     ˇˇ prodsrch6    ˇˇ citysrchò	    ˇˇ zipsrch`    ˇˇ fstsrch    ˇˇ lstsrch∆    ˇˇ codesrch¢    ˇˇ ckchngR!    ˇˇ upsupdteì$    ˇˇ stesrch;*    ˇˇ boonupdt/    ˇˇ	 bfstrsrchÊ8    ˇˇ blstsrch≈=    ˇˇ novalueinlkp§B    ˇˇ nxtcontdateäC    ˇˇ prntaddresslabels‚C    ˇˇ	 getprodnoÂD    ˇˇ getcovernumóE    ˇˇ prntenvelope˝F    ˇˇ printpkglist|G    ˇˇ updatemysqlcustÃ[    ˇˇ GotFocusf_    ˇˇ Destroyç_    ˇˇ saveπ_    ˇˇ ReleaseX`    ˇˇ Activateºb    ˇˇ previous4c    ˇˇ nextyf    ˇˇ lastæi    ˇˇ firstm    ˇˇ InitHp    ˇˇ addÏs    ˇˇ delete*v    ˇˇ	 LostFocusòv    ˇˇ Refresh‰v    ˇˇ QueryUnloadw    ˇˇ Pgfbase1.Page1.Activate7w    ˇˇ Pgfbase1.Page2.ActivateÖw    ˇˇ Pgfbase1.Page3.Activate©w    ˇˇ Pgfbase1.Page3.Deactivate‘w    ˇˇ Pgfbase1.Page4.Init€w    ˇˇ Pgfbase1.Page4.ActivateÈw    ˇˇ Pgfbase1.Page5.Activatepy    ˇˇ Pgfbase1.Page5.InitÖy    ˇˇ Pgfbase1.Page6.Deactivateåy    ˇˇ Pgfbase1.Page6.ActivateØy    ˇˇ Pgfbase1.Page7.Init”y    ˇˇ1 q “ °ë°— aA °A â § £r q q ë — · ¬Û£ Å 1q1A q ° · · ¡°A 3 “ °ë°— aA â £ £q Ò — · ¡·° "!q q ë ± ¢ Å 1Å B q 1!Å !‰ · ¡°§ A 3 “ °ë°— aA °A â ¢ £r — · ¬C£ Å 1q1A ° · · ¡°A 3 “ °ë°— aA °A â ¢ £r Ò — · ¬£ Å 1q1A ° · · ¡°A 3 “ °ë°— aA °A à ¢ £r !— · ¬É£ Å 1q1A ° · · ¡A 2 “ °ë°— aA °A â £ £r !— · ¬É£ Å 1q1A ° ‚ · ¡°A 2 “ °ë°— aA °A â £ £r — · ¬√£ Ç 1q1A ° · · ¡¢A 2 2a — ± — ± — ± q íAq°± B A A q ¡qq°± A A A r ¡qq°± A A A Ú ¢ r ° ° A Ú q ° A Ú q ° A r 4 tq ± — Q !A RQ1111±!· !!· QA1Å 1A Å !· !A 1aÅ 1A s± — Q !A 2Q1111±!· !!· QA1Å 1A Å !· !A 1aÅ 1A r — Ç¢ A 2 “ °ë°— aA °A â ¢ £r — · ¬C¢ Å 1q1A ° · · ¡°A 2 sq ± — Q !A rë11111±!!!QA1Å 1A Å !!A 2aÅ 1A Å 111111±!!!QA1Å 1A Å !!A 1aÅ 1A A r± — Q !A që11111±!!!QA1Å 1A Å !!A 1aÅ 1A Å 111111±!!!QA1Å 1A Å !!A 1aÅ 1A A 5 ” °ë°— aA °A â ¢ £r 1— · ¬É£ Å 1q1A ° · · ¡°A 2 “ °ë°— aA °A â ¢ £r 1— · ¬É£ Å 1q1A ° · · ¡°A 2 A± Aa ëq ë± A QA ë 2 q 2° 2 q ± !“ — Òq Å ëA q 9 q1A q qQbq A A ë 2 ± r1A q q!!q ë ¡ — !q ë A A q A ë 9 q A° 2 ≤ ≈A ±q Q A B ¡1A —q Q A B q a "!!·— Å — A !!!!!!!!!$"!!!!!"!!!!!!!!!"ë!Å°!!!!Å!!!!#!!!"!Ò Ò r ar DqÅ!ÅB BÅ!!ëÅB B—!!ëÅB B—!!ëÅÒ A Bq!!ëÅÒ A B!!!ëÅÒ A B·!!ëÅÒ A BA!!ëÅÒ A K!!!ëÅÒ A BAq!qÅÒ A F!!ÅÇ 1!Ò ÅB A ” !Å!ë!q!aÅ — A !ÅÅ B A°ë°1!ÅÒ A s u 1B q A q ° b2Ò1Ö q 1B Ü P1 q R Å AÉ B Å Rq „Ç √B ¡ Å B A 2 · 2 ¢ ë 2 q a£ ë ¢ 3 ” °ë°— aA °A á ° ë ¡ A ° ° 3 11° 3 “ °ë°— aA °A à ¢ ë 2q1A · · ¡°A 2 ” °ë°— aA °A à ° ë 2q1A · · ¡°A 3 “ °ë°— aA °A à ° ë 2q1A · · ¡°A 2 “ °ë°— aA °A à ° ë 2q1A · · ¡°A 2 q ë ‚ a  1Ò Ú !A q ë 1ë Å ë A 2q1A Çë± ± ± ± ± ± ± ± · · ¡°q q · 4 A °$1q q·ëA Ò q q° 1‚ A q ° A A 2 2A 3 ° ë · 2 · 2 ¢ 2 1° 3 ° 3 ± ¢ 3 4 q 2 qÅ — A u ÅA A 1° A tÅ A ° 3 q = 4 ° 2 ° 3 q 2                       ì     *   ≤  Í  A   U   	  D  Ñ   x   b  S  º   õ   q  z$  Ù   Ω   ò$  ﬂ+  )  ‡   ˛+  13  b    N3  -7  õ  5  L7  J@  €  Ä  h@  `G  1  £  G  X  g  (  8X  È_  ı  K  `  Ng  -  n  qg  Àh  d  {  Ìh  >i  r    fi  k  x  å  +k  l  é  ò  :l  ìo  ú  ∞  ∂o  ap  Ω  µ  Ñp  Òä  √  ã  ã  ﬂè  ˜  ü  ˛è  ê    °  /ê  Nê    §  iê  Wë     ™  uë  ·ï  +  º   ñ  Xñ  G  ¿  wñ  ÷õ  M  ÿ  Òõ  U°  p    p°  Ã¶  î    Ë¶  I¨  ∂     d¨  ∫≤  ÿ  N  ‘≤  qµ     e  éµ  ∂  <  h  $∂  U∂  B  l  s∂  Ü∂  G  n  ®∂  √∂  J  p  Ò∂  !∑  N  s  O∑  a∑  S  u  è∑  ∂∑  W  x  Ê∑  Ë∑  ]  y  ∏  ∏  a  {  J∏  Ø∫  d  ê  ›∫  äª  Ç  í  ¥ª  ∂ª  ê  ì  Êª  ˆª  î  ï  $º  6º  ó  ó  `º  lº  õ   )   .ä                       ˛custid
sessid
invid
addnew
oldcyear
telelog Customer service (CS) must make an entry in the telephone log before exiting the Schools screen.
mktlog
*schoolsrch 
*prodsrch 
*citysrch 
*zipsrch 
*fstsrch 
*lstsrch 
*codesrch 
*ckchng 
*upsupdte 
*stesrch 
*boonupdt 
*bfstrsrch Searches for 2nd advisors first name
*blstsrch search for 2nd advisor by last name
*novalueinlkp 
*nxtcontdate 
*prntaddresslabels 
*getprodno 
*getcovernum 
*prntenvelope 
*printpkglist 
*updatemysqlcust 
      registry      ..\..\common60\registry.vcx      custom      reg      SCHOOLS      =Top = 72
Left = 960
Height = 17
Width = 48
Name = "reg"
      textbox      textbox      
txtSchcode      SCHOOLS.Pgfbase1.Page1     Comment = ""
FontBold = .F.
ControlSource = "mcust.schcode"
Enabled = .F.
Height = 23
InputMask = "999999"
Left = 56
MaxLength = 6
TabIndex = 27
Top = 7
Width = 56
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
Name = "txtSchcode"
      textbox      textbox      
txtSchname      SCHOOLS.Pgfbase1.Page1     Comment = ""
FontBold = .T.
ControlSource = "mcust.schname"
Enabled = .F.
Format = "!"
Height = 23
Left = 197
MaxLength = 34
TabIndex = 20
Top = 7
Width = 255
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
BorderColor = 64,0,64
Name = "txtSchname"
     ´PROCEDURE LostFocus
m.schname=mcust.schname

thisform.pgfbase1.page1.txtschname.enabled=.f.
thisform.addnew=.f.
if mquotes.schcode=mcust.schcode
m.invno=mquotes.invno
repl mquotes.schname with m.schname
 
sele mquotes
=tableupdate(.t.)
SELECT produtn
IF produtn.invno=m.invno
REPLACE produtn.schname WITH m.schname
=TABLEUPDATE(.t.)
endif
sele mcust
ENDIF
thisform.updatemysqlcust
thisform.refresh
ENDPROC
     1˛Úˇ                              -k   %   ñ      œ     ©          ¸  U  ‚  Tı˜  ¸Ù ˜  ˝˛ TÙ Ù Ù Ù ˜ ¸-˝˛ TÙ ˜ ¸-˝˛ %¸Ù ˜	 Ù ˜	 ˝˘« ˛ Tı˜
 ¸Ù ˜
 ˝˛ >Ù ˜  —¸ı˜  ˝˛ F˜ ˛
 Ü¸CaÍì˝˛ F˜ ˛ %¸Ù ˜
 ı˜
 ˝˘º ˛ >Ù ˜  —¸ı˜  ˝˛
 Ü¸CaÍì˝˛ ˛ F˜ ˛ ˛
 ôÙ ˜ ˛
 ôÙ ˜ ˛ U  SCHNAME MCUST THISFORM PGFBASE1 PAGE1
 TXTSCHNAME ENABLED ADDNEW MQUOTES SCHCODE INVNO PRODUTN UPDATEMYSQLCUST REFRESH	 LostFocus,     ˇˇ1 !r· q!!r ° q a!° A q A ° ° 1                       †      )                           cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase1      SCHOOLS.Pgfbase1.Page1      dTop = 7
Left = 147
Height = 22
Width = 48
Caption = "School"
TabIndex = 70
Name = "Cmdbase1"
      3PROCEDURE Click
thisform.schoolsrch()

ENDPROC
      Õ˛Úˇ    ¥   ¥                         Q   %   V       k      e           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM
 SCHOOLSRCH Click,     ˇˇ1 — 2                       (       )   ¥                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase5      SCHOOLS.Pgfbase1.Page1      `Top = 7
Left = 5
Height = 21
Width = 48
Caption = "Code"
TabIndex = 75
Name = "Cmdbase5"
      3PROCEDURE Click

thisform.codesrch()

ENDPROC
      À˛Úˇ    ≤   ≤                         j8   %   T       i      c           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM CODESRCH Click,     ˇˇ1 “ 2                       (       )   ≤                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase8      SCHOOLS.Pgfbase1.Page1      iTop = 7
Left = 459
Height = 23
Width = 88
Caption = "Change Name"
TabIndex = 80
Name = "Cmdbase8"
     µPROCEDURE Click
eMessageTitle = 'Change Spelling'
eMessageText = 'Do you really want to change the School Name?'
nDialogType = 4 + 16 + 256
*  4 = Yes and No buttons
*  16 = Stop sign icon
*  256 = Second button is default

nAnswer = MESSAGEBOX(eMessageText, nDialogType, eMessageTitle)

if nAnswer = 6
		thisform.pgfbase1.page1.txtschname.enabled=.t.
		thisform.pgfbase1.page1.txtschname.setfocus()
endif




ENDPROC
     ·˛Úˇ    »  »                        &-   %   \        
   k          ¸  U  ø  T˜  ¸˚ Change Spelling˝˛: T˜ ¸˚- Do you really want to change the School Name?˝˛ T˜ ¸˘˝˛ T˜ ¸C˜ ˜ ˜  Íx˝˛ %¸˜ ¯˝˘∏ ˛ TÙ Ù Ù Ù ˜ ¸a˝˛ ô¸CÙ Ù Ù Ù ˆ	 ˝˛ ˛ U
  EMESSAGETITLE EMESSAGETEXT NDIALOGTYPE NANSWER THISFORM PGFBASE1 PAGE1
 TXTSCHNAME ENABLED SETFOCUS Click,     ˇˇ1 ¡°· eqaA 5                       ™      )   »                        edtbase      ..\..\common60\basectrl.vcx      editbox      EdtInOffice      SCHOOLS.Pgfbase1.Page1      vHeight = 58
Left = 7
TabIndex = 81
Top = 475
Width = 275
ControlSource = "mcust.inoffice"
Name = "EdtInOffice"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase3      SCHOOLS.Pgfbase1.Page1      åBackStyle = 0
Caption = "Inter Office"
Height = 17
Left = 7
Top = 457
Width = 60
TabIndex = 83
ForeColor = 0,0,0
Name = "Lblbase3"
      cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager1      SCHOOLS.Pgfbase1.Page1     |Top = 455
Left = 72
Height = 18
Width = 28
TabIndex = 84
ForeColor = 0,0,0
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = mcust
maincursor = cust
currentrecordonly = .T.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 3|Memorybook
settings_emailaddress = 3|yearbook@memorybook.com
settings_subject = 
settings_body = 2|'School Code:'+':   '+ALLTRIM(mcust.schcode) + '     School Name:    ' + ALLTRIM(mcust.schname) + '    School Email Address:    ' + ALLTRIM(mcust.schemail) +'         Comments:    '+ mcust.inoffice
settings_attachment = 2|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = [Memorybook]
emailaddress = [yearbook@memorybook.com]
subject = 
body = 'School Code:'+':   '+ALLTRIM(mcust.schcode) + '     School Name:    ' + ALLTRIM(mcust.schname) + '    School Email Address:    ' + ALLTRIM(mcust.schemail) +'         Comments:    '+ mcust.inoffice
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager1"
     PROCEDURE Init

dodefault()
*repl mailtemp.mailltr with filetostr('m:\mbc5\email.txt')
ENDPROC
PROCEDURE Click

this.subject='alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)+"          "+['+alltrim(mquotes.prodno)+']'
dodefault()
ENDPROC
     Å˛Úˇ    h  h                        -%   %   Ê                      ¸  U   	 ô¸CÍ°˝˛ U  Ü z TÙ  ˜ ¸˚\ alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)+"          "+[CÙ ˜ õ˚ ]˝˛	 ô¸CÍ°˝˛ U  THIS SUBJECT MQUOTES PRODNO Init,     ˇˇ Click<     ˇˇ1 í 3 ¢ë 1                       Y         u         )   h                        cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager2      SCHOOLS.Pgfbase1.Page1     yTop = 376
Left = 904
Height = 21
Width = 26
Picture = ..\mail.bmp
TabIndex = 86
ToolTipText = "Uses c:\mbc5\email.txt for body"
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = mcust
maincursor = mcust
currentrecordonly = .T.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 2|ALLTRIM(mcust.contfname)+" "+ ALLTRIM(mcust.contlname) 
settings_emailaddress = 2|ALLTRIM(mcust.schemail)
settings_subject = 2|alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)
settings_body = filetostr("m:\mbc5\emailtext\meridianemail.txt")
settings_attachment = 1|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = ALLTRIM(mcust.contfname)+" "+ ALLTRIM(mcust.contlname) 
emailaddress = ALLTRIM(mcust.schemail)
subject = alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)
body = filetostr("m:\mbc5\emailtext\meridianemail.txt")
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager2"
     ﬁPROCEDURE Init
dodefault()

ENDPROC
PROCEDURE Click
*Ensures that there is a name in the 1st advisor name fields, one or the other or both must be filled.
* If left empty the mail manager crashes

if empty(mcust.contfname) and empty(mcust.contlname) &&use data field to test, textbox is not available on this page
nodefault
Messagebox("Please enter a name for the advisor name fields in the contact tab.",64,"Advisor Name Field")

else
dodefault()
endif
ENDPROC
     °˛Úˇ    à  à                        bà   %   ˛       /  
             ¸  U   	 ô¸CÍ°˝˛ U  °  %¸CÙ  ˜ °	 CÙ  ˜ °	˝˘â ˛ ¨˛g ô¸CŸC Please enter a name for the advisor name fields in the contact tab.¯@Ÿ Advisor Name FieldÍx˝˛ ˘ö ˛	 ô¸CÍ°˝˛ ˛ U  MCUST	 CONTFNAME	 CONTLNAME Init,     ˇˇ Click<     ˇˇ1 ë 3 ‰A qÇ ë A 1                                9   ”      )   à                        lblbase      ..\..\common60\basectrl.vcx      label      Lblbase4      SCHOOLS.Pgfbase1.Page1      ûWordWrap = .T.
BackStyle = 0
Caption = "Send Email to this School (CS)"
Height = 32
Left = 794
Top = 376
Width = 102
TabIndex = 88
Name = "Lblbase4"
      edtbase      ..\..\common60\basectrl.vcx      editbox      EdtSpecInst      SCHOOLS.Pgfbase1.Page1      wHeight = 58
Left = 297
TabIndex = 93
Top = 477
Width = 275
ControlSource = "mcust.spcinst"
Name = "EdtSpecInst"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase7      SCHOOLS.Pgfbase1.Page1      ÑBackStyle = 0
Caption = "Special Instructions"
Height = 17
Left = 297
Top = 461
Width = 110
TabIndex = 94
Name = "Lblbase7"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase6      SCHOOLS.Pgfbase1.Page1      åTop = 417
Left = 556
Height = 23
Width = 192
Caption = "UpDate Shipping Name/Address"
TabIndex = 96
Visible = .T.
Name = "Cmdbase6"
      /PROCEDURE Click
thisform.upsupdte

ENDPROC
      »˛Úˇ    Ø   Ø                         H–   %   Q       f      `           ¸  U   
 ôÙ  ˜ ˛ U  THISFORM UPSUPDTE Click,     ˇˇ1 ° 2                       $       )   Ø                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      	Cmdbase10      SCHOOLS.Pgfbase1.Page1      ÄTop = 570
Left = 728
Height = 23
Width = 192
Caption = "Shipping Ticket"
TabIndex = 99
Visible = .F.
Name = "Cmdbase10"
     ÇPROCEDURE Click
if !used('pticket')
use pticket in 0 excl
sele pticket
if used('pticket')
dele all
pack
endif
sele mcust
m.schcode=mcust.schcode
m.schname=mcust.schname
m.schstate=mcust.schstate
m.prodno=produtn.prodno
m.invno=produtn.invno
m.booktype=mquotes.booktype
m.nopages=produtn.nopages
m.nocopies=produtn.nocopies
m.typestyle=produtn.typestyle
m.covertype=produtn.covertype
m.coverdesc=produtn.coverdesc
m.diecut=produtn.diecut
m.perfbind=produtn.perfbind
m.laminated=produtn.laminated
m.vendcd=produtn.vendcd
m.insck=mquotes.insck
m.coilclr=produtn.coilclr
m.warndate=produtn.warndate
m.prmsdate=produtn.prmsdate
insert into pticket from memvar
sele pticket
repo form shiptkt to prin noconsole
sele pticket
use
else
IsOK=messagebox("Another User has file locked"+;
	chr(13)+"Select OK and try again",48,;
	"Print Production Ticket")
endif

ENDPROC
     3˛Úˇ                              L}   %   x      —  %   á          ¸  U  ` %¸C˚ pticket™
˝˘Á˛ Q˘  º˚ pticket˛ F˜  ˛ %¸C˚ pticket™˝˘Q ˛ ˛ 3˛ ˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜	 ¸Ù
 ˜	 ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù
 ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ rº˚ pticket¬˛ F˜  ˛ ?˚ shiptkt(!9˛ F˜  ˛ Q˛ ˘Y˛j T˜ ¸CŸ Another User has file lockedC¯ Ÿ Select OK and try again¯0Ÿ Print Production TicketÍx˝˛ ˛ U  PTICKET ALL MCUST SCHCODE SCHNAME SCHSTATE PRODNO PRODUTN INVNO BOOKTYPE MQUOTES NOPAGES NOCOPIES	 TYPESTYLE	 COVERTYPE	 COVERDESC DIECUT PERFBIND	 LAMINATED VENDCD INSCK COILCLR WARNDATE PRMSDATE SHIPTKT ISOK Click,     ˇˇ1 qAq aQ A A q !!!!!!!!!!!!!!!!!!!q !q A Å £A 2                       w      )                           txtbase      ..\..\common60\basectrl.vcx      textbox      TxtCSRep      SCHOOLS.Pgfbase1.Page1      ≠FontBold = .T.
FontSize = 8
ControlSource = "mcust.csrep"
Height = 20
InputMask = "!!"
Left = 665
MaxLength = 2
TabIndex = 1
Top = 7
Width = 63
Name = "TxtCSRep"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase9      SCHOOLS.Pgfbase1.Page1      ÄBackStyle = 0
Caption = "Cust. Service Rep"
Height = 17
Left = 563
Top = 7
Width = 100
TabIndex = 100
Name = "Lblbase9"
      lblbase      ..\..\common60\basectrl.vcx      label      	Lblbase13      SCHOOLS.Pgfbase1.Page1      }BackStyle = 0
Caption = "Extra Charges"
Height = 17
Left = 583
Top = 464
Width = 80
TabIndex = 95
Name = "Lblbase13"
      edtbase      ..\..\common60\basectrl.vcx      editbox      EdtExChg      SCHOOLS.Pgfbase1.Page1      rHeight = 58
Left = 583
TabIndex = 82
Top = 480
Width = 275
ControlSource = "mcust.exchg"
Name = "EdtExChg"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      	Cmdbase11      SCHOOLS.Pgfbase1.Page1      |Top = 417
Left = 752
Height = 23
Width = 192
Caption = "Meridian Production Ticket"
TabIndex = 78
Name = "Cmdbase11"
     tPROCEDURE Click
*Meridian Production Ticket
if mquotes.contryear<>mcust.contryear
**********

cMessageTitle = 'Incorrect Production Record'
cMessageText = 'Right-Click on Current Year Production Record and Re-try.'
nDialogType = 16
nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)

*************
else

if mquotes.invoiced=.f.
MessageBox("No INVOICE has been created for this order."+;
        chr(13)+"Notify your Supervisor..."+ ;
        "Press any key to continue...", 16,;
        "Report this Status to your Supervisor") 
ENDIF

if !used('pticket')
use pticket in 0 excl
sele pticket
if used('pticket')
dele all
pack
endif
sele mcust
m.invno=produtn.invno
m.schcode=mcust.schcode
m.schname=mcust.schname
m.schstate=mcust.schstate
m.typestyle=IIF(mquotes.lf=.t.,"LF","SF")
m.bindvend=produtn.bindvend
m.vendcd=produtn.vendcd
m.ponum=mquotes.ponum
IF EMPTY(MQUOTES.SCHTYPE)
MESSAGEBOX("Planner Type is empty, please go to sales screen and enter a planner type.",16,"Missing Planner Type")
return
 endif
m.schtype=mquotes.schtype

m.booktype=mquotes.booktype
m.nopages=mquotes.nopages
m.se=mquotes.qtystud
mcover=produtn.covertype
m.covertype=produtn.covertype
m.desc=covers.desc2
m.desc1a=covers.desc3
m.desc1b=covers.desc4
m.emailed=produtn.pemailed
m.hallpqty=mquotes.hallpqty 
m.bmarkqty=mquotes.bmarkqty
m.vpaqty=mquotes.vpaqty
m.vpbqty=mquotes.vpbqty
m.te=mquotes.teachedtqty
m.idpouchqty=mquotes.idpouchqty
m.stdtitpgqt=mquotes.stdtitpgqty
m.duraglzqty=mquotes.duraglzqty
m.wallchqty=mquotes.wallchqty
m.impguidqty=mquotes.impguidqty
m.spcinst=mcust.spcinst
m.typesetqty=mquotes.typesetqty
m.hrdcpyprf=mquotes.hrdcpyprf
m.prodno=produtn.prodno
m.contryear=mquotes.contryear
m.coverdesc=produtn.coverdesc
m.pdfsent=produtn.pdfsent
m.foilclr=produtn.foilclr
m.prshpdte=produtn.prshpdte
insert into pticket from memvar
sele pticket

repo form prodtktm to prin noconsole
sele pticket
USE
thisform.printpkglist("paper")
else
IsOK=messagebox("Another User has file locked"+;
	chr(13)+"Select OK and try again",48,;
	"Print Production Ticket")
endif
endif
ENDPROC
     	"˛Úˇ    		  		                        Wr   %   %      ¿  F   4          ¸  U  ≈ %¸Ù  ˜ Ù ˜ ˝˘® ˛( T˜ ¸˚ Incorrect Production Record˝˛F T˜ ¸˚9 Right-Click on Current Year Production Record and Re-try.˝˛ T˜ ¸¯˝˛ T˜ ¸C˜ ˜ ˜ Íx˝˛ ˘æ˛ %¸Ù  ˜ -˝˘g˛• ô¸CŸ+ No INVOICE has been created for this order.C¯ Ÿ Notify your Supervisor...Ÿ Press any key to continue...¯Ÿ% Report this Status to your SupervisorÍx˝˛ ˛ %¸C˚ pticket™
˝˘H˛ Q˘  º˚ pticket˛ F˜ ˛ %¸C˚ pticket™˝˘º˛ ˛ 3˛ ˛ F˜ ˛ Tı˜
 ¸Ù ˜
 ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛& Tı˜ ¸CÙ  ˜ aÚ Ÿ LFÛ Ÿ SF6˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù  ˜ ˝˛ %¸CÙ  ˜ °˝˘Ò˛p ô¸CŸJ Planner Type is empty, please go to sales screen and enter a planner type.¯Ÿ Missing Planner TypeÍx˝˛ B˛ ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸Ù  ˜ ˝˛ T˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜  ¸Ù ˜! ˝˛ Tı˜" ¸Ù ˜# ˝˛ Tı˜$ ¸Ù  ˜$ ˝˛ Tı˜% ¸Ù  ˜% ˝˛ Tı˜& ¸Ù  ˜& ˝˛ Tı˜' ¸Ù  ˜' ˝˛ Tı˜( ¸Ù  ˜) ˝˛ Tı˜* ¸Ù  ˜* ˝˛ Tı˜+ ¸Ù  ˜, ˝˛ Tı˜- ¸Ù  ˜- ˝˛ Tı˜. ¸Ù  ˜. ˝˛ Tı˜/ ¸Ù  ˜/ ˝˛ Tı˜0 ¸Ù ˜0 ˝˛ Tı˜1 ¸Ù  ˜1 ˝˛ Tı˜2 ¸Ù  ˜2 ˝˛ Tı˜3 ¸Ù ˜3 ˝˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜4 ¸Ù ˜4 ˝˛ Tı˜5 ¸Ù ˜5 ˝˛ Tı˜6 ¸Ù ˜6 ˝˛ Tı˜7 ¸Ù ˜7 ˝˛ rº˚ pticket¬˛ F˜ ˛ ?˚ prodtktm(!9˛ F˜ ˛ Q˛ ô¸CŸ paperÙ9 ˆ: ˝˛ ˘∫˛j T˜; ¸CŸ Another User has file lockedC¯ Ÿ Select OK and try again¯0Ÿ Print Production TicketÍx˝˛ ˛ ˛ U<  MQUOTES	 CONTRYEAR MCUST CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER INVOICED PTICKET ALL INVNO PRODUTN SCHCODE SCHNAME SCHSTATE	 TYPESTYLE LF BINDVEND VENDCD PONUM SCHTYPE BOOKTYPE NOPAGES SE QTYSTUD MCOVER	 COVERTYPE DESC COVERS DESC2 DESC1A DESC3 DESC1B DESC4 EMAILED PEMAILED HALLPQTY BMARKQTY VPAQTY VPBQTY TE TEACHEDTQTY
 IDPOUCHQTY
 STDTITPGQT STDTITPGQTY
 DURAGLZQTY	 WALLCHQTY
 IMPGUIDQTY SPCINST
 TYPESETQTY	 HRDCPYPRF PRODNO	 COVERDESC PDFSENT FOILCLR PRSHPDTE PRODTKTM THISFORM PRINTPKGLIST ISOK Click,     ˇˇ1 rÉa— aÉ "T
A rAq aQ A A q !!!!a!!!!A A !"!!!!!!!!!!!!!!!!!!!!!!!!!!q 2q A QÅ £A A 1                       i      )   		                        grid      grid      	grdQuotes      SCHOOLS.Pgfbase1.Page1     ÂColumnCount = 6
DeleteMark = .F.
Height = 96
Left = 8
Panel = 1
ReadOnly = .T.
RecordSource = "mquotes"
RecordSourceType = 1
TabIndex = 89
Top = 335
Width = 532
Name = "grdQuotes"
Column1.ControlSource = "mquotes.schname"
Column1.Width = 215
Column1.ReadOnly = .T.
Column1.Visible = .T.
Column1.Format = "!"
Column1.BackColor = 255,255,255
Column1.Name = "Column1"
Column2.ColumnOrder = 5
Column2.ControlSource = "produtn.kitrecvd"
Column2.Width = 83
Column2.ReadOnly = .T.
Column2.Visible = .T.
Column2.BackColor = 255,255,255
Column2.Name = "Column2"
Column3.ColumnOrder = 6
Column3.ControlSource = "mquotes.prodno"
Column3.Width = 127
Column3.ReadOnly = .T.
Column3.Visible = .T.
Column3.Format = "!"
Column3.InputMask = "XX9999-99999"
Column3.BackColor = 255,255,255
Column3.Name = "Column3"
Column4.ColumnOrder = 4
Column4.ControlSource = ""
Column4.Width = 1
Column4.ReadOnly = .T.
Column4.Visible = .T.
Column4.BackColor = 255,255,255
Column4.Name = "Column5"
Column5.ColumnOrder = 3
Column5.ControlSource = "mquotes.contryear"
Column5.Width = 29
Column5.ReadOnly = .T.
Column5.Visible = .T.
Column5.InputMask = "99"
Column5.BackColor = 255,255,255
Column5.Name = "Column6"
Column6.FontBold = .T.
Column6.ColumnOrder = 2
Column6.ControlSource = "mquotes.booktype"
Column6.Width = 45
Column6.ReadOnly = .F.
Column6.Visible = .T.
Column6.InputMask = "!!!!"
Column6.ForeColor = 255,0,255
Column6.BackColor = 255,255,255
Column6.Name = "Column7"
      mPROCEDURE AfterRowColChange
LPARAMETERS nColIndex
thisform.invid=mquotes.invno
thisform.refresh
ENDPROC
     ˛Úˇ    ˙   ˙                         ñ   %   å       ±      ß           ¸  U  '  Ø˜  ˛ TÙ ˜ ¸Ù ˜ ˝˛
 ôÙ ˜ ˛ U 	 NCOLINDEX THISFORM INVID MQUOTES INVNO REFRESH AfterRowColChange,     ˇˇ1 q 1° 1                       b       )   ˙                         header      header      Header1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column1      =Caption = "School"
BackColor = 128,255,0
Name = "Header1"
      textbox      textbox      Text1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column1      ∞BorderStyle = 0
Margin = 0
ReadOnly = .T.
ToolTipText = "Right Click to Select Quote for Search"
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      ?PROCEDURE RightClick
thisform.invid=mquotes.invno

ENDPROC
      „˛Úˇ                                  ez   %   g       Å      {           ¸  U    TÙ  ˜ ¸Ù ˜ ˝˛ U  THISFORM INVID MQUOTES INVNO
 RightClick,     ˇˇ1 12                       4       )                             header      header      Header1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column2      ECaption = "Date Kit Rec'd"
BackColor = 128,255,0
Name = "Header1"
      textbox      textbox      Text1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column2      úBorderStyle = 0
ControlSource = "produtn.kitrecvd"
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column3      =Caption = "Prod #"
BackColor = 128,255,0
Name = "Header1"
      textbox      textbox      Text1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column3      îBorderStyle = 0
InputMask = "XX9999-99999"
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column5      *Caption = "Quote Date"
Name = "Header1"
      textbox      textbox      Text1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column5      xBorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column6      ;Caption = "Year"
BackColor = 128,255,0
Name = "Header1"
      textbox      textbox      Text1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column6      xBorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column7      eFontBold = .T.
Caption = "Bk Type"
ForeColor = 255,0,255
BackColor = 128,255,0
Name = "Header1"
      textbox      textbox      Text1      (SCHOOLS.Pgfbase1.Page1.grdQuotes.Column7      †FontBold = .T.
BorderStyle = 0
InputMask = "!!!!"
Margin = 0
ReadOnly = .F.
Visible = .T.
ForeColor = 255,0,255
BackColor = 255,255,255
Name = "Text1"
     ÁPROCEDURE Valid
if empty(produtn.kitrecvd)
replace mcust.booktype with this.value
sele mquotes
=tableupdate()
else
cMessageTitle = 'Kit Received Date already EXISTS'
cMessageText = 'Production DATES are affected if you CHANGE Book Type'+;
        chr(13)+ 'You should notify the WIP Coordinator'
nDialogType = 1+16+256

nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
if nAnswer=1
replace mcust.booktype with this.value
sele mquotes
=tableupdate()
else
=tablerevert()
endif
endif
thisform.refresh

&&-------------------------------------------------------------------------------
*!*	m.company=produtn.company

*!*	DO case
*!*	CASE m.company="MBC" OR m.company="MER"
*!*	if empty(produtn.kitrecvd)
*!*	replace cust.booktype with this.value
*!*	sele quotes
*!*	=tableupdate()
*!*	else
*!*	cMessageTitle = 'Kit Received Date already EXISTS'
*!*	cMessageText = 'Production DATES are affected if you CHANGE Book Type'+;
*!*	        chr(13)+ 'You should notify the WIP Coordinator'
*!*	nDialogType = 1+16+256

*!*	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
*!*	if nAnswer=1
*!*	replace cust.booktype with this.value
*!*	sele quotes
*!*	=tableupdate()
*!*	else
*!*	=tablerevert()
*!*	endif
*!*	ENDIF
*!*	CASE m.company="COM"
*!*	if empty(produtn.kitrecvd)
*!*	replace jcust.booktype with this.value
*!*	sele jquotes
*!*	=tableupdate()
*!*	else
*!*	cMessageTitle = 'Kit Received Date already EXISTS'
*!*	cMessageText = 'Production DATES are affected if you CHANGE Book Type'+;
*!*	        chr(13)+ 'You should notify the WIP Coordinator'
*!*	nDialogType = 1+16+256

*!*	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
*!*	if nAnswer=1
*!*	replace jcust.booktype with this.value
*!*	sele jquotes
*!*	=tableupdate()
*!*	else
*!*	=tablerevert()
*!*	endif
*!*	ENDIF
*!*	CASE ""
*!*	MESSAGEBOX("Company not set. Schools.pgframe1.page1.grdquotes.column7.text1.valid")
*!*	endcase

*!*	thisform.refresh


ENDPROC
     §˛Úˇ    ã  ã                        l,   %   	      B               ¸  U  Y %¸CÙ  ˜ °˝˘5 ˛ >Ù ˜ —¸Ù ˜ ˝˛ F˜ ˛	 Ü¸CÍì˝˛ ˘H˛- T˜ ¸˚  Kit Received Date already EXISTS˝˛q T˜ ¸˚5 Production DATES are affected if you CHANGE Book TypeC¯ ˚% You should notify the WIP Coordinator˝˛ T˜	 ¸˘˝˛ T˜
 ¸C˜ ˜	 ˜ Íx˝˛ %¸˜
 ¯˝˘3˛ >Ù ˜ —¸Ù ˜ ˝˛ F˜ ˛	 Ü¸CÍì˝˛ ˘D˛	 Ü¸CÍî˝˛ ˛ ˛
 ôÙ ˜ ˛ U  PRODUTN KITRECVD MCUST BOOKTYPE THIS VALUE MQUOTES CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER THISFORM REFRESH Valid,     ˇˇ1 !1q ë Å —· b1q ë Å ë A A ° @1                       ‹      )   ã                        	container      	container      
Container1      SCHOOLS.Pgfbase1.Page1      TTop = 177
Left = 8
Width = 926
Height = 150
BackStyle = 0
Name = "Container1"
      label      label      lblSecsource      !SCHOOLS.Pgfbase1.Page1.Container1      úAutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "Cust. Date"
Height = 17
Left = 585
Top = 85
Width = 60
TabIndex = 15
Name = "lblSecsource"
      textbox      textbox      txtContdate      !SCHOOLS.Pgfbase1.Page1.Container1      œComment = ""
DateFormat = 13
ControlSource = "mcust.contdate"
Height = 23
Left = 651
TabIndex = 9
ToolTipText = "Click Right Mouse Button for Today's Date"
Top = 85
Width = 71
Name = "txtContdate"
     íPROCEDURE Valid

	
ENDPROC
PROCEDURE RightClick
repl mcust.contdate with date()
thisform.refresh


ENDPROC
PROCEDURE LostFocus
local nSelect,prody_n,lAddNew,msrch
aa=MESSAGEBOX("Is this sale a Prime product?",36,"Prime Sale")
IF aa=6
m.prime=.t.
ELSE
m.prime=.f.
endif
retval="0"
 m.company="MER"
ProdY_N=.f.
lAddNew=7
m.cpnum=''
m.perfbind2=''
*nSelect=select()

sele mcust
set orde to schcode
if !isblank(mcust.contdate) .and. isblank(mcust.origyear)
IF MONTH(DATE())>8
repl mcust.origyear with substr(str(year(date())+1),9,2)
repl mcust.contryear with substr(str(year(date())+1),9,2)
m.contryear=substr(str(year(date())),9,2)
m.bpyear=m.contryear
ELSE
repl mcust.origyear with substr(str(year(date())),9,2)
repl mcust.contryear with substr(str(year(date())),9,2)
m.contryear=substr(str(year(date())),9,2)
m.bpyear=m.contryear
endif
endif
if !isblank(mcust.contdate)
IF MONTH(DATE())>8
repl mcust.contryear with substr(str(year(date())+1),9,2)
m.contryear=substr(str(year(date())+1),9,2)
ELSE
repl mcust.contryear with substr(str(year(date())),9,2)
m.contryear=substr(str(year(date())),9,2)
endif

endif
=tableupdate(.t.)
*if thisform.addnew=.f.
* Add all records for new book
m.schcode=mcust.schcode
thisform.custid=mcust.schcode
msrch=mcust.schcode
if mquotes.schcode=m.schcode
prody_n=.t.
else
prody_n=.f.
endif
if prody_n
lAddNew=messagebox("A Production Record DOES Exist"+chr(13)+;
"Do you want to ADD another one?",4+32+256,"Production Record DOES Exist?")


else
lAddNew = messagebox("Production Record DOES NOT Exist"+chr(13)+;
"Do you want to ADD one?",4+32+256,"Add Production Record")
endif
if lAddNew=6   &&------------------------------------------------------------------------------------------------------------------------

DO FORM newprodrec TO retval
use invcnum in 0 excl
sele invcnum
repl invcnum.invcno with invcnum.invcno+1
m.invno=invcnum.invcno
thisform.invid=invcnum.invcno

sele invcnum
use
sele mcust
m.schname=mcust.schname
m.booktype=mcust.booktype
m.schout=mcust.schout
m.hndred=recv2.hndred

if surv2.tobeapplied=m.contryear
m.recvmemo=surv2.compmemo
repl mcust.inoffice with m.recvmemo
endif
*use qtetemp in 0 shar
*sele qtetemp
*set orde to schcode
*sele mcust
*set rela to schcode into qtetemp addi
if qtetemp.schcode=m.schcode and qtetemp.invoiced=.t.
*!*	m.nopages=qtetemp.nopages
*!*	m.nocopies=qtetemp.nocopies

m.cstat='Rebook'

endif
m.prodno=''
m.perfbind=""
*save covers special instructions and insert into new prod record for the next year per TF 5/16/11

select covers
m.specinst=covers.specinst
select mquotes
m.bpyear=m.contryear
*!*	m.schtype="HS"
*!*	m.sf=.t.
*!*	m.lf=.f.
insert into mquotes.dbf from memvar


IF retval="0"
m.prodno=thisform.getprodno()&&-----------------------------------------------------------
m.reorder=.f.
m.speccover=thisform.getcovernum()
m.specovr=speccover
m.prodno= "M"+m.prodno +" " + m.speccover &&notice one spaces must be in here to insert into quotes correctly We are add binding automaticly
ELSE
m.prodno=retval
m.reorder=.t.
endif
select mquotes
 
replace mquotes.prodno WITH m.prodno
repl mquotes.newprice with .t.
sele mquotes
=tableupdate(.t.)


sele covers

insert into covers from memvar
sele covers
=tableupdate(.t.)
sele mcust
*!*	if qtetemp.hdbky_n=.t.
*!*	m.perfbind='H'
*!*	endif
m.newprice=.t.
*!*	m.perfbind=m.perfbind2
**********************************************************************************************************
&& set jobno,advpw,stfpw memvar from last years record if it exist else blank
&&((((((

*!*	if upper(alltrim(mcust.booktype))="MBO" .or. upper(alltrim(mcust.booktype))="CR" &&MBO records only
select mquotes
*!*	if !empty(mquotes.contryear)
*!*	contrlastyear=alltrim(str(val(mquotes.contryear)-1))
*!*	m.schcode=mquotes.schcode
*!*	select * from mquotes where schcode==m.schcode and alltrim(contryear)=contrlastyear into cursor "tmpmquotes"
*!*	select tmpmquotes
*!*	if reccount()>0
*!*	oldinvno=tmpmquotes.invno
*!*	select produtn
*!*	select * from produtn where invno=oldinvno into cursor tmpprodutn
*!*	select produtn
*!*	if !empty(tmpprodutn.jobno)
*!*	 m.jobno = tmpprodutn.jobno &&give it last years jobno

*!*	*!*	 m.advpw = produtn.prodno
*!*	 m.stfpw = lower(substr(mcust.schstate,1,2))+mcust.contryear
*!*	endif
*!*	endif
*!*	if used("tmpprodutn")
*!*	select tmpprodutn
*!*	use&&close tmpprodutn
*!*	endif
*!*	if used("tmpmquotes")
*!*	select tmpmquotes
*!*	use &&close tmpmquotes
*!*	endif
*!*	endif
m.perfbind='M'
m.nocopies=mquotes.qtytot
m.nopages=mquotes.nopages
sele produtn
insert into produtn from memvar


=tableupdate(.t.)
sele mcust
insert into wipg from memvar
sele wipg
**************************
=tableupdate(.t.)
*sele mcust
*insert into ordagree from memvar
*sele ordagree
*=tableupdate(.t.)

sele wip
insert into wip from memvar
sele wip
=tableupdate(.t.)
sele mcust
m.nopages=0
insert into recv2 from memvar
sele recv2
=tableupdate(.t.)

INSERT INTO surv2 FROM memvar
SELECT surv2
=TABLEUPDATE(.t.)
endif
sele mcust
=tableupdate(.t.)
*set rela to schcode into mquotes,schcode into shipping,schcode into datecont,schcode into newadv
m.nopages=0
m.hndred=.f.
m.hdbky_n=.f.
m.perfbind=""
*select(nselect)
*if curval('mcust.contdate') <> this.value
*!*		thisform.pgfbase1.page1.cboalsqfill1.setfocus()
*endif
seek msrch	
thisform.refresh
ENDPROC
     x˛Úˇ    _  _                        »6   %   ™
      ˆ  ã   ‡
          ¸  U    U    >Ù  ˜ —¸C$˝˛
 ôÙ ˜ ˛ U  MCUST CONTDATE THISFORM REFRESHH Æ˜  ˜ ˜ ˜ ˛= T˜ ¸CŸ Is this sale a Prime product?¯$Ÿ
 Prime SaleÍx˝˛ %¸˜ ¯˝˘n ˛ Tı˜ ¸a˝˛ ˘É ˛ Tı˜ ¸-˝˛ ˛ T˜ ¸Ÿ 0˝˛ Tı˜ ¸Ÿ MER˝˛ T˜ ¸-˝˛ T˜ ¸¯˝˛ Tı˜ ¸˚  ˝˛ Tı˜	 ¸˚  ˝˛ F˜
 ˛ G((˚ schcode˛! %¸CÙ
 ‡ ÍZ

 CÙ
 ‡ ÍZ	˝˘˝˛ %¸CC$H¯˝˘ê˛ >Ù
 ˜ —¸CCCC$i¯Z¯	¯\˝˛ >Ù
 ˜ —¸CCCC$i¯Z¯	¯\˝˛ Tı˜ ¸CCCC$iZ¯	¯\˝˛ Tı˜ ¸ı˜ ˝˛ ˘˘˛ >Ù
 ˜ —¸CCCC$iZ¯	¯\˝˛ >Ù
 ˜ —¸CCCC$iZ¯	¯\˝˛ Tı˜ ¸CCCC$iZ¯	¯\˝˛ Tı˜ ¸ı˜ ˝˛ ˛ ˛ %¸CÙ
 ‡ ÍZ
˝˘•˛ %¸CC$H¯˝˘d˛ >Ù
 ˜ —¸CCCC$i¯Z¯	¯\˝˛ Tı˜ ¸CCCC$i¯Z¯	¯\˝˛ ˘°˛ >Ù
 ˜ —¸CCCC$iZ¯	¯\˝˛ Tı˜ ¸CCCC$iZ¯	¯\˝˛ ˛ ˛
 Ü¸CaÍì˝˛ Tı˜ ¸Ù
 ˜ ˝˛ TÙ ˜ ¸Ù
 ˜ ˝˛ T˜ ¸Ù
 ˜ ˝˛ %¸Ù ˜ ı˜ ˝˘	˛ T˜ ¸a˝˛ ˘˛ T˜ ¸-˝˛ ˛ %¸˜ ˝˘®˛{ T˜ ¸CŸ A Production Record DOES ExistC¯ Ÿ Do you want to ADD another one?˘$Ÿ Production Record DOES Exist?Íx˝˛ ˘˛m T˜ ¸CŸ  Production Record DOES NOT ExistC¯ Ÿ Do you want to ADD one?˘$Ÿ Add Production RecordÍx˝˛ ˛ %¸˜ ¯˝˘Â˛ ˚
 newprodrec(˜ ˛ Q˘  º˚ invcnum˛ F˜ ˛ >Ù ˜ —¸Ù ˜ ¯˝˛ Tı˜ ¸Ù ˜ ˝˛ TÙ ˜ ¸Ù ˜ ˝˛ F˜ ˛ Q˛ F˜
 ˛ Tı˜ ¸Ù
 ˜ ˝˛ Tı˜ ¸Ù
 ˜ ˝˛ Tı˜ ¸Ù
 ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ %¸Ù ˜ ı˜ ˝˘3˛ Tı˜ ¸Ù ˜  ˝˛ >Ù
 ˜! —¸ı˜ ˝˛ ˛" %¸Ù" ˜ ı˜ 	 Ù" ˜# a	˝˘n˛ Tı˜$ ¸˚ Rebook˝˛ ˛ Tı˜% ¸˚  ˝˛ Tı˜& ¸Ÿ  ˝˛ F˜' ˛ Tı˜( ¸Ù' ˜( ˝˛ F˜ ˛ Tı˜ ¸ı˜ ˝˛ rº˚ mquotes.dbf¬˛ %¸˜ Ÿ 0˝˘K˛ Tı˜% ¸CÙ ˆ) ˝˛ Tı˜* ¸-˝˛ Tı˜+ ¸CÙ ˆ, ˝˛ Tı˜- ¸˜+ ˝˛! Tı˜% ¸Ÿ Mı˜% Ÿ  ı˜+ ˝˛ ˘o˛ Tı˜% ¸˜ ˝˛ Tı˜* ¸a˝˛ ˛ F˜ ˛ >Ù ˜% —¸ı˜% ˝˛ >Ù ˜. —¸a˝˛ F˜ ˛
 Ü¸CaÍì˝˛ F˜' ˛ rº˚ covers¬˛ F˜' ˛
 Ü¸CaÍì˝˛ F˜
 ˛ Tı˜. ¸a˝˛ F˜ ˛ Tı˜& ¸˚ M˝˛ Tı˜/ ¸Ù ˜0 ˝˛ Tı˜1 ¸Ù ˜1 ˝˛ F˜2 ˛ rº˚ produtn¬˛
 Ü¸CaÍì˝˛ F˜
 ˛ rº˚ wipg¬˛ F˜3 ˛
 Ü¸CaÍì˝˛ F˜4 ˛ rº˚ wip¬˛ F˜4 ˛
 Ü¸CaÍì˝˛ F˜
 ˛ Tı˜1 ¸¯ ˝˛ rº˚ recv2¬˛ F˜ ˛
 Ü¸CaÍì˝˛ rº˚ surv2¬˛ F˜ ˛
 Ü¸CaÍì˝˛ ˛ F˜
 ˛
 Ü¸CaÍì˝˛ Tı˜1 ¸¯ ˝˛ Tı˜ ¸-˝˛ Tı˜5 ¸-˝˛ Tı˜& ¸Ÿ  ˝˛	 E¸˜ ˝˛
 ôÙ ˜6 ˛ U7  NSELECT PRODY_N LADDNEW MSRCH AA PRIME RETVAL COMPANY CPNUM	 PERFBIND2 MCUST SCHCODE CONTDATE ORIGYEAR	 CONTRYEAR BPYEAR THISFORM CUSTID MQUOTES
 NEWPRODREC INVCNUM INVCNO INVNO INVID SCHNAME BOOKTYPE SCHOUT HNDRED RECV2 SURV2 TOBEAPPLIED RECVMEMO COMPMEMO INOFFICE QTETEMP INVOICED CSTAT PRODNO PERFBIND COVERS SPECINST	 GETPRODNO REORDER	 SPECCOVER GETCOVERNUM SPECOVR NEWPRICE NOCOPIES QTYTOT NOPAGES PRODUTN WIPG WIP HDBKY_N REFRESH Valid,     ˇˇ
 RightClick3     ˇˇ	 LostFocusw     ˇˇ1 4 Ò ° 4 1—— Å — A · !± — Ò Ò s !ÒÒ°Å ±±°A A A!Ò·Å ±°A B ° #1a± Å ± A — ≤É “A bAq q!1r A q !!!!b!!A &TB Ò Ò s !q T#1— 1Ò Å Ò — A q "· q ° s q ° q ‘ w †!!q £ q · q ¢ v — q ° q Ò Ò q ° Ú q ° A q ° Ú — — Ò ï ° 1                                5   j         ä   á      )   _                        textbox      textbox      txtContryear      !SCHOOLS.Pgfbase1.Page1.Container1      ®Comment = ""
ControlSource = "mcust.contryear"
Height = 23
InputMask = "99"
Left = 651
MaxLength = 2
TabIndex = 97
Top = 110
Width = 30
Name = "txtContryear"
     ;PROCEDURE GotFocus
thisform.oldcyear=mcust.contryear
ENDPROC
PROCEDURE Valid
* oldcyear is contryear at gotfocus

if !empty(thisform.oldcyear) and empty(this.value)
sele mquotes

*!*	set order to schcode
*!*	set filter to mquotes.contryear=thisform.oldcyear
*!*	locate
*!*	seek thisform.custid
*!*	if found()
*!*	cMessageTitle = 'Sales Records Exists'
*!*	cMessageText = 'Sales Records EXISTS, Do you want to DELETE them?'
*!*	nDialogType = 4 + 32 + 256
*!*	*  4 = Yes and No buttons
*!*	*  32 = Question mark icon
*!*	*  256 = Second button is default

*!*	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
*!*	if nAnswer=6
*!*	cMessageTitle = 'Notify your Supervisor'
*!*	cMessageText = 'Only Supervisors have the capability to DELETE records!'
*!*	nDialogType = 16
*!*	*delete
*!*	endif
*!*	endif
*!*	set filter to
*!*	locate
*!*	sele mcust
*!*	set order to schcode
*!*	seek thisform.custid
else
if !empty(thisform.oldcyear) and !empty(this.value)
	if thisform.oldcyear<>this.value
	cMessageTitle = 'Year changed to NEW value'
	cMessageText = 'To INSURE accuracy, this entry should be changed from SALES'
	nDialogType = 64
	*  0 = OK button
	*  64 = Information icon
	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
	endif
endif
endif
thisform.refresh
ENDPROC
     ú˛Úˇ    É  É                        ‘∞   %   Â      *               ¸  U    TÙ  ˜ ¸Ù ˜ ˝˛ U  THISFORM OLDCYEAR MCUST	 CONTRYEAR %¸CÙ  ˜ °
	 CÙ ˜ °	˝˘& ˛ F˜ ˛ ˘˛ ˛  %¸CÙ  ˜ °

 CÙ ˜ °
	˝˘˙ ˛ %¸Ù  ˜ Ù ˜ ˝˘ˆ ˛& T˜ ¸˚ Year changed to NEW value˝˛H T˜ ¸˚; To INSURE accuracy, this entry should be changed from SALES˝˛ T˜ ¸¯@˝˛ T˜ ¸C˜ ˜ ˜ Íx˝˛ ˛ ˛ ˛
 ôÙ  ˜	 ˛ U
  THISFORM OLDCYEAR THIS VALUE MQUOTES CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER REFRESH GotFocus,     ˇˇ Validl     ˇˇ1 12 Ûq †Å qaÅ— cA A A ° 1                       5         Q   0      )   É                        label      label      lblContryear      !SCHOOLS.Pgfbase1.Page1.Container1      †AutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "Contract Year"
Height = 17
Left = 569
Top = 110
Width = 76
TabIndex = 28
Name = "lblContryear"
      label      label      lblCategory      !SCHOOLS.Pgfbase1.Page1.Container1      âAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Category"
Left = 40
Top = 8
Width = 49
TabIndex = 2
Name = "lblCategory"
      label      label      lblNextcontdte      !SCHOOLS.Pgfbase1.Page1.Container1      ûAutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "Next Contact"
Height = 17
Left = 290
Top = 7
Width = 71
TabIndex = 4
Name = "lblNextcontdte"
      label      label      lblMktsegment      !SCHOOLS.Pgfbase1.Page1.Container1      ùAutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "Grd Level"
Height = 17
Left = 304
Top = 34
Width = 54
TabIndex = 105
Name = "lblMktsegment"
      label      label      lblLeadsource      !SCHOOLS.Pgfbase1.Page1.Container1      êAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Leadsource"
Left = 23
Top = 89
Width = 66
TabIndex = 113
Name = "lblLeadsource"
      textbox      textbox      txtCurentprov      !SCHOOLS.Pgfbase1.Page1.Container1      ôComment = ""
ControlSource = "mcust.curentprov"
Height = 23
Left = 651
MaxLength = 40
TabIndex = 116
Top = 9
Width = 263
Name = "txtCurentprov"
      label      label      lblCurentprov      !SCHOOLS.Pgfbase1.Page1.Container1      ¨AutoSize = .T.
FontStrikethru = .F.
WordWrap = .F.
BackStyle = 0
Caption = "Current Provider"
Left = 554
Top = 9
Width = 91
TabIndex = 115
Name = "lblCurentprov"
      textbox      textbox      txtNextcallfrom      !SCHOOLS.Pgfbase1.Page1.Container1      ôComment = ""
ControlSource = "mcust.initcont"
Height = 23
Left = 651
MaxLength = 21
TabIndex = 118
Top = 35
Width = 71
Name = "txtNextcallfrom"
      2PROCEDURE RightClick
this.Value=DATE()
ENDPROC
      À˛Úˇ    ≤   ≤                         j8   %   O       i      c           ¸  U    TÙ  ˜ ¸C$˝˛ U  THIS VALUE
 RightClick,     ˇˇ1 Ò 1                       '       )   ≤                         label      label      lblNextcallfrom      !SCHOOLS.Pgfbase1.Page1.Container1      ¶AutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "Intitial Contact"
Height = 17
Left = 566
Top = 35
Width = 79
TabIndex = 117
Name = "lblNextcallfrom"
      textbox      textbox      txtDteschstart      !SCHOOLS.Pgfbase1.Page1.Container1      öComment = ""
ControlSource = "mcust.dteschstart"
Height = 23
Left = 94
MaxLength = 22
TabIndex = 120
Top = 35
Width = 80
Name = "txtDteschstart"
      label      label      lblDteschstart      !SCHOOLS.Pgfbase1.Page1.Container1      †AutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "School Start"
Height = 17
Left = 21
Top = 35
Width = 68
TabIndex = 119
Name = "lblDteschstart"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      !SCHOOLS.Pgfbase1.Page1.Container1      ÓBoundColumn = 2
ColumnCount = 2
ColumnWidths = "150,25"
RowSourceType = 6
RowSource = "mercategory.descriptio,val"
ControlSource = "mcust.category"
Height = 24
ColumnLines = .F.
Left = 94
Top = 8
Width = 170
Name = "Cbobase1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase2      !SCHOOLS.Pgfbase1.Page1.Container1      ˜BoundColumn = 1
ColumnCount = 1
ColumnWidths = "150,25"
RowSourceType = 6
RowSource = "lkpleadsource.name"
ControlSource = "mcust.leadsource"
Height = 24
ColumnLines = .F.
Left = 94
Sorted = .F.
Top = 89
Width = 170
Name = "Cbobase2"
      txtbase      ..\..\common60\basectrl.vcx      textbox      Txtbase1      !SCHOOLS.Pgfbase1.Page1.Container1      éControlSource = "datecont.nxtdate"
Height = 21
Left = 366
ToolTipText = "Right Click To Set Date"
Top = 7
Width = 73
Name = "Txtbase1"
      ﬁPROCEDURE InteractiveChange
	thisform.pgfbase1.page1.nextcallcust.Requery()
ENDPROC
PROCEDURE ProgrammaticChange
thisform.pgfbase1.page1.nextcallcust.Requery()
ENDPROC
PROCEDURE RightClick
DO mousemen.mpr
ENDPROC
     Œ˛Úˇ    µ  µ                        ‚2   %   Û       L     >          ¸  U    ô¸CÙ  Ù Ù Ù ˆ ˝˛ U  THISFORM PGFBASE1 PAGE1 NEXTCALLCUST REQUERY  ô¸CÙ  Ù Ù Ù ˆ ˝˛ U  THISFORM PGFBASE1 PAGE1 NEXTCALLCUST REQUERY  ˚ mousemen.mpr˛ U  MOUSEMEN MPR InteractiveChange,     ˇˇ ProgrammaticChange{     ˇˇ
 RightClick      ˇˇ1 a2 a2 11                       L         u   £         ƒ   ”       )   µ                        textbox      textbox      Text1      !SCHOOLS.Pgfbase1.Page1.Container1      èComment = ""
ControlSource = "mcust.dteschend"
Height = 23
Left = 93
MaxLength = 22
TabIndex = 120
Top = 63
Width = 80
Name = "Text1"
      label      label      Label1      !SCHOOLS.Pgfbase1.Page1.Container1      ñAutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "School End"
Height = 17
Left = 24
Top = 63
Width = 65
TabIndex = 119
Name = "Label1"
      checkbox      checkbox      Check1      !SCHOOLS.Pgfbase1.Page1.Container1      †Top = 88
Left = 287
Height = 17
Width = 51
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = "Prime"
ControlSource = "mcust.aplus"
Name = "Check1"
      chkbase      ..\..\common60\basectrl.vcx      checkbox      Chkbase1      !SCHOOLS.Pgfbase1.Page1.Container1      ™Top = 60
Left = 287
Height = 17
Width = 18
Alignment = 0
BackStyle = 0
Caption = ""
ControlSource = "mcust.multiyear"
BackColor = 221,249,230
Name = "Chkbase1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase4      !SCHOOLS.Pgfbase1.Page1.Container1      ≤FontSize = 8
RowSourceType = 6
RowSource = "lkpmultiyroptions.name"
ControlSource = "mcust.multiyroptions"
Height = 24
Left = 364
Top = 59
Width = 186
Name = "Cbobase4"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase5      !SCHOOLS.Pgfbase1.Page1.Container1      yAutoSize = .T.
BackStyle = 0
Caption = "Multi Year"
Height = 17
Left = 306
Top = 61
Width = 55
Name = "Lblbase5"
      textbox      textbox      Text2      !SCHOOLS.Pgfbase1.Page1.Container1      èComment = ""
ControlSource = "mcust.sourdate"
Height = 23
Left = 649
MaxLength = 21
TabIndex = 118
Top = 61
Width = 71
Name = "Text2"
      2PROCEDURE RightClick
this.Value=DATE()
ENDPROC
      À˛Úˇ    ≤   ≤                         j8   %   O       i      c           ¸  U    TÙ  ˜ ¸C$˝˛ U  THIS VALUE
 RightClick,     ˇˇ1 Ò 1                       '       )   ≤                         label      label      Label2      !SCHOOLS.Pgfbase1.Page1.Container1      ñAutoSize = .T.
WordWrap = .F.
BackStyle = 0
Caption = "Inq. Date"
Height = 17
Left = 589
Top = 61
Width = 51
TabIndex = 117
Name = "Label2"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase3      !SCHOOLS.Pgfbase1.Page1.Container1      öRowSourceType = 6
RowSource = "lkpgradelev.grade"
ControlSource = "mcust.mktsegment"
Height = 24
Left = 366
Top = 33
Width = 90
Name = "Cbobase3"
      label      label      Label3      !SCHOOLS.Pgfbase1.Page1.Container1      ÑAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Name"
Left = 55
Top = 116
Width = 34
TabIndex = 113
Name = "Label3"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase5      !SCHOOLS.Pgfbase1.Page1.Container1      ÚBoundColumn = 1
ColumnCount = 1
ColumnWidths = "150,25"
RowSourceType = 6
RowSource = "lkpjosname.name"
ControlSource = "mcust.josname"
Height = 24
ColumnLines = .F.
Left = 94
Sorted = .F.
Top = 116
Width = 140
Name = "Cbobase5"
      	container      	container      
Container2      SCHOOLS.Pgfbase1.Page1      STop = 65
Left = 8
Width = 927
Height = 108
BackStyle = 0
Name = "Container2"
      textbox      textbox      
txtSchaddr      !SCHOOLS.Pgfbase1.Page1.Container2      ∑Comment = ""
FontSize = 8
ControlSource = "mcust.schaddr"
Height = 23
Left = 62
MaxLength = 50
TabIndex = 37
Top = 13
Width = 364
BorderColor = 64,0,64
Name = "txtSchaddr"
      label      label      
lblSchaddr      !SCHOOLS.Pgfbase1.Page1.Container2      öAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "School Addr"
Height = 32
Left = 14
Top = 13
Width = 40
TabIndex = 35
Name = "lblSchaddr"
      textbox      textbox      txtSchaddr2      !SCHOOLS.Pgfbase1.Page1.Container2      ¢Comment = ""
FontSize = 8
ControlSource = "mcust.schaddr2"
Height = 23
Left = 62
MaxLength = 50
TabIndex = 38
Top = 37
Width = 364
Name = "txtSchaddr2"
      `PROCEDURE LostFocus
set confirm off

ENDPROC
PROCEDURE GotFocus
set confirm on

ENDPROC
      Á˛Úˇ    Œ   Œ                         94   %   F       u      k           ¸  U  	  G	˛ U  	  G	 ˛ U  	 LostFocus,     ˇˇ GotFocus9     ˇˇ1 a 3 a 2                       &         E   U       )   Œ                         textbox      textbox      
txtSchcity      !SCHOOLS.Pgfbase1.Page1.Container2      üComment = ""
ControlSource = "mcust.schcity"
Format = ""
Height = 23
Left = 93
MaxLength = 21
TabIndex = 39
Top = 61
Width = 120
Name = "txtSchcity"
      textbox      textbox      txtSchstate      !SCHOOLS.Pgfbase1.Page1.Container2      °Comment = ""
ControlSource = "mcust.schstate"
Format = "!"
Height = 23
Left = 262
MaxLength = 3
TabIndex = 40
Top = 61
Width = 33
Name = "txtSchstate"
      textbox      textbox      	txtSchzip      !SCHOOLS.Pgfbase1.Page1.Container2      ™Comment = ""
ControlSource = "mcust.schzip"
Height = 23
InputMask = "99999-9999"
Left = 350
MaxLength = 10
TabIndex = 41
Top = 61
Width = 76
Name = "txtSchzip"
      textbox      textbox      txtSchphone      !SCHOOLS.Pgfbase1.Page1.Container2      æComment = ""
ControlSource = "mcust.schphone"
Height = 23
InputMask = "(999)999-9999XXXXXXXXXXXX"
Left = 547
MaxLength = 14
TabIndex = 43
Top = 13
Width = 147
Name = "txtSchphone"
      label      label      lblSchphone      !SCHOOLS.Pgfbase1.Page1.Container2      âAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Phone"
Left = 499
Top = 13
Width = 36
TabIndex = 42
Name = "lblSchphone"
      textbox      textbox      	txtSchfax      !SCHOOLS.Pgfbase1.Page1.Container2      ÆComment = ""
ControlSource = "mcust.schfax"
Height = 23
InputMask = "(999)999-9999"
Left = 726
MaxLength = 14
TabIndex = 45
Top = 13
Width = 130
Name = "txtSchfax"
      label      label      	lblSchfax      !SCHOOLS.Pgfbase1.Page1.Container2      ÖAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Fax"
Left = 697
Top = 13
Width = 19
TabIndex = 44
Name = "lblSchfax"
      textbox      textbox      txtSchemail      !SCHOOLS.Pgfbase1.Page1.Container2      ïComment = ""
ControlSource = "mcust.schemail"
Height = 23
Left = 546
MaxLength = 45
TabIndex = 47
Top = 37
Width = 310
Name = "txtSchemail"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase3      !SCHOOLS.Pgfbase1.Page1.Container2      bTop = 61
Left = 38
Height = 23
Width = 48
Caption = "City"
TabIndex = 71
Name = "Cmdbase3"
      1PROCEDURE Click
thisform.citysrch()

ENDPROC
      À˛Úˇ    ≤   ≤                         j8   %   T       i      c           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM CITYSRCH Click,     ˇˇ1 — 2                       &       )   ≤                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase4      !SCHOOLS.Pgfbase1.Page1.Container2      bTop = 61
Left = 299
Height = 22
Width = 44
Caption = "Zip"
TabIndex = 73
Name = "Cmdbase4"
      0PROCEDURE Click
thisform.zipsrch()

ENDPROC
       ˛Úˇ    ±   ±                         ”   %   S       h      b           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM ZIPSRCH Click,     ˇˇ1 — 2                       %       )   ±                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase9      !SCHOOLS.Pgfbase1.Page1.Container2      dTop = 61
Left = 217
Height = 22
Width = 44
Caption = "State"
TabIndex = 74
Name = "Cmdbase9"
      0PROCEDURE Click
thisform.stesrch()

ENDPROC
       ˛Úˇ    ±   ±                         ”   %   S       h      b           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM STESRCH Click,     ˇˇ1 — 2                       %       )   ±                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      	Cmdbase12      !SCHOOLS.Pgfbase1.Page1.Container2      |AutoSize = .F.
Top = 37
Left = 444
Height = 24
Width = 91
Caption = "School Email"
TabIndex = 72
Name = "Cmdbase12"
     PROCEDURE Click
DO case
CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
	cMessageTitle = 'Telephone log ENTRY required'
	cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
	nDialogType = 16
	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
	NODEFAULT

*!*	CASE thisform.telelog=.t.  &&took out by rw for new marketing
*!*		IF substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT
*!*			else
*!*			thisform.ckchng
*!*	define window jbrowser from 15,5 to 23,75;
*!*		color scheme 10;
*!*		float grow zoom
*!*		
*!*	sele mcust
*!*	set order to schemail
*!*	_jexitkey=13
*!*	_jdblclick=-1

*!*	store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

*!*	=jkeyinit("A","","Search For: ")

*!*	brow window jbrowser fiel schemail:40,schname:20,mquotes.prodno:11:;
*!*	H="Production #",schcity,schcode noedit nodelete


*!*	=jkeycanc()
*!*	set order to schcode
*!*	release wind jbrowser
*!*	thisform.custid=mcust.schcode
*!*	thisform.invid=0
*!*	if mquotes.schcode=mcust.schcode
*!*	thisform.invid=mquotes.invno
*!*	endif
*!*	thisform.refresh
*!*	thisform.telelog=.f.
*!*		ENDIF
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to schemail
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")

brow window jbrowser fiel schemail:40,schname:20,mquotes.prodno:11:;
H="Production #",schcity,schcode noedit nodelete


=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase
	

ENDPROC
     ﬂ˛Úˇ    ∆  ∆                        y   %   *      }  "   9          ¸  U  ¢ H˘ ˘õ˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛ 2˘õ˛
 ôÙ  ˜
 ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚ schemail˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛@ 	˜ …¯(˜ …¯Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘;˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜ ¸-˝˛ TÙ  Ù Ù Ù Ù  ˜! ¸¯ ˝˛ TÙ  Ù Ù Ù Ù" ˜# ¸a˝˛ ˛ U$  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER CKCHNG JBROWSER SCHEMAIL	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH MKTLOG PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLED Click,     ˇˇ1 — °ë°— aA 0Å ¢ £r — · ¬£ Å 1q1A ° · · ¡°A 3                             )   ∆                        txtbase      ..\..\common60\basectrl.vcx      textbox      txtweb      !SCHOOLS.Pgfbase1.Page1.Container2      ÇControlSource = "mcust.website"
Height = 23
Left = 546
MaxLength = 50
ReadOnly = .F.
Top = 61
Width = 310
Name = "txtweb"
      _hyperlinkcommandbutton      ..\..\common60\_hyperlink.vcx      commandbutton      _hyperlinkcommandbutton2      !SCHOOLS.Pgfbase1.Page1.Container2      STop = 61
Left = 443
Caption = "Open Website"
Name = "_hyperlinkcommandbutton2"
      LPROCEDURE Click
this.ctarget=alltrim(mcust.website)
dodefault()
ENDPROC
      È˛Úˇ    –   –                         ¢Ë   %   p       á                 ¸  U  !  TÙ  ˜ ¸CÙ ˜ õ˝˛	 ô¸CÍ°˝˛ U  THIS CTARGET MCUST WEBSITE Click,     ˇˇ1 Që 1                       A       )   –                         checkbox      checkbox      Check1      !SCHOOLS.Pgfbase1.Page1.Container2      ¥Top = 13
Left = 859
Height = 14
Width = 66
FontSize = 7
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = "No Contact"
ControlSource = "mcust.nocont"
Name = "Check1"
      cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager3      SCHOOLS.Pgfbase1.Page1     äAutoSize = .T.
Top = 441
Left = 752
Height = 27
Width = 150
Picture = ..\
Caption = "Email  Production Ticket"
Enabled = .T.
maincursor = m:\mbc5\pticket.dbf
emailperrecipient = .F.
currentrecordonly = .F.
emailaddress = [production@memorybook.com]
emailaddresscc = 
forcepreview = .T.
recipientname = 
attachment = [C:\mbc5\pdf\] + alltrim(pticket.schname) + [ Production Ticket.pdf;]+[C:\mbc5\pdf\] + alltrim(pticket.schname) + [ packingslip.pdf]
unreadonly = .T.
body = 
subject =  alltrim(pticket.schname) + [ Meridian Production Ticket]
settings_emailaddress = 
ccursorsource = m:\mbc5\pticket.dbf
Name = "Cmdmailmanager3"
     GPROCEDURE Click

#include registry.h
LOCAL m.goodtogo
IF EMPTY(MQUOTES.SCHTYPE)
MESSAGEBOX("Planner Type is empty, please go to sales screen and enter a planner type.",16,"Missing Planner Type")
return
 endif
m.goodtogo=.f.
cprintername="pdfFactory"  
SET exact on
APRINTER(cprinters)
nfound=ascan(cprinters,cprintername)&&see if pdf factory is on computer
IF nfound  > 0
	SET Printer To Name "pdfFactory" &&(cprintername)
	
	m.goodtogo=.t.
ELSE
	nreturn=MESSAGEBOX("PDF Factory is requied for this operation but was not found on this computer."+chr(13)+;
		"Click OK to choose a PDF Factory printer or Cancel to leave this operation.",65,"Printer Not Found")
	DO case
		CASE nreturn=1
		cPrinter = GETPRINTER()&&Getprinter()in case pdf factory printer has been renamed
IF NOT EMPTY(cPrinter)
  SET PRINTER TO NAME (cPrinter)
  m.goodtogo=.t.
  else
  m.goodtogo=.f.
ENDIF			
		CASE nreturn=2
			m.goodtogo=.f. &&program will do nothing user can close out
	ENDCASE
ENDIF
IF m.goodtogo=.t. 



*!*	*set registry so that dialog in pdf factory does not show and pdf factory saves pdf
*!*		ShowDlg 	PdfAction  	Description
*!*	1 	n/a 	show UI after spooling
*!*	2 	0 	do not show UI, do not email, do not view PDF file
*!*	2 	1 	do not show UI but view PDF file
*!*	2 	2 	do not show UI but put PDF file in an email
*!*	2 	3 	do not show UI but execute a program*
*auto save=1 to save 0 not to save

*set up pdf factory
	lnshowdialog=2 &&hides dialog and sends email
	lnpdfaction=0
	lnautosave=1
	lnsessions=0
	thisform.reg.setdwordregkey("ShowDlg",@lnshowdialog,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)
	thisform.reg.setdwordregkey("PdfAction",@lnpdfaction,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)
	thisform.reg.setdwordregkey("AutoSave",@lnautosave,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)
	thisform.reg.setdwordregkey("AutoSaveSessions",@lnsessions,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)

&&------------
TRY
if !used('pticket')
use pticket in 0 excl
sele pticket
endif
if used('pticket')
dele all
pack
endif
sele mcust
m.invno=produtn.invno
m.schcode=mcust.schcode
m.schname=mcust.schname
m.schstate=mcust.schstate
m.typestyle=IIF(mquotes.lf=.t.,"LF","SF")
m.bindvend=produtn.bindvend
m.vendcd=produtn.vendcd
m.ponum=mquotes.ponum

m.schtype=mquotes.schtype
m.booktype=mquotes.booktype
m.nopages=mquotes.nopages
m.se=mquotes.qtystud
mcover=produtn.covertype
m.covertype=produtn.covertype
m.desc=covers.desc2
m.desc1a=covers.desc3
m.desc1b=covers.desc4
m.emailed=covers.emailed
m.hallpqty=mquotes.hallpqty 
m.bmarkqty=mquotes.bmarkqty
m.vpaqty=mquotes.vpaqty
m.vpbqty=mquotes.vpbqty
m.te=mquotes.teachedtqty
m.idpouchqty=mquotes.idpouchqty
m.stdtitpgqt=mquotes.stdtitpgqty
m.duraglzqty=mquotes.duraglzqty
m.wallchqty=mquotes.wallchqty
m.impguidqty=mquotes.impguidqty
m.spcinst=mcust.spcinst
m.typesetqty=mquotes.typesetqty
m.prodno=produtn.prodno
m.contryear=mquotes.contryear
m.coverdesc=produtn.coverdesc
m.pdfsent=produtn.pdfsent
m.foilclr=produtn.foilclr
m.prshpdte=produtn.prshpdte
m.hrdcpyprf=mquotes.hrdcpyprf
insert into pticket from memvar
sele pticket

*!*	repo form prodtktm to prin noconsole

catch
IsOK=messagebox("Another User has file locked"+;
	chr(13)+"Select OK and try again",48,;
	"Print Production Ticket")
	return
endtry

&&-----------

lcfilepathval="C:\mbc5\pdf\" + alltrim(pticket.schname) + " Production Ticket.pdf"&&set name of file to be created and create it in given directory
		thisform.reg.setregkey("OutputFilePerm",@lcfilepathval,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)&&sets file name
		lcDefaultPrinter =  SET("PRINTER",3)
		REPO form prodtktm noconsole to PRINTER  
	GO 1
	
		WAIT window "Creating pdf file "+ alltrim(pticket.schname) + "Production Ticket.pdf" timeout 1 &&this line must be here it give the registry time to save it self. With out it the previous settings are used before the new one take effect
		*set path and file name for packing slip and print
		sele pticket
lcfilepathval="C:\mbc5\pdf\" + alltrim(pticket.schname) + " packingslip.pdf"&&set name of file to be created and create it in given directory		
thisform.reg.setregkey("OutputFilePerm",@lcfilepathval,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)&&sets file name
	thisform.printpkglist("email") 
	WAIT window "Creating pdf file "+ alltrim(pticket.schname) + "Production Ticket.pdf" timeout 1 &&this line must be here it give the registry time to save it self. With out it the previous settings are used before the new one take effect
	
	SET Printer To Default
**return back to normal
	lnshowdialog=1 &&shows dialog
	lnpdfaction=0
	thisform.reg.setdwordregkey("ShowDlg",@lnshowdialog,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)
	thisform.reg.setdwordregkey("PdfAction",@lnpdfaction,"SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\",HKEY_CURRENT_USER,.T.)




SELECT pticket
DoDefault()&&mail manager code
*!*	sele pticket
*!*	use
ELSE && good to go

endif
if used('pticket')
SELECT pticket
use

ENDIF
SELECT mcust
ENDPROC
     ú˛Úˇ    É  É                        '¢   %   A      :  u   P          ¸  U  v	 Æı˜  ˛ %¸CÙ ˜ °˝˘è ˛p ô¸CŸJ Planner Type is empty, please go to sales screen and enter a planner type.¯Ÿ Missing Planner TypeÍx˝˛ B˛ ˛ Tı˜  ¸-˝˛ T˜ ¸Ÿ
 pdfFactory˝˛ G ˛ ô¸CÍ˜ Íô˝˛ T˜ ¸CÎ˜ ˜ Í˝˛ %¸˜ ¯ ˝˘˛ G*(J¸Ÿ
 pdfFactory˝˛ Tı˜  ¸a˝˛ ˘t˛… T˜ ¸CŸM PDF Factory is requied for this operation but was not found on this computer.C¯ ŸK Click OK to choose a PDF Factory printer or Cancel to leave this operation.¯AŸ Printer Not FoundÍx˝˛ H˘Ò˘p˛ ¸˜ ¯˝˘R˛ T˜ ¸CÍö˝˛ %¸C˜ °
˝˘9˛ G*(J¸˜ ˝˛ Tı˜  ¸a˝˛ ˘N˛ Tı˜  ¸-˝˛ ˛ ¸˜ ¯˝˘p˛ Tı˜  ¸-˝˛ ˛ ˛ %¸ı˜  a˝˘;˛ T˜ ¸¯˝˛ T˜	 ¸¯ ˝˛ T˜
 ¸¯˝˛ T˜ ¸¯ ˝˛h ô¸CŸ ShowDlg˜ Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆ ˝˛j ô¸CŸ	 PdfAction˜	 Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆ ˝˛i ô¸CŸ AutoSave˜
 Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆ ˝˛q ô¸CŸ AutoSaveSessions˜ Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆ ˝˛ ∫˘ï˛ %¸C˚ pticket™
˝˘£˛ Q˘  º˚ pticket˛ F˜ ˛ ˛ %¸C˚ pticket™˝˘∆˛ ˛ 3˛ ˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛& Tı˜ ¸CÙ ˜ aÚ Ÿ LFÛ Ÿ SF6˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ T˜  ¸Ù ˜! ˝˛ Tı˜! ¸Ù ˜! ˝˛ Tı˜" ¸Ù# ˜$ ˝˛ Tı˜% ¸Ù# ˜& ˝˛ Tı˜' ¸Ù# ˜( ˝˛ Tı˜) ¸Ù# ˜) ˝˛ Tı˜* ¸Ù ˜* ˝˛ Tı˜+ ¸Ù ˜+ ˝˛ Tı˜, ¸Ù ˜, ˝˛ Tı˜- ¸Ù ˜- ˝˛ Tı˜. ¸Ù ˜/ ˝˛ Tı˜0 ¸Ù ˜0 ˝˛ Tı˜1 ¸Ù ˜2 ˝˛ Tı˜3 ¸Ù ˜3 ˝˛ Tı˜4 ¸Ù ˜4 ˝˛ Tı˜5 ¸Ù ˜5 ˝˛ Tı˜6 ¸Ù ˜6 ˝˛ Tı˜7 ¸Ù ˜7 ˝˛ Tı˜8 ¸Ù ˜8 ˝˛ Tı˜9 ¸Ù ˜9 ˝˛ Tı˜: ¸Ù ˜: ˝˛ Tı˜; ¸Ù ˜; ˝˛ Tı˜< ¸Ù ˜< ˝˛ Tı˜= ¸Ù ˜= ˝˛ Tı˜> ¸Ù ˜> ˝˛ rº˚ pticket¬˛ F˜ ˛ ª˘˛j T˜? ¸CŸ Another User has file lockedC¯ Ÿ Select OK and try again¯0Ÿ Print Production TicketÍx˝˛ B˛ æ˛< T˜@ ¸Ÿ C:\mbc5\pdf\CÙ ˜ õŸ  Production Ticket.pdf˝˛o ô¸CŸ OutputFilePerm˜@ Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆA ˝˛ T˜B ¸CŸ PRINTER¯v˝˛ ?˚ prodtktm(!9˛	 #¸¯˝˛D R,Œ¸¯˝¸Ÿ Creating pdf file CÙ ˜ õŸ Production Ticket.pdf˝˛ F˜ ˛6 T˜@ ¸Ÿ C:\mbc5\pdf\CÙ ˜ õŸ  packingslip.pdf˝˛o ô¸CŸ OutputFilePerm˜@ Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆA ˝˛ ô¸CŸ emailÙ ˆD ˝˛D R,Œ¸¯˝¸Ÿ Creating pdf file CÙ ˜ õŸ Production Ticket.pdf˝˛ G*(˛ T˜ ¸¯˝˛ T˜	 ¸¯ ˝˛h ô¸CŸ ShowDlg˜ Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆ ˝˛j ô¸CŸ	 PdfAction˜	 Ÿ@ SOFTWARE\FinePrint Software\pdfFactory3\FinePrinters\pdfFactory\È  ÄaÙ Ù ˆ ˝˛ F˜ ˛	 ô¸CÍ°˝˛ ˘C˛ ˛ %¸C˚ pticket™˝˘h˛ F˜ ˛ Q˛ ˛ F˜ ˛ UE  GOODTOGO MQUOTES SCHTYPE CPRINTERNAME	 CPRINTERS NFOUND NRETURN CPRINTER LNSHOWDIALOG LNPDFACTION
 LNAUTOSAVE
 LNSESSIONS THISFORM REG SETDWORDREGKEY PTICKET ALL MCUST INVNO PRODUTN SCHCODE SCHNAME SCHSTATE	 TYPESTYLE LF BINDVEND VENDCD PONUM BOOKTYPE NOPAGES SE QTYSTUD MCOVER	 COVERTYPE DESC COVERS DESC2 DESC1A DESC3 DESC1B DESC4 EMAILED HALLPQTY BMARKQTY VPAQTY VPBQTY TE TEACHEDTQTY
 IDPOUCHQTY
 STDTITPGQT STDTITPGQTY
 DURAGLZQTY	 WALLCHQTY
 IMPGUIDQTY SPCINST
 TYPESETQTY PRODNO	 CONTRYEAR	 COVERDESC PDFSENT FOILCLR PRSHPDTE	 HRDCPYPRF ISOK LCFILEPATHVAL	 SETREGKEY LCDEFAULTPRINTER PRODTKTM PRINTPKGLIST Click,     ˇˇ1 ì !A A — qa · Aa“ Å í— — — — Å — A — A A ﬁ — — — Å°ëÉ qAq A aQ A A q !!!!a!!!"!!!!!!!!!!!!!!!!!!!!!!!!!!!q Ñ £A A ƒÒë1ë Br aÒQAr “ — Å°u ë É B aq A B q 1                       <      )   É                        lblbase      ..\..\common60\basectrl.vcx      label      	Lblbase11      SCHOOLS.Pgfbase1.Page1      ±AutoSize = .T.
FontBold = .T.
FontSize = 10
Caption = "Cancel Date"
Height = 18
Left = 622
Top = 336
Width = 79
TabIndex = 102
ForeColor = 255,0,0
Name = "Lblbase11"
      textbox      textbox      
txtXelDate      SCHOOLS.Pgfbase1.Page1      œComment = ""
DateFormat = 13
ControlSource = "mcust.xeldate"
Height = 23
Left = 704
TabIndex = 14
ToolTipText = "Click Right Mouse Button for Today's Date"
Top = 332
Width = 71
Name = "txtXelDate"
      OPROCEDURE RightClick
repl mcust.xeldate with date()
this.refresh

ENDPROC
      È˛Úˇ    –   –                         ¢Ë   %   k       á                 ¸  U    >Ù  ˜ —¸C$˝˛
 ôÙ ˜ ˛ U  MCUST XELDATE THIS REFRESH
 RightClick,     ˇˇ1 Ò ° 2                       D       )   –                         chkbase      ..\..\common60\basectrl.vcx      checkbox      Chkbase2      SCHOOLS.Pgfbase1.Page1      ”Comment = ""
Top = 42
Left = 8
Height = 18
Width = 123
FontBold = .T.
Alignment = 0
BackStyle = 0
Caption = "School Is Closed"
ControlSource = "mcust.schclosed"
ForeColor = 255,0,0
Name = "Chkbase2"
      textbox      textbox      
txtSchname      SCHOOLS.Pgfbase1.Page2      ˛Comment = ""
FontBold = .T.
ControlSource = "mcust.schname"
Enabled = .F.
Format = "!"
Height = 27
Left = 196
MaxLength = 34
TabIndex = 2
Top = 8
Width = 246
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
Name = "txtSchname"
      textbox      textbox      	txtGender      SCHOOLS.Pgfbase1.Page2      úComment = ""
ControlSource = "mcust.gender"
Format = "!"
Height = 23
Left = 412
MaxLength = 1
TabIndex = 5
Top = 55
Width = 21
Name = "txtGender"
      label      label      	lblGender      SCHOOLS.Pgfbase1.Page2      ÑAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "M/F"
Left = 385
Top = 59
Width = 19
TabIndex = 4
Name = "lblGender"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase1      SCHOOLS.Pgfbase1.Page2      ÄBackStyle = 0
Caption = "Position"
Height = 17
Left = 101
Top = 58
Width = 47
BackColor = 255,255,255
Name = "Lblbase1"
      textbox      textbox      txtContfname      SCHOOLS.Pgfbase1.Page2      £Comment = ""
ControlSource = "mcust.contfname"
Format = ""
Height = 23
Left = 171
MaxLength = 20
TabIndex = 8
Top = 81
Width = 148
Name = "txtContfname"
      textbox      textbox      txtContlname      SCHOOLS.Pgfbase1.Page2      §Comment = ""
ControlSource = "mcust.contlname"
Format = ""
Height = 23
Left = 447
MaxLength = 20
TabIndex = 10
Top = 81
Width = 148
Name = "txtContlname"
      textbox      textbox      txtContaddr      SCHOOLS.Pgfbase1.Page2      ñComment = ""
ControlSource = "mcust.contaddr"
Height = 23
Left = 160
MaxLength = 30
TabIndex = 12
Top = 107
Width = 218
Name = "txtContaddr"
      label      label      lblContaddr      SCHOOLS.Pgfbase1.Page2      åAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Address"
Left = 101
Top = 111
Width = 46
TabIndex = 11
Name = "lblContaddr"
      textbox      textbox      txtContaddr2      SCHOOLS.Pgfbase1.Page2      òComment = ""
ControlSource = "mcust.contaddr2"
Height = 23
Left = 400
MaxLength = 30
TabIndex = 14
Top = 107
Width = 218
Name = "txtContaddr2"
      textbox      textbox      txtContcity      SCHOOLS.Pgfbase1.Page2      £Comment = ""
ControlSource = "mcust.contcity"
Format = ""
Height = 23
Left = 159
MaxLength = 21
TabIndex = 16
Top = 133
Width = 120
Name = "txtContcity"
      label      label      lblContcity      SCHOOLS.Pgfbase1.Page2      âAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "City"
Left = 101
Top = 137
Width = 20
TabIndex = 15
Name = "lblContcity"
      textbox      textbox      txtContstate      SCHOOLS.Pgfbase1.Page2      £Comment = ""
ControlSource = "mcust.contstate"
Format = ""
Height = 23
Left = 328
MaxLength = 3
TabIndex = 18
Top = 133
Width = 33
Name = "txtContstate"
      label      label      lblContstate      SCHOOLS.Pgfbase1.Page2      ãAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "State"
Left = 296
Top = 137
Width = 28
TabIndex = 17
Name = "lblContstate"
      textbox      textbox      
txtContzip      SCHOOLS.Pgfbase1.Page2      ≠Comment = ""
ControlSource = "mcust.contzip"
Height = 23
InputMask = "99999-9999"
Left = 412
MaxLength = 10
TabIndex = 20
Top = 133
Width = 76
Name = "txtContzip"
      label      label      
lblContzip      SCHOOLS.Pgfbase1.Page2      áAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Zip"
Left = 387
Top = 137
Width = 17
TabIndex = 19
Name = "lblContzip"
      textbox      textbox      txtContphnhom      SCHOOLS.Pgfbase1.Page2      ∂Comment = ""
ControlSource = "mcust.contphnhom"
Height = 23
InputMask = "(999)999-9999"
Left = 196
MaxLength = 14
TabIndex = 22
Top = 159
Width = 91
Name = "txtContphnhom"
      label      label      lblContphnhom      SCHOOLS.Pgfbase1.Page2      ëAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Home Phone"
Left = 101
Top = 163
Width = 73
TabIndex = 21
Name = "lblContphnhom"
      textbox      textbox      txtContphnwrk      SCHOOLS.Pgfbase1.Page2      √Comment = ""
ControlSource = "mcust.contphnwrk"
Height = 23
InputMask = "(999)999-9999XXXXXXXXXXXX"
Left = 396
MaxLength = 14
TabIndex = 24
Top = 159
Width = 142
Name = "txtContphnwrk"
      label      label      lblContphnwrk      SCHOOLS.Pgfbase1.Page2      ëAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Work Phone"
Left = 321
Top = 164
Width = 67
TabIndex = 23
Name = "lblContphnwrk"
      textbox      textbox      
txtContfax      SCHOOLS.Pgfbase1.Page2      ∞Comment = ""
ControlSource = "mcust.contfax"
Height = 23
InputMask = "(999)999-9999"
Left = 569
MaxLength = 14
TabIndex = 26
Top = 159
Width = 91
Name = "txtContfax"
      label      label      
lblContfax      SCHOOLS.Pgfbase1.Page2      áAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Fax"
Left = 542
Top = 163
Width = 19
TabIndex = 25
Name = "lblContfax"
      textbox      textbox      txtContemail      SCHOOLS.Pgfbase1.Page2      òComment = ""
ControlSource = "mcust.contemail"
Height = 23
Left = 148
MaxLength = 45
TabIndex = 28
Top = 184
Width = 322
Name = "txtContemail"
      label      label      lblContemail      SCHOOLS.Pgfbase1.Page2      ãAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Email"
Left = 101
Top = 189
Width = 32
TabIndex = 27
Name = "lblContemail"
      editbox      editbox      edtContmemo      SCHOOLS.Pgfbase1.Page2      áComment = ""
Height = 104
Left = 115
TabIndex = 30
Top = 431
Width = 616
ControlSource = "mcust.contmemo"
Name = "edtContmemo"
      label      label      lblContmemo      SCHOOLS.Pgfbase1.Page2      ëAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Contact Memo"
Left = 104
Top = 415
Width = 79
TabIndex = 29
Name = "lblContmemo"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase1      SCHOOLS.Pgfbase1.Page2      ZTop = 83
Left = 101
Height = 21
Width = 67
Caption = "First Name"
Name = "Cmdbase1"
      .PROCEDURE Click
thisform.fstsrch()
ENDPROC
       ˛Úˇ    ±   ±                         ”   %   S       h      b           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM FSTSRCH Click,     ˇˇ1 — 1                       #       )   ±                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase2      SCHOOLS.Pgfbase1.Page2      YTop = 83
Left = 368
Height = 22
Width = 72
Caption = "Last Name"
Name = "Cmdbase2"
      .PROCEDURE Click
thisform.lstsrch

ENDPROC
      «˛Úˇ    Æ   Æ                         ﬂ√   %   P       e      _           ¸  U   
 ôÙ  ˜ ˛ U  THISFORM LSTSRCH Click,     ˇˇ1 ° 2                       #       )   Æ                         cboalsqfill      ..\..\common60\basectrl.vcx      combobox      Cboalsqfill1      SCHOOLS.Pgfbase1.Page2      ·RowSourceType = 6
RowSource = "contpstn.position"
ControlSource = "mCust.nposition"
Height = 24
Left = 160
TabIndex = 3
Top = 55
Width = 156
calias = contpstn
cfield = position
corder = pstn
Name = "Cboalsqfill1"
     hPROCEDURE LostFocus
thisform.pgfbase1.page2.txtgender.setfocus()
ENDPROC
PROCEDURE Valid
sele contpstn
go top
locate for upper(alltrim(contpstn.position))=upper(alltrim(this.displayvalue))
if !found()
	appe blank
	repl contpstn.position with this.displayvalue
	sele mcust
	repl mcust.position with this.displayvalue
endif
this.requery

ENDPROC
     ›˛Úˇ    ƒ  ƒ                        ¬ˇ   %   -      k     O          ¸  U    ô¸CÙ  Ù Ù Ù ˆ ˝˛ U  THISFORM PGFBASE1 PAGE2	 TXTGENDER SETFOCUSx  F˜  ˛ #)˛ -¸CCÙ  ˜ õfCCÙ ˜ õf˝˛ %¸C4
˝˘g ˛ ˛ >Ù  ˜ —¸Ù ˜ ˝˛ F˜ ˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛
 ôÙ ˜ ˛ U  CONTPSTN POSITION THIS DISPLAYVALUE MCUST REQUERY	 LostFocus,     ˇˇ Validy     ˇˇ1 a2 q Q ¡— Q 1q 1A ° 2                       A         ]   ]      )   ƒ                        cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager2      SCHOOLS.Pgfbase1.Page2     ªTop = 205
Left = 522
Height = 21
Width = 26
Picture = ..\mail.bmp
ToolTipText = "Uses c:\mbc5\email.txt for body"
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = TempMail
maincursor = TempMail
currentrecordonly = .F.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 
settings_emailaddress = 
settings_subject = 
settings_body = filetostr("m:\mbc5\emailtext\email.txt")
settings_attachment = 1|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = iif(!empty(ALLTRIM(TempMail.cname)),ALLTRIM(TempMail.cname),"Recipient")
emailaddress = alltrim(TempMail.emailaddress)
subject = alltrim(mcust.schcode)+" "+alltrim(mcust.schname)
body = filetostr("m:\mbc5\emailtext\email.txt")
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager2"
     ≈PROCEDURE Init
dodefault()
*repl mailtemp.mailltr with filetostr('m:\mbc5\email.txt')

ENDPROC
PROCEDURE Click
*Ensures that there is a name in the 1st advisor name fields, one or the other or both must be filled.
* If left empty the mail manager crashes
if empty(thisform.pgfbase1.Page2.txtContfname.text) and empty(thisform.pgfbase1.Page2.txtContlname.text)
nodefault
Messagebox("Please enter a name for the advisor name fields.",64,"Advisor Name Field")

else
CREATE CURSOR TempMail (emailaddress C(45),cname C(60))

do case
case this.parent.krdoptgroup.option4.value=1 &&school
select mcust
m.emailaddress=mcust.schemail
m.cname= mcust.schname
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

case this.parent.krdoptgroup.option2.value=1 &&first contact
select mcust
m.emailaddress=mcust.contemail
m.cname=alltrim(mcust.contfname)+" "+alltrim(contlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

case this.parent.krdoptgroup.option3.value=1 &&second cont
select mcust
m.emailaddress=mcust.bcontemail
m.cname=alltrim(mcust.bcontfname)+" "+alltrim(bcontlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

otherwise && all contact
select mcust
m.emailaddress=mcust.schemail
m.cname= mcust.schname
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

select mcust
m.emailaddress=mcust.contemail
m.cname=alltrim(mcust.contfname)+" "+alltrim(contlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname


select mcust
m.emailaddress=mcust.bcontemail
m.cname=alltrim(mcust.bcontfname)+" "+alltrim(bcontlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

endcase

dodefault()
select TempMail
use


endif
ENDPROC
     Ω˛Úˇ    §  §                        ±Ÿ   %   ¥      K  =   —          ¸  U   	 ô¸CÍ°˝˛ U  |0 %¸CÙ  Ù Ù Ù ˜ ° CÙ  Ù Ù Ù ˜ °	˝˘à ˛ ¨˛T ô¸CŸ0 Please enter a name for the advisor name fields.¯@Ÿ Advisor Name FieldÍx˝˛ ˘u˛/ hΩ˚ TempMail˜ ˚ C¸¯-˝˜ ˚ C¸¯<˝˛ H˘Ã ˘]˛ ¸Ù	 Ù
 Ù Ù ˜ ¯˝˘>˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ ¸Ù	 Ù
 Ù Ù ˜ ¯˝˘Ω˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸CÙ ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ ¸Ù	 Ù
 Ù Ù ˜ ¯˝˘<˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸CÙ ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ 2˘]˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸Ù ˜ ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸CÙ ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ F˜ ˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸CÙ ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ ˛	 ô¸CÍ°˝˛ F˜ ˛ Q˛ ˛ U  THISFORM PGFBASE1 PAGE2 TXTCONTFNAME TEXT TXTCONTLNAME TEMPMAIL EMAILADDRESS CNAME THIS PARENT KRDOPTGROUP OPTION4 VALUE MCUST SCHEMAIL SCHNAME OPTION2	 CONTEMAIL	 CONTFNAME	 CONTLNAME OPTION3
 BCONTEMAIL
 BCONTFNAME
 BCONTLNAME Init,     ˇˇ Click<     ˇˇ1 ë 4 A AÇ Ò“ —q !!q Q Ò Ò “q !Òq Q Ò Ò “q !Òq Q Ò Ò Ç q !!q Q Ò Ò r !Òq Q Ò Ò s !Òq Q Ò Ò B í q A C 1                       Y         u   ∫      )   §                        lblbase      ..\..\common60\basectrl.vcx      label      Lblbase2      SCHOOLS.Pgfbase1.Page2      ãBackStyle = 0
Caption = "Send Message to Contact Email Address (CS)"
Height = 17
Left = 263
Top = 209
Width = 255
Name = "Lblbase2"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase3      SCHOOLS.Pgfbase1.Page2      ëFontBold = .T.
BackStyle = 0
Caption = "Second Advisor"
Height = 17
Left = 101
Top = 269
Width = 91
ForeColor = 0,0,0
Name = "Lblbase3"
      textbox      textbox      	txtbfname      SCHOOLS.Pgfbase1.Page2      ∂Comment = ""
ControlSource = "mcust.bcontfname"
Format = ""
Height = 23
Left = 277
MaxLength = 20
TabIndex = 37
Top = 266
Width = 149
ForeColor = 0,0,0
Name = "txtbfname"
      textbox      textbox      	txtblname      SCHOOLS.Pgfbase1.Page2      ∂Comment = ""
ControlSource = "mcust.bcontlname"
Format = ""
Height = 23
Left = 515
MaxLength = 20
TabIndex = 39
Top = 266
Width = 149
ForeColor = 0,0,0
Name = "txtblname"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase4      SCHOOLS.Pgfbase1.Page2      zBackStyle = 0
Caption = "Address"
Height = 17
Left = 101
Top = 302
Width = 48
ForeColor = 0,0,0
Name = "Lblbase4"
      txtbase      ..\..\common60\basectrl.vcx      textbox      TxtNAddr      SCHOOLS.Pgfbase1.Page2      zControlSource = "mcust.bcontaddr"
Height = 23
Left = 172
Top = 298
Width = 216
ForeColor = 0,0,0
Name = "TxtNAddr"
      txtbase      ..\..\common60\basectrl.vcx      textbox      	TxtNAddr2      SCHOOLS.Pgfbase1.Page2      |ControlSource = "mcust.bcontaddr2"
Height = 23
Left = 400
Top = 298
Width = 240
ForeColor = 0,0,0
Name = "TxtNAddr2"
      label      label      Label1      SCHOOLS.Pgfbase1.Page2      §AutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "City"
Height = 17
Left = 101
Top = 326
Width = 20
TabIndex = 15
ForeColor = 0,0,0
Name = "Label1"
      txtbase      ..\..\common60\basectrl.vcx      textbox      TxtNCity      SCHOOLS.Pgfbase1.Page2      óControlSource = "mcust.bcontcity"
Format = ""
Height = 23
Left = 172
MaxLength = 21
Top = 322
Width = 135
ForeColor = 0,0,0
Name = "TxtNCity"
      label      label      Label2      SCHOOLS.Pgfbase1.Page2      •AutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "State"
Height = 17
Left = 316
Top = 326
Width = 28
TabIndex = 17
ForeColor = 0,0,0
Name = "Label2"
      txtbase      ..\..\common60\basectrl.vcx      textbox      	TxtNState      SCHOOLS.Pgfbase1.Page2      àControlSource = "mcust.bcontstate"
Format = ""
Height = 23
Left = 352
Top = 322
Width = 35
ForeColor = 0,0,0
Name = "TxtNState"
      label      label      Label3      SCHOOLS.Pgfbase1.Page2      £AutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Zip"
Height = 17
Left = 400
Top = 326
Width = 17
TabIndex = 19
ForeColor = 0,0,0
Name = "Label3"
      txtbase      ..\..\common60\basectrl.vcx      textbox      TxtNZip      SCHOOLS.Pgfbase1.Page2      wControlSource = "mcust.bcontzip"
Height = 23
Left = 436
Top = 322
Width = 84
ForeColor = 0,0,0
Name = "TxtNZip"
      label      label      Label4      SCHOOLS.Pgfbase1.Page2      ™AutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Home Phone"
Height = 17
Left = 101
Top = 349
Width = 73
TabIndex = 21
ForeColor = 0,0,0
Name = "Label4"
      txtbase      ..\..\common60\basectrl.vcx      textbox      	TxtNPhone      SCHOOLS.Pgfbase1.Page2      öControlSource = "mcust.bcontphnho"
Height = 23
InputMask = "(999) 999-9999"
Left = 190
Top = 346
Width = 106
ForeColor = 0,0,0
Name = "TxtNPhone"
      label      label      Label5      SCHOOLS.Pgfbase1.Page2      ™AutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Work Phone"
Height = 17
Left = 316
Top = 350
Width = 67
TabIndex = 23
ForeColor = 0,0,0
Name = "Label5"
      txtbase      ..\..\common60\basectrl.vcx      textbox      TxtNWork      SCHOOLS.Pgfbase1.Page2      ôControlSource = "mcust.bcontphnwr"
Height = 23
InputMask = "(999) 999-9999"
Left = 390
Top = 346
Width = 116
ForeColor = 0,0,0
Name = "TxtNWork"
      label      label      Label6      SCHOOLS.Pgfbase1.Page2      £AutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Fax"
Height = 17
Left = 520
Top = 350
Width = 19
TabIndex = 25
ForeColor = 0,0,0
Name = "Label6"
      txtbase      ..\..\common60\basectrl.vcx      textbox      TxtNFax      SCHOOLS.Pgfbase1.Page2      ñControlSource = "mcust.bcontfax"
Height = 23
InputMask = "(999) 999-9999"
Left = 547
Top = 346
Width = 117
ForeColor = 0,0,0
Name = "TxtNFax"
      txtbase      ..\..\common60\basectrl.vcx      textbox      	TxtNEmail      SCHOOLS.Pgfbase1.Page2      åControlSource = "mcust.bcontemail"
Height = 23
Left = 160
MaxLength = 45
Top = 370
Width = 310
ForeColor = 0,0,0
Name = "TxtNEmail"
      textbox      textbox      txtBooktype      SCHOOLS.Pgfbase1.Page2     Comment = ""
FontBold = .T.
FontSize = 16
ControlSource = "mcust.booktype"
Format = "!"
Height = 34
Left = 592
MaxLength = 4
TabIndex = 5
ToolTipText = "Change from Sales to insure WIP update."
Top = 40
Width = 39
ForeColor = 255,0,255
Name = "txtBooktype"
      label      label      lblBooktype      SCHOOLS.Pgfbase1.Page2      çAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Book Type"
Left = 527
Top = 53
Width = 56
TabIndex = 60
Name = "lblBooktype"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase6      SCHOOLS.Pgfbase1.Page2      wBackStyle = 0
Caption = "For HTML"
Height = 17
Left = 587
Top = 208
Width = 55
TabIndex = 78
Name = "Lblbase6"
      cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager1      SCHOOLS.Pgfbase1.Page2     ¡Top = 205
Left = 647
Height = 21
Width = 26
Picture = ..\mail.bmp
ToolTipText = "Blank Body"
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = TempMail
maincursor = TempMail
currentrecordonly = .F.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 
settings_emailaddress = 
settings_subject = 2|alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)+" "+alltrim(mcust.schstate)
settings_body = 
settings_attachment = 1|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = iif(!empty(ALLTRIM(TempMail.cname)),ALLTRIM(TempMail.cname),"Recipient")
emailaddress = alltrim(TempMail.emailaddress)
subject = alltrim(mcust.schcode)+" "+alltrim(mcust.schname)
body = 
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager1"
     ”PROCEDURE Init
dodefault()
*repl mailtemp.mailltr with filetostr('m:\mbc5\email.txt')

ENDPROC
PROCEDURE Click
*Ensures that there is a name in the 1st advisor name fields, one or the other or both must be filled.
* If left empty the mail manager crashes
if empty(mcust.contfname) and empty(mcust.contlname)&&use data fields to test, textbox is not available on this page
nodefault
Messagebox("Please enter a name for the advisor name fields.",64,"Advisor Name Field")

else
CREATE CURSOR TempMail (emailaddress C(45),cname C(60))

do case
case this.parent.krdoptgroup.option4.value=1 &&school
select mcust
m.emailaddress=mcust.schemail
m.cname= mcust.schname
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

case this.parent.krdoptgroup.option2.value=1 &&first contact
select mcust
m.emailaddress=mcust.contemail
m.cname=alltrim(mcust.contfname)+" "+alltrim(contlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

case this.parent.krdoptgroup.option3.value=1 &&second cont
select mcust
m.emailaddress=mcust.bcontemail
m.cname=alltrim(mcust.bcontfname)+" "+alltrim(bcontlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

otherwise && all contact
select mcust
m.emailaddress=mcust.schemail
m.cname= mcust.schname
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

select mcust
m.emailaddress=mcust.contemail
m.cname=alltrim(mcust.contfname)+" "+alltrim(contlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname


select mcust
m.emailaddress=mcust.bcontemail
m.cname=alltrim(mcust.bcontfname)+" "+alltrim(bcontlname)
select TempMail
append blank
replace emailaddress with m.emailaddress
replace cname with m.cname

endcase



dodefault()
select TempMail
use

endif
ENDPROC
     n˛Úˇ    U  U                        8N   %   e      ¸  =   Ç          ¸  U   	 ô¸CÍ°˝˛ U  j %¸CÙ  ˜ °	 CÙ  ˜ °	˝˘v ˛ ¨˛T ô¸CŸ0 Please enter a name for the advisor name fields.¯@Ÿ Advisor Name FieldÍx˝˛ ˘c˛/ hΩ˚ TempMail˜ ˚ C¸¯-˝˜ ˚ C¸¯<˝˛ H˘∫ ˘K˛ ¸Ù Ù Ù Ù	 ˜
 ¯˝˘,˛ F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸Ù  ˜ ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ ¸Ù Ù Ù Ù ˜
 ¯˝˘´˛ F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸CÙ  ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ ¸Ù Ù Ù Ù ˜
 ¯˝˘*˛ F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸CÙ  ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ 2˘K˛ F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸Ù  ˜ ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸CÙ  ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸CÙ  ˜ õŸ  C˜ õ˝˛ F˜ ˛ ˛ >˜ —¸ı˜ ˝˛ >˜ —¸ı˜ ˝˛ ˛	 ô¸CÍ°˝˛ F˜ ˛ Q˛ ˛ U  MCUST	 CONTFNAME	 CONTLNAME TEMPMAIL EMAILADDRESS CNAME THIS PARENT KRDOPTGROUP OPTION4 VALUE SCHEMAIL SCHNAME OPTION2	 CONTEMAIL OPTION3
 BCONTEMAIL
 BCONTFNAME
 BCONTLNAME Init,     ˇˇ Click<     ˇˇ1 ë 4 „A AÇ Ò“ —q !!q Q Ò Ò “q !Òq Q Ò Ò “q !Òq Q Ò Ò Ç q !!q Q Ò Ò r !Òq Q Ò Ò s !Òq Q Ò Ò B î q A B 1                       Y         u   »      )   U                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase4      SCHOOLS.Pgfbase1.Page2      dTop = 184
Left = 59
Height = 22
Width = 39
Caption = "Email"
TabIndex = 65
Name = "Cmdbase4"
     ÇPROCEDURE Click
DO case
CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
	cMessageTitle = 'Telephone log ENTRY required'
	cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
	nDialogType = 16
	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
	NODEFAULT

*!*	CASE thisform.telelog=.t.
*!*		IF substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT
*!*			else
*!*			thisform.ckchng
*!*	define window jbrowser from 15,5 to 23,75;
*!*		color scheme 10;
*!*		float grow zoom
*!*		
*!*	sele mcust
*!*	set order to contemail
*!*	_jexitkey=13
*!*	_jdblclick=-1

*!*	store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

*!*	=jkeyinit("A","","Search For: ")

*!*	brow window jbrowser fiel contemail:40,schname:20,mquotes.prodno:11:;
*!*	H="Production #",schcity,schcode noedit nodelete


*!*	=jkeycanc()
*!*	set order to schcode
*!*	release wind jbrowser
*!*	thisform.custid=mcust.schcode
*!*	thisform.invid=0
*!*	if mquotes.schcode=mcust.schcode
*!*	thisform.invid=mquotes.invno
*!*	endif
*!*	thisform.refresh
*!*	thisform.telelog=.f.
*!*	thisform.mktlog=.f.
*!*		thisform.pgfbase1.page3.container1.chkmkt.value=0
*!*		thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.

*!*		ENDIF
OTHERWISE

thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to contemail
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")

brow window jbrowser fiel contemail:40,schname:20,mquotes.prodno:11:;
H="Production #",schcity,schcode noedit nodelete


=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase
	

ENDPROC
     ·˛Úˇ    »  »                        ﬁå   %   ,        "   ;          ¸  U  £ H˘ ˘ú˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛ 2˘ú˛
 ôÙ  ˜
 ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚	 contemail˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛@ 	˜ …¯(˜ …¯Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘<˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜ ¸-˝˛ TÙ  Ù Ù Ù Ù  ˜! ¸¯ ˝˛ TÙ  Ù Ù Ù Ù" ˜# ¸a˝˛ ˛ U$  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER CKCHNG JBROWSER	 CONTEMAIL	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH MKTLOG PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLED Click,     ˇˇ1 — °ë°— aA pÅ ¢ £r !— · ¬£ Å 1q1A ° · · ¡°A 3                       w      )   »                        line      line      Line1      SCHOOLS.Pgfbase1.Page2      iBorderStyle = 2
Height = 0
Left = 71
Top = 246
Width = 684
BorderColor = 0,128,255
Name = "Line1"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase3      SCHOOLS.Pgfbase1.Page2      [Top = 267
Left = 203
Height = 21
Width = 67
Caption = "First Name"
Name = "Cmdbase3"
      2PROCEDURE Click

thisform.bfstrsrch()
ENDPROC
      Ã˛Úˇ    ≥   ≥                         ˝+   %   U       j      d           ¸  U    ô¸CÙ  ˆ ˝˛ U  THISFORM	 BFSTRSRCH Click,     ˇˇ1 “ 1                       '       )   ≥                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase5      SCHOOLS.Pgfbase1.Page2      ZTop = 266
Left = 436
Height = 22
Width = 72
Caption = "Last Name"
Name = "Cmdbase5"
      /PROCEDURE Click
thisform.blstsrch

ENDPROC
      »˛Úˇ    Ø   Ø                         H–   %   Q       f      `           ¸  U   
 ôÙ  ˜ ˛ U  THISFORM BLSTSRCH Click,     ˇˇ1 ° 2                       $       )   Ø                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase6      SCHOOLS.Pgfbase1.Page2      eTop = 371
Left = 104
Height = 22
Width = 39
Caption = "Email"
TabIndex = 65
Name = "Cmdbase6"
     PROCEDURE Click
DO case
CASE thisform.telelog=.f.and substr(oApp.cNaUser,1,2)='CS' and mcust.schname<>'CS'
	cMessageTitle = 'Telephone log ENTRY required'
	cMessageText = 'You have to make an ENTRY in the Telephone Log before Exiting'
	nDialogType = 16
	nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)
	NODEFAULT

*!*	CASE thisform.telelog=.t.
*!*		IF substr(oApp.cNaUser,1,2)='CS' and empty(mcust.refby)or isnull(mcust.refby)
*!*			MESSAGEBOX("Please fill in the Refer By/Status field.",48,"Empty Field")
*!*			NODEFAULT
*!*			else
*!*			thisform.ckchng
*!*	define window jbrowser from 15,5 to 23,75;
*!*		color scheme 10;
*!*		float grow zoom
*!*		
*!*	sele mcust
*!*	set order to bcontemail
*!*	_jexitkey=13
*!*	_jdblclick=-1

*!*	store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

*!*	=jkeyinit("A","","Search For: ")

*!*	brow window jbrowser fiel bcontemail:40,schname:20,mquotes.prodno:11:;
*!*	H="Production #",schcity,schcode noedit nodelete


*!*	=jkeycanc()
*!*	set order to schcode
*!*	release wind jbrowser
*!*	thisform.custid=mcust.schcode
*!*	thisform.invid=0
*!*	if mquotes.schcode=mcust.schcode
*!*	thisform.invid=mquotes.invno
*!*	endif
*!*	thisform.refresh
*!*	thisform.telelog=.f.

*!*		

*!*		ENDIF
OTHERWISE



thisform.ckchng
define window jbrowser from 15,5 to 23,75;
	color scheme 10;
	float grow zoom
	
sele mcust
set order to bcontemail
_jexitkey=13
_jdblclick=-1

store -1 to m.g_lastrow,m.g_lastcol,m.g_lastcllk

=jkeyinit("A","","Search For: ")

brow window jbrowser fiel bcontemail:40,schname:20,mquotes.prodno:11:;
H="Production #",schcity,schcode noedit nodelete


=jkeycanc()
set order to schcode
release wind jbrowser
thisform.custid=mcust.schcode
thisform.invid=0
if mquotes.schcode=mcust.schcode
thisform.invid=mquotes.invno
endif
thisform.refresh
thisform.telelog=.f.
thisform.mktlog=.f.
thisform.pgfbase1.page3.container1.chkmkt.value=0
thisform.pgfbase1.page3.container1.cmdnewmkt.enabled=.t.
endcase
	

ENDPROC
     „˛Úˇ                                ´   %   .      Å  "   =          ¸  U  § H˘ ˘ù˛: ¸Ù  ˜ - CÙ ˜ ¯¯\˚ CS	 Ù ˜ ˚ CS	˝˘· ˛) T˜ ¸˚ Telephone log ENTRY required˝˛J T˜ ¸˚= You have to make an ENTRY in the Telephone Log before Exiting˝˛ T˜ ¸¯˝˛ T˜	 ¸C˜ ˜ ˜ Íx˝˛ ¨˛ 2˘ù˛
 ôÙ  ˜
 ˛* s,˜ ¸¯˝¸¯˝(¸¯˝¸¯K˝N¸¯
˝¡ø’˛ F˜ ˛ G((˚
 bcontemail˛ T˜ ¸¯˝˛ T˜ ¸˘ˇˇ˝˛ J¸˘ˇˇ˝(ı˜ ı˜ ı˜ ˛  Ü¸CŸ AŸ  Ÿ Search For: ˆ ˝˛@ 	˜ …¯(˜ …¯Ù ˜ …¯ø¸Ÿ Production #˝˜ ˜ ≈ƒ,˜ ˛
 Ü¸Cˆ ˝˛ G((˚ schcode˛ <,˜ ˛ TÙ  ˜ ¸Ù ˜ ˝˛ TÙ  ˜ ¸¯ ˝˛ %¸Ù ˜ Ù ˜ ˝˘=˛ TÙ  ˜ ¸Ù ˜ ˝˛ ˛
 ôÙ  ˜ ˛ TÙ  ˜ ¸-˝˛ TÙ  ˜ ¸-˝˛ TÙ  Ù Ù Ù Ù  ˜! ¸¯ ˝˛ TÙ  Ù Ù Ù Ù" ˜# ¸a˝˛ ˛ U$  THISFORM TELELOG OAPP CNAUSER MCUST SCHNAME CMESSAGETITLE CMESSAGETEXT NDIALOGTYPE NANSWER CKCHNG JBROWSER
 BCONTEMAIL	 _JEXITKEY
 _JDBLCLICK	 G_LASTROW	 G_LASTCOL
 G_LASTCLLK JKEYINIT MQUOTES PRODNO SCHCITY SCHCODE JKEYCANC CUSTID INVID INVNO REFRESH MKTLOG PGFBASE1 PAGE3
 CONTAINER1 CHKMKT VALUE	 CMDNEWMKT ENABLED Click,     ˇˇ1 — °ë°— aA `Å § £r 1— · ¬£ Å 1q1A ° · · ¡°A 3                       ¯      )                            cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager3      SCHOOLS.Pgfbase1.Page2     WTop = 390
Left = 562
Height = 21
Width = 26
Picture = ..\mail.bmp
ToolTipText = "Uses c:\mbc5\email.txt for body"
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = cust
maincursor = mcust
currentrecordonly = .T.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 2|ALLTRIM(mcust.bcontfname)+" "+ ALLTRIM(mcust.bcontlname) 
settings_emailaddress = 2|ALLTRIM(mCust.bcontemail)
settings_subject = 2|alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)+" "+alltrim(mcust.schstate)
settings_body = filetostr("m:\mbc5\emailtext\email.txt")
settings_attachment = 1|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = ALLTRIM(mcust.bcontfname)+" "+ ALLTRIM(mcust.bcontlname) 
emailaddress = ALLTRIM(mCust.bcontemail)
subject = alltrim(mcust.schcode)+" "+alltrim(mcust.schname)
body = filetostr("c:\mbc5\email.txt")
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager3"
     PROCEDURE Init

dodefault()

*repl mailtemp.mailltr with filetostr('m:\mbc5\email.txt')

ENDPROC
PROCEDURE Click
*Ensures that there is a name in the second advisor name fields, one or the other or both must be filled.
* If left empty the mail manager crashes
if empty(thisform.pgfbase1.Page2.txtbfname.text) and empty(thisform.pgfbase1.Page2.txtblname.text)
nodefault
Messagebox("Please enter a name for the second advisor name fields.",64,"Second Advisor Name Field")

else
dodefault()
endif
ENDPROC
     »˛Úˇ    Ø  Ø                        %†   %   %      V  
   B          ¸  U   	 ô¸CÍ°˝˛ U  Æ 0 %¸CÙ  Ù Ù Ù ˜ ° CÙ  Ù Ù Ù ˜ °	˝˘ñ ˛ ¨˛b ô¸CŸ7 Please enter a name for the second advisor name fields.¯@Ÿ Second Advisor Name FieldÍx˝˛ ˘ß ˛	 ô¸CÍ°˝˛ ˛ U  THISFORM PGFBASE1 PAGE2	 TXTBFNAME TEXT	 TXTBLNAME Init,     ˇˇ Click<     ˇˇ1 í 5 A !Ç ë A 1                       ]         y   ˝      )   Ø                        lblbase      ..\..\common60\basectrl.vcx      label      Lblbase5      SCHOOLS.Pgfbase1.Page2      £AutoSize = .T.
BackStyle = 0
Caption = "Send Message to Second Contacts Email Address (CS)"
Height = 17
Left = 244
Top = 394
Width = 307
Name = "Lblbase5"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase7      SCHOOLS.Pgfbase1.Page2      wBackStyle = 0
Caption = "For HTML"
Height = 17
Left = 627
Top = 393
Width = 55
TabIndex = 78
Name = "Lblbase7"
      cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager4      SCHOOLS.Pgfbase1.Page2     ˝Top = 390
Left = 687
Height = 21
Width = 26
Picture = ..\mail.bmp
ToolTipText = "Blank Body"
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = mcust
maincursor = mcust
currentrecordonly = .T.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 2|ALLTRIM(mcust.bcontfname)+" "+ ALLTRIM(mcust.bcontlname) 
settings_emailaddress = 2|ALLTRIM(mCust.bcontemail)
settings_subject = 2|alltrim(mcust.schcode)+" "+alltrim(mcust.schname)+" "+alltrim(mcust.schstate)+" "+alltrim(mcust.schstate)
settings_body = 
settings_attachment = 1|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = ALLTRIM(mcust.bcontfname)+" "+ ALLTRIM(mcust.bcontlname) 
emailaddress = ALLTRIM(mCust.bcontemail)
subject = alltrim(mcust.schcode)+" "+alltrim(mcust.schname)
body = 
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager4"
     PROCEDURE Init
dodefault()
*repl mailtemp.mailltr with filetostr('m:\mbc5\email.txt')

ENDPROC
PROCEDURE Click
*Ensures that there is a name in the second advisor name fields, one or the other or both must be filled.
* If left empty the mail manager crashes
if empty(thisform.pgfbase1.Page2.txtbfname.text) and empty(thisform.pgfbase1.Page2.txtblname.text)
nodefault
Messagebox("Please enter a name for the second advisor name fields.",64,"Second Advisor Name Field")

else
dodefault()
endif
ENDPROC
     »˛Úˇ    Ø  Ø                        %†   %   %      V  
   B          ¸  U   	 ô¸CÍ°˝˛ U  Æ 0 %¸CÙ  Ù Ù Ù ˜ ° CÙ  Ù Ù Ù ˜ °	˝˘ñ ˛ ¨˛b ô¸CŸ7 Please enter a name for the second advisor name fields.¯@Ÿ Second Advisor Name FieldÍx˝˛ ˘ß ˛	 ô¸CÍ°˝˛ ˛ U  THISFORM PGFBASE1 PAGE2	 TXTBFNAME TEXT	 TXTBLNAME Init,     ˇˇ Click<     ˇˇ1 ë 4 A !Ç ë A 1                       Y         u   ˘      )   Ø                        chkbase      ..\..\common60\basectrl.vcx      checkbox      Chkbase1      SCHOOLS.Pgfbase1.Page2      ¶Top = 118
Left = 674
Height = 17
Width = 125
Alignment = 0
BackStyle = 0
Caption = "No Marketing Email"
ControlSource = "mcust.nomktemail"
Name = "Chkbase1"
      chkbase      ..\..\common60\basectrl.vcx      checkbox      Chkbase2      SCHOOLS.Pgfbase1.Page2      †Top = 94
Left = 674
Height = 17
Width = 94
Alignment = 0
BackStyle = 0
Caption = "No Direct Mail"
ControlSource = "mcust.nodirectma"
Name = "Chkbase2"
      optiongroup      optiongroup      krdoptgroup      SCHOOLS.Pgfbase1.Page2     oButtonCount = 4
BackStyle = 0
BorderStyle = 0
Value = 1
Height = 48
Left = 710
Top = 190
Width = 156
Name = "krdoptgroup"
Option1.FontSize = 6
Option1.BackStyle = 0
Option1.Caption = "Email All"
Option1.Value = 1
Option1.Height = 17
Option1.Left = 5
Option1.Top = 5
Option1.Width = 79
Option1.Name = "Option1"
Option2.FontSize = 6
Option2.BackStyle = 0
Option2.Caption = "Email Advisor1"
Option2.Height = 17
Option2.Left = 5
Option2.Top = 24
Option2.Width = 85
Option2.Name = "Option2"
Option3.FontSize = 6
Option3.BackStyle = 0
Option3.Caption = "Email Advisor2"
Option3.Height = 17
Option3.Left = 77
Option3.Top = 5
Option3.Width = 85
Option3.Name = "Option3"
Option4.FontSize = 6
Option4.BackStyle = 0
Option4.Caption = "Email School"
Option4.Height = 17
Option4.Left = 77
Option4.Top = 24
Option4.Width = 61
Option4.Name = "Option4"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase8      SCHOOLS.Pgfbase1.Page2      ÅBackStyle = 0
Caption = "Position"
Height = 17
Left = 682
Top = 268
Width = 47
BackColor = 255,255,255
Name = "Lblbase8"
      cboalsqfill      ..\..\common60\basectrl.vcx      combobox      Cboalsqfill2      SCHOOLS.Pgfbase1.Page2      ‚RowSourceType = 6
RowSource = "contpstn.position"
ControlSource = "mcust.bposition"
Height = 24
Left = 741
TabIndex = 3
Top = 265
Width = 156
calias = contpstn
cfield = position
corder = pstn
Name = "Cboalsqfill2"
     hPROCEDURE Valid
sele contpstn
go top
locate for upper(alltrim(contpstn.position))=upper(alltrim(this.displayvalue))
if !found()
	appe blank
	repl contpstn.position with this.displayvalue
	sele mcust
	repl mcust.position with this.displayvalue
endif
this.requery

ENDPROC
PROCEDURE LostFocus
thisform.pgfbase1.page2.txtgender.setfocus()
ENDPROC
     ›˛Úˇ    ƒ  ƒ                        ¬ˇ   %   -      k     O          ¸  U  x  F˜  ˛ #)˛ -¸CCÙ  ˜ õfCCÙ ˜ õf˝˛ %¸C4
˝˘g ˛ ˛ >Ù  ˜ —¸Ù ˜ ˝˛ F˜ ˛ >Ù ˜ —¸Ù ˜ ˝˛ ˛
 ôÙ ˜ ˛ U  CONTPSTN POSITION THIS DISPLAYVALUE MCUST REQUERY  ô¸CÙ  Ù Ù Ù ˆ ˝˛ U  THISFORM PGFBASE1 PAGE2	 TXTGENDER SETFOCUS Valid,     ˇˇ	 LostFocus‡     ˇˇ1 q Q ¡— Q 1q 1A ° 3 a1                               1  ]      )   ƒ                        textbox      textbox      
txtSchname      SCHOOLS.Pgfbase1.Page3     Comment = ""
FontBold = .T.
ControlSource = "mcust.schname"
Enabled = .F.
Format = "!"
Height = 23
Left = 449
MaxLength = 34
ReadOnly = .T.
TabIndex = 8
Top = 14
Width = 246
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
Name = "txtSchname"
      lstbase      ..\..\common60\basectrl.vcx      listbox      Lstbase1      SCHOOLS.Pgfbase1.Page3      ÂColumnCount = 0
RowSourceType = 6
RowSource = "actvlook.comment"
ControlSource = "actvlook.comment"
Height = 101
Left = 458
TabIndex = 2
ToolTipText = "Right Click to ADD to Log"
Top = 65
Width = 360
Name = "Lstbase1"
     £PROCEDURE RightClick
thisform.telelog=.t.
sele mcust
m.company="MER"
m.schcode=mcust.schcode
m.datecont=datetime()
m.reason=actvlook.comment
m.initial=oApp.cNaUser

repl mcust.lastcont with date()
repl mcust.nextcont with ctod("  /  /  ")

insert into datecont from memvar
sele datecont
=tableupdate(.t.)
sele mcust
thisform.refresh
thisform.pgfbase1.page3.grddatecont.column3.setfocus()


ENDPROC
     d˛Úˇ    K  K                        Å”   %   Ã           ‡          ¸  U  Â  TÙ  ˜ ¸a˝˛ F˜ ˛ Tı˜ ¸Ÿ MER˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜ ¸CÍÜ˝˛ Tı˜ ¸Ù ˜ ˝˛ Tı˜	 ¸Ù
 ˜ ˝˛ >Ù ˜ —¸C$˝˛ >Ù ˜ —¸CŸ   /  /  #˝˛ rº˚ datecont¬˛ F˜ ˛
 Ü¸CaÍì˝˛ F˜ ˛
 ôÙ  ˜ ˛ ô¸CÙ  Ù Ù Ù Ù ˆ ˝˛ U  THISFORM TELELOG MCUST COMPANY SCHCODE DATECONT REASON ACTVLOOK COMMENT INITIAL OAPP CNAUSER LASTCONT NEXTCONT REFRESH PGFBASE1 PAGE3 GRDDATECONT COLUMN3 SETFOCUS
 RightClick,     ˇˇ1 · q !!Ò !!Ú °"q ° q ° ë3                       ò      )   K                        edtbase      ..\..\common60\basectrl.vcx      editbox      Edtbase1      SCHOOLS.Pgfbase1.Page3      tHeight = 101
Left = 10
TabIndex = 1
Top = 65
Width = 408
ControlSource = "datecont.reason"
Name = "Edtbase1"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase1      SCHOOLS.Pgfbase1.Page3      ŸFontBold = .T.
BackStyle = 0
Caption = "Click on Reason (BELOW) then Click in this Window to make/add changes."
Height = 17
Left = 21
Top = 40
Width = 420
TabIndex = 10
ForeColor = 0,0,255
Name = "Lblbase1"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase2      SCHOOLS.Pgfbase1.Page3      àFontSize = 12
BackStyle = 0
Caption = "School Name"
Height = 21
Left = 317
Top = 14
Width = 96
TabIndex = 11
Name = "Lblbase2"
      	container      	container      
Container1      SCHOOLS.Pgfbase1.Page3      ^Top = 408
Left = 4
Width = 946
Height = 162
BackColor = 255,255,128
Name = "Container1"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase3      !SCHOOLS.Pgfbase1.Page3.Container1      «FontBold = .T.
FontSize = 12
FontUnderline = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Marketing Information"
Height = 22
Left = 384
Top = 9
Width = 166
TabIndex = 12
Name = "Lblbase3"
      grdbase      ..\..\common60\basectrl.vcx      grid      grdmkt      !SCHOOLS.Pgfbase1.Page3.Container1     aColumnCount = 5
DeleteMark = .F.
Height = 120
Left = 4
Panel = 1
RecordSource = "mktinfo"
RowHeight = 26
TabIndex = 5
Top = 39
Width = 918
Name = "grdmkt"
Column1.ControlSource = "mktinfo.refered"
Column1.CurrentControl = "cmbreference"
Column1.Width = 167
Column1.Sparse = .T.
Column1.Name = "Column1"
Column2.ControlSource = "mktinfo.promo"
Column2.CurrentControl = "CMBPROMOTION"
Column2.Width = 157
Column2.Sparse = .T.
Column2.Name = "Column2"
Column3.ControlSource = "mktinfo.ddate"
Column3.Width = 52
Column3.Visible = .T.
Column3.Name = "Column3"
Column4.ColumnOrder = 5
Column4.ControlSource = "mktinfo.note"
Column4.CurrentControl = "Edtbase1"
Column4.Width = 424
Column4.Sparse = .F.
Column4.Name = "Column4"
Column5.ColumnOrder = 4
Column5.ControlSource = "mktinfo.initial"
Column5.Width = 47
Column5.Name = "Column5"
      header      header      Header1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column1      BCaption = "Reference"
BackColor = 223,223,223
Name = "Header1"
      textbox      textbox      Text1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column1      YBorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      cmbreference      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column1      —RowSourceType = 1
RowSource = "RETURNING CUSTOMER,DIRECT MAIL,EMAIL,INTERNET,WORD OF MOUTH,SOCIAL MEDIA,SALES REP FOLLOW UP,PRINT AD"
Left = 85
Top = 35
ItemBackColor = 234,234,234
Name = "cmbreference"
      header      header      Header1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column2      GCaption = "Promotion Code"
BackColor = 223,223,223
Name = "Header1"
      textbox      textbox      Text1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column2      YBorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      CMBPROMOTION      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column2      RowSourceType = 6
RowSource = "lkppromotions.promo"
Left = 49
Top = 35
ItemBackColor = 234,234,234
Name = "CMBPROMOTION"
      header      header      Header1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column3      =Caption = "Date"
BackColor = 223,223,223
Name = "Header1"
      textbox      textbox      Text1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column3      âBorderStyle = 0
ControlSource = "mktinfo.ddate"
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column4      >Caption = "Notes"
BackColor = 223,223,223
Name = "Header1"
      textbox      textbox      Text1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column4      YBorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      edtbase      ..\..\common60\basectrl.vcx      editbox      Edtbase1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column4      (Left = 20
Top = 20
Name = "Edtbase1"
      header      header      Header1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column5      @Caption = "Intials"
BackColor = 223,223,223
Name = "Header1"
      textbox      textbox      Text1      0SCHOOLS.Pgfbase1.Page3.Container1.grdmkt.Column5      |BorderStyle = 0
ControlSource = "mktinfo.initial"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      chkbase      ..\..\common60\basectrl.vcx      checkbox      chkmkt      !SCHOOLS.Pgfbase1.Page3.Container1      ¬Top = 14
Left = 682
Height = 18
Width = 198
Alignment = 0
Caption = "Marketing Information Completed"
Style = 0
TabIndex = 6
BackColor = 255,255,128
RightToLeft = .F.
Name = "chkmkt"
     9PROCEDURE Click

a=mktinfo.schcode
b=mcust.schcode
IF this.value=1 and a=b &&there is a mktinfo record
	DO case
		CASE empty(mktinfo.refered)
			MESSAGEBOX("Reference field can not be empty.",64,"Reference Field")
			this.value=0
		CASE empty(mktinfo.promo)
			MESSAGEBOX("Promotion code field can not be empty.",64,"Promotion Code Field")
			this.value=0
		otherwise
		select mktinfo
		tableupdate(.t.)
			this.parent.cmdnewmkt.enabled=.f.
			thisform.mktlog=.t.
			this.value=1	
	ENDCASE
else
if this.value=1 and a<>b
this.parent.cmdnewmkt.enabled=.f.
thisform.mktlog=.t.
this.value=1
select mktinfo
		tableupdate(.t.)
else && value is being unchecked and no mktinfo records so enable new rec button
this.parent.cmdnewmkt.enabled=.t.
thisform.mktlog=.f.
this.value=0
endif	
ENDIF

ENDPROC
     g˛Úˇ    N  N                        '˛   %   ∂            ≈          ¸  U   T˜  ¸Ù ˜ ˝˛ T˜ ¸Ù ˜ ˝˛ %¸Ù ˜ ¯ ˜  ˜ 	˝˘m˛ H˘L ˘i˛ ¸CÙ ˜ °˝˘∞ ˛B ô¸CŸ! Reference field can not be empty.¯@Ÿ Reference FieldÍx˝˛ TÙ ˜ ¸¯ ˝˛ ¸CÙ ˜ °˝˘˛L ô¸CŸ& Promotion code field can not be empty.¯@Ÿ Promotion Code FieldÍx˝˛ TÙ ˜ ¸¯ ˝˛ 2˘i˛ F˜ ˛
 ô¸CaÍì˝˛ TÙ Ù	 Ù
 ˜ ¸-˝˛ TÙ ˜ ¸a˝˛ TÙ ˜ ¸¯˝˛ ˛ ˘˛ %¸Ù ˜ ¯ ˜  ˜ 	˝˘◊˛ TÙ Ù	 Ù
 ˜ ¸-˝˛ TÙ ˜ ¸a˝˛ TÙ ˜ ¸¯˝˛ F˜ ˛
 ô¸CaÍì˝˛ ˘˛ TÙ Ù	 Ù
 ˜ ¸a˝˛ TÙ ˜ ¸-˝˛ TÙ ˜ ¸¯ ˝˛ ˛ ˛ U  A MKTINFO SCHCODE B MCUST THIS VALUE REFERED PROMO PARENT	 CMDNEWMKT ENABLED THISFORM MKTLOG Click,     ˇˇ1 Ò— !!!¡Å q ° A· A Å ÒA· q ° Å A· A A 2                       .      )   N                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      	cmdnewmkt      !SCHOOLS.Pgfbase1.Page3.Container1      iTop = 8
Left = 4
Caption = "New Entry"
TabIndex = 4
DisabledForeColor = 255,0,0
Name = "cmdnewmkt"
     	PROCEDURE Click

sele mcust
m.schcode=mcust.schcode
m.ddate=date()
m.initial=oapp.cintial
insert into mktinfo from memvar
sele mktinfo
=tableupdate(.t.)
sele mcust
thisform.refresh
thisform.pgfbase1.page3.container1.grdmkt.column1.setfocus()

ENDPROC
     «˛Úˇ    Æ  Æ                        ≤≥   %   >      e     M          ¸  U  ã  F˜  ˛ Tı˜ ¸Ù  ˜ ˝˛ Tı˜ ¸C$˝˛ Tı˜ ¸Ù ˜ ˝˛ rº˚ mktinfo¬˛ F˜ ˛
 Ü¸CaÍì˝˛ F˜  ˛
 ôÙ ˜ ˛ ô¸CÙ Ù	 Ù
 Ù Ù Ù ˆ ˝˛ U  MCUST SCHCODE DDATE INITIAL OAPP CINTIAL MKTINFO THISFORM REFRESH PGFBASE1 PAGE3
 CONTAINER1 GRDMKT COLUMN1 SETFOCUS Click,     ˇˇ1 r !· !q ° q ° ¡2                       ˛       )   Æ                        grid      grid      grdDatecont      SCHOOLS.Pgfbase1.Page3     |ColumnCount = 12
DeleteMark = .F.
Height = 228
Left = 4
Panel = 1
RecordSource = "datecont"
RecordSourceType = 1
RowHeight = 25
TabIndex = 3
Top = 171
Width = 946
Name = "grdDatecont"
Column1.ColumnOrder = 12
Column1.ControlSource = "datecont.schcode"
Column1.Width = 58
Column1.ReadOnly = .T.
Column1.Visible = .T.
Column1.Name = "Column1"
Column2.ColumnOrder = 4
Column2.ControlSource = "datecont.datecont"
Column2.Width = 125
Column2.ReadOnly = .T.
Column2.Visible = .T.
Column2.Name = "Column2"
Column3.ColumnOrder = 5
Column3.ControlSource = "datecont.reason"
Column3.Width = 220
Column3.Sparse = .F.
Column3.Visible = .T.
Column3.Name = "Column3"
Column4.ColumnOrder = 6
Column4.ControlSource = "datecont.initial"
Column4.Width = 36
Column4.Visible = .T.
Column4.Format = "!"
Column4.Name = "Column5"
Column5.ColumnOrder = 10
Column5.ControlSource = "datecont.contact"
Column5.Width = 52
Column5.Visible = .T.
Column5.Name = "Column6"
Column6.ColumnOrder = 11
Column6.ControlSource = "datecont.typecont"
Column6.CurrentControl = "Cbobase1"
Column6.Width = 91
Column6.Visible = .T.
Column6.Name = "Column7"
Column7.ColumnOrder = 8
Column7.ControlSource = "datecont.nxtdays"
Column7.Width = 89
Column7.Visible = .T.
Column7.Name = "Column4"
Column8.ColumnOrder = 9
Column8.ControlSource = "datecont.nxtdate"
Column8.Width = 62
Column8.Visible = .T.
Column8.Name = "Column8"
Column9.ColumnOrder = 2
Column9.ControlSource = "datecont.callcont"
Column9.Width = 26
Column9.Sparse = .F.
Column9.Visible = .T.
Column9.Format = ""
Column9.Name = "Column9"
Column10.ColumnOrder = 7
Column10.ControlSource = "datecont.calltime"
Column10.Width = 60
Column10.Visible = .T.
Column10.Name = "Column10"
Column11.Alignment = 2
Column11.ColumnOrder = 3
Column11.ControlSource = "datecont.priority"
Column11.CurrentControl = "Cbobase1"
Column11.Width = 35
Column11.Sparse = .T.
Column11.Visible = .T.
Column11.Name = "Column11"
Column12.ColumnOrder = 1
Column12.ControlSource = "datecont.techcall"
Column12.CurrentControl = "Check1"
Column12.Width = 50
Column12.Sparse = .F.
Column12.Name = "Column12"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column1      $Caption = "Code"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column1      ïBorderStyle = 0
Margin = 0
ReadOnly = .T.
ToolTipText = "School Code"
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column2      )Caption = "Date/Time"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column2      ÜFontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column3      &Caption = "Reason"
Name = "Header1"
      edtbasefoxy      ..\..\common60\basectrl.vcx      editbox      Edtbasefoxy1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column3      iLeft = 47
ToolTipText = "Right Click to Expand/Shrink"
Top = 29
Visible = .T.
Name = "Edtbasefoxy1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column5      'Caption = "Initial"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column5      hBorderStyle = 0
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column6      'Caption = "Contact"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column6      hBorderStyle = 0
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column7      ,Caption = "Type Contact"
Name = "Header1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column7      yFontSize = 8
RowSourceType = 6
RowSource = "typelkup.typecont"
Left = 16
Top = 29
Visible = .T.
Name = "Cbobase1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column4      .Caption = "Contact (Days)"
Name = "Header1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column4      «ColumnCount = 1
RowSourceType = 6
RowSource = "dayslkup.dteincr"
ControlSource = "datecont.nxtdays"
IncrementalSearch = .T.
Left = 17
Top = 29
Visible = .T.
BoundTo = .T.
Name = "Cbobase1"
      ´PROCEDURE Valid
if nxtdays>0
repl datecont.nxtdate with datecont+nxtdays*86400
*else
*repl datecont.nxtdate with ctod('  /  /  ')
endif
thisform.refresh

ENDPROC
     ˛Úˇ                                sN   %   ú       ∑      ´           ¸  U  =  %¸˜  ¯ ˝˘, ˛ >Ù ˜ —¸˜ ˜  ÈÄQ ˝˛ ˛
 ôÙ ˜ ˛ U  NXTDAYS DATECONT NXTDATE THISFORM REFRESH Valid,     ˇˇ1 ±C ° 2                       †       )                            header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column8      )Caption = "Next Date"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column8      ≈DateFormat = 0
BorderStyle = 0
ControlSource = "datecont.nxtdate"
Margin = 0
ToolTipText = "Right Click To Set Date"
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      0PROCEDURE RightClick
DO mousemen.mpr
ENDPROC
      —˛Úˇ    ∏   ∏                         ¸É   %   U       o      i           ¸  U    ˚ mousemen.mpr˛ U  MOUSEMEN MPR
 RightClick,     ˇˇ1 11                       %       )   ∏                         header      header      Header1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column9      $Caption = "Call"
Name = "Header1"
      chkbase      ..\..\common60\basectrl.vcx      checkbox      Chkbase1      *SCHOOLS.Pgfbase1.Page3.grdDatecont.Column9      ^Top = 29
Left = 6
Alignment = 0
Caption = ""
Style = 0
Visible = .T.
Name = "Chkbase1"
      header      header      Header1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column10      )Caption = "Call Time"
Name = "Header1"
      textbox      textbox      Text1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column10      çBorderStyle = 0
ControlSource = "datecont.calltime"
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column11      #Caption = "Pri"
Name = "Header1"
      textbox      textbox      Text1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column11      ∞Alignment = 2
BorderStyle = 0
ControlSource = "datecont.priority"
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
NullDisplay = '""'
Name = "Text1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column11      ßAlignment = 2
RowSourceType = 1
RowSource = ",1,2,3"
ControlSource = "datecont.priority"
Left = 8
Top = 30
NullDisplay = '""'
BoundTo = .T.
Name = "Cbobase1"
      header      header      Header1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column12      (Caption = "TechCall"
Name = "Header1"
      textbox      textbox      Text1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column12      YBorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      checkbox      checkbox      Check1      +SCHOOLS.Pgfbase1.Page3.grdDatecont.Column12      \Top = 26
Left = 26
Height = 17
Width = 60
Alignment = 0
Caption = ""
Name = "Check1"
      textbox      textbox      
txtSchname      SCHOOLS.Pgfbase1.Page4     Comment = ""
FontBold = .T.
ControlSource = "mcust.schname"
Enabled = .F.
Format = "!"
Height = 23
Left = 246
MaxLength = 34
ReadOnly = .T.
TabIndex = 2
Top = 27
Width = 246
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
Name = "txtSchname"
      textbox      textbox      txtContfname      SCHOOLS.Pgfbase1.Page4      «Comment = ""
ControlSource = "mcust.contfname"
Height = 23
Left = 266
MaxLength = 20
ReadOnly = .T.
TabIndex = 8
Top = 58
Width = 148
DisabledBackColor = 255,255,255
Name = "txtContfname"
      textbox      textbox      txtContlname      SCHOOLS.Pgfbase1.Page4      »Comment = ""
ControlSource = "mcust.contlname"
Height = 23
Left = 495
MaxLength = 20
ReadOnly = .T.
TabIndex = 10
Top = 58
Width = 148
DisabledBackColor = 255,255,255
Name = "txtContlname"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase3      SCHOOLS.Pgfbase1.Page4      ZCaption = "First Name"
Height = 17
Left = 193
Top = 58
Width = 63
Name = "Lblbase3"
      textbox      textbox      
txtSchcode      SCHOOLS.Pgfbase1.Page4     Comment = ""
FontBold = .F.
ControlSource = "mcust.schcode"
Enabled = .F.
Height = 23
InputMask = "999999"
Left = 589
MaxLength = 6
TabIndex = 27
Top = 27
Width = 56
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
Name = "txtSchcode"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase5      SCHOOLS.Pgfbase1.Page4      [Caption = "School Code"
Height = 17
Left = 510
Top = 27
Width = 73
Name = "Lblbase5"
      	container      	container      contcontact      SCHOOLS.Pgfbase1.Page4      VTop = 98
Left = 224
Width = 440
Height = 128
BackStyle = 0
Name = "contcontact"
      textbox      textbox      txtContaddr      "SCHOOLS.Pgfbase1.Page4.contcontact      √Comment = ""
ControlSource = "cust.contaddr"
Height = 23
Left = 69
MaxLength = 30
ReadOnly = .T.
TabIndex = 12
Top = 6
Width = 364
DisabledBackColor = 255,255,255
Name = "txtContaddr"
      label      label      lblContaddr      "SCHOOLS.Pgfbase1.Page4.contcontact      ëAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Contact Address"
Left = 9
Top = 10
Width = 48
TabIndex = 11
Name = "lblContaddr"
      textbox      textbox      txtContaddr2      "SCHOOLS.Pgfbase1.Page4.contcontact      ∆Comment = ""
ControlSource = "cust.contaddr2"
Height = 23
Left = 69
MaxLength = 30
ReadOnly = .T.
TabIndex = 14
Top = 30
Width = 364
DisabledBackColor = 255,255,255
Name = "txtContaddr2"
      textbox      textbox      txtContcity      "SCHOOLS.Pgfbase1.Page4.contcontact      ƒComment = ""
ControlSource = "cust.contcity"
Height = 23
Left = 98
MaxLength = 16
ReadOnly = .T.
TabIndex = 16
Top = 54
Width = 120
DisabledBackColor = 255,255,255
Name = "txtContcity"
      label      label      lblContcity      "SCHOOLS.Pgfbase1.Page4.contcontact      áAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "City"
Left = 69
Top = 54
Width = 20
TabIndex = 15
Name = "lblContcity"
      textbox      textbox      txtContstate      "SCHOOLS.Pgfbase1.Page4.contcontact      ”Comment = ""
ControlSource = "cust.contstate"
Format = "!"
Height = 23
Left = 269
MaxLength = 3
ReadOnly = .T.
TabIndex = 18
Top = 54
Width = 33
DisabledBackColor = 255,255,255
Name = "txtContstate"
      label      label      lblContstate      "SCHOOLS.Pgfbase1.Page4.contcontact      äAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "State"
Left = 235
Top = 54
Width = 28
TabIndex = 17
Name = "lblContstate"
      textbox      textbox      
txtContzip      "SCHOOLS.Pgfbase1.Page4.contcontact      ‹Comment = ""
ControlSource = "cust.contzip"
Height = 23
InputMask = "99999-9999"
Left = 357
MaxLength = 10
ReadOnly = .T.
TabIndex = 20
Top = 54
Width = 76
DisabledBackColor = 255,255,255
Name = "txtContzip"
      label      label      
lblContzip      "SCHOOLS.Pgfbase1.Page4.contcontact      ÜAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Zip"
Left = 325
Top = 54
Width = 17
TabIndex = 19
Name = "lblContzip"
      textbox      textbox      txtContphnhom      "SCHOOLS.Pgfbase1.Page4.contcontact      ÂComment = ""
ControlSource = "cust.contphnhom"
Height = 23
InputMask = "(999)999-9999"
Left = 149
MaxLength = 14
ReadOnly = .T.
TabIndex = 22
Top = 77
Width = 91
DisabledBackColor = 255,255,255
Name = "txtContphnhom"
      label      label      lblContphnhom      "SCHOOLS.Pgfbase1.Page4.contcontact      èAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Home Phone"
Left = 69
Top = 77
Width = 73
TabIndex = 21
Name = "lblContphnhom"
      textbox      textbox      txtContphnwrk      "SCHOOLS.Pgfbase1.Page4.contcontact      ÚComment = ""
ControlSource = "cust.contphnwrk"
Height = 23
InputMask = "(999)999-9999XXXXXXXXXXXX"
Left = 148
MaxLength = 14
ReadOnly = .T.
TabIndex = 24
Top = 101
Width = 91
DisabledBackColor = 255,255,255
Name = "txtContphnwrk"
      label      label      lblContphnwrk      "SCHOOLS.Pgfbase1.Page4.contcontact      êAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Work Phone"
Left = 74
Top = 101
Width = 67
TabIndex = 23
Name = "lblContphnwrk"
      textbox      textbox      
txtContfax      "SCHOOLS.Pgfbase1.Page4.contcontact      ﬂComment = ""
ControlSource = "cust.contfax"
Height = 23
InputMask = "(999)999-9999"
Left = 342
MaxLength = 14
ReadOnly = .T.
TabIndex = 26
Top = 77
Width = 91
DisabledBackColor = 255,255,255
Name = "txtContfax"
      label      label      
lblContfax      "SCHOOLS.Pgfbase1.Page4.contcontact      ÜAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Fax"
Left = 318
Top = 77
Width = 19
TabIndex = 25
Name = "lblContfax"
      textbox      textbox      txtShiptocont      "SCHOOLS.Pgfbase1.Page4.contcontact      ÊComment = ""
ControlSource = "cust.shiptocont"
Format = "!"
Height = 23
InputMask = "Y"
Left = 403
MaxLength = 1
ReadOnly = .T.
TabIndex = 3
Top = 101
Width = 31
DisabledBackColor = 255,255,255
Name = "txtShiptocont"
      label      label      lblShiptocont      "SCHOOLS.Pgfbase1.Page4.contcontact      üAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Ship to Home"
Height = 17
Left = 321
Top = 102
Width = 75
TabIndex = 2
Name = "lblShiptocont"
      	container      	container      
contschool      SCHOOLS.Pgfbase1.Page4      UTop = 99
Left = 223
Width = 448
Height = 104
BackStyle = 0
Name = "contschool"
      textbox      textbox      
txtSchaddr      !SCHOOLS.Pgfbase1.Page4.contschool      ÊComment = ""
FontSize = 8
ControlSource = "cust.schaddr"
Height = 23
Left = 80
MaxLength = 50
ReadOnly = .T.
TabIndex = 37
Top = 4
Width = 364
DisabledBackColor = 255,255,255
BorderColor = 64,0,64
Name = "txtSchaddr"
      label      label      
lblSchaddr      !SCHOOLS.Pgfbase1.Page4.contschool      õAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "School Address"
Height = 32
Left = 6
Top = 8
Width = 48
TabIndex = 35
Name = "lblSchaddr"
      textbox      textbox      txtSchaddr2      !SCHOOLS.Pgfbase1.Page4.contschool      “Comment = ""
FontSize = 8
ControlSource = "cust.schaddr2"
Height = 23
Left = 80
MaxLength = 50
ReadOnly = .T.
TabIndex = 38
Top = 28
Width = 364
DisabledBackColor = 255,255,255
Name = "txtSchaddr2"
      `PROCEDURE GotFocus
set confirm on

ENDPROC
PROCEDURE LostFocus
set confirm off

ENDPROC
      Á˛Úˇ    Œ   Œ                         94   %   F       u      k           ¸  U  	  G	 ˛ U  	  G	˛ U   GotFocus,     ˇˇ	 LostFocus9     ˇˇ1 a 3 a 2                       $         D   U       )   Œ                         textbox      textbox      
txtSchcity      !SCHOOLS.Pgfbase1.Page4.contschool      √Comment = ""
ControlSource = "cust.schcity"
Height = 23
Left = 107
MaxLength = 16
ReadOnly = .T.
TabIndex = 39
Top = 52
Width = 120
DisabledBackColor = 255,255,255
Name = "txtSchcity"
      textbox      textbox      txtSchstate      !SCHOOLS.Pgfbase1.Page4.contschool      —Comment = ""
ControlSource = "cust.schstate"
Format = "!"
Height = 23
Left = 276
MaxLength = 3
ReadOnly = .T.
TabIndex = 40
Top = 52
Width = 33
DisabledBackColor = 255,255,255
Name = "txtSchstate"
      textbox      textbox      	txtSchzip      !SCHOOLS.Pgfbase1.Page4.contschool      ⁄Comment = ""
ControlSource = "cust.schzip"
Height = 23
InputMask = "99999-9999"
Left = 368
MaxLength = 10
ReadOnly = .T.
TabIndex = 41
Top = 52
Width = 76
DisabledBackColor = 255,255,255
Name = "txtSchzip"
      textbox      textbox      txtSchphone      !SCHOOLS.Pgfbase1.Page4.contschool      ÓComment = ""
ControlSource = "cust.schphone"
Height = 23
InputMask = "(999)999-9999XXXXXXXXXXXX"
Left = 125
MaxLength = 14
ReadOnly = .T.
TabIndex = 43
Top = 76
Width = 147
DisabledBackColor = 255,255,255
Name = "txtSchphone"
      label      label      lblSchphone      !SCHOOLS.Pgfbase1.Page4.contschool      àAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Phone"
Left = 80
Top = 80
Width = 36
TabIndex = 42
Name = "lblSchphone"
      textbox      textbox      	txtSchfax      !SCHOOLS.Pgfbase1.Page4.contschool      ﬁComment = ""
ControlSource = "cust.schfax"
Height = 23
InputMask = "(999)999-9999"
Left = 328
MaxLength = 14
ReadOnly = .T.
TabIndex = 45
Top = 76
Width = 115
DisabledBackColor = 255,255,255
Name = "txtSchfax"
      label      label      	lblSchfax      !SCHOOLS.Pgfbase1.Page4.contschool      ÖAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Fax"
Left = 295
Top = 80
Width = 19
TabIndex = 44
Name = "lblSchfax"
      label      label      Label1      !SCHOOLS.Pgfbase1.Page4.contschool      ÇAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "City"
Left = 80
Top = 57
Width = 20
TabIndex = 15
Name = "Label1"
      label      label      Label2      !SCHOOLS.Pgfbase1.Page4.contschool      ÑAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "State"
Left = 241
Top = 57
Width = 28
TabIndex = 17
Name = "Label2"
      label      label      Label3      !SCHOOLS.Pgfbase1.Page4.contschool      ÇAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Zip"
Left = 326
Top = 57
Width = 17
TabIndex = 19
Name = "Label3"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase7      SCHOOLS.Pgfbase1.Page4      =Caption = "School"
Left = 191
Top = 27
Name = "Lblbase7"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase8      SCHOOLS.Pgfbase1.Page4      FontBold = .T.
FontSize = 12
Caption = "Ship to Address:"
Height = 22
Left = 75
Top = 98
Width = 130
Name = "Lblbase8"
      	container      	container      
Container1      SCHOOLS.Pgfbase1.Page4      UTop = 235
Left = 19
Width = 800
Height = 288
BackStyle = 0
Name = "Container1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase2      !SCHOOLS.Pgfbase1.Page4.Container1      õRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item2"
Height = 24
Left = 27
Top = 134
Width = 200
Name = "Cbobase2"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase3      !SCHOOLS.Pgfbase1.Page4.Container1      õRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item3"
Height = 24
Left = 27
Top = 165
Width = 200
Name = "Cbobase3"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      !SCHOOLS.Pgfbase1.Page4.Container1      õRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item1"
Height = 24
Left = 27
Top = 102
Width = 200
Name = "Cbobase1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase4      !SCHOOLS.Pgfbase1.Page4.Container1      õRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item4"
Height = 24
Left = 27
Top = 198
Width = 200
Name = "Cbobase4"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase5      !SCHOOLS.Pgfbase1.Page4.Container1      õRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item5"
Height = 24
Left = 27
Top = 229
Width = 200
Name = "Cbobase5"
      textbox      textbox      txtQty1      !SCHOOLS.Pgfbase1.Page4.Container1      ÄComment = ""
ControlSource = "xsupplies.qty1"
Height = 23
Left = 235
TabIndex = 8
Top = 102
Width = 70
Name = "txtQty1"
      textbox      textbox      Text2      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty2"
Height = 23
Left = 235
TabIndex = 8
Top = 134
Width = 70
Name = "Text2"
      textbox      textbox      Text3      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty3"
Height = 23
Left = 235
TabIndex = 8
Top = 165
Width = 70
Name = "Text3"
      textbox      textbox      Text4      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty4"
Height = 23
Left = 235
TabIndex = 8
Top = 198
Width = 70
Name = "Text4"
      textbox      textbox      Text5      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty5"
Height = 23
Left = 235
TabIndex = 8
Top = 229
Width = 70
Name = "Text5"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase6      !SCHOOLS.Pgfbase1.Page4.Container1      úRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item6"
Height = 24
Left = 372
Top = 104
Width = 200
Name = "Cbobase6"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase7      !SCHOOLS.Pgfbase1.Page4.Container1      úRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item7"
Height = 24
Left = 372
Top = 136
Width = 200
Name = "Cbobase7"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase8      !SCHOOLS.Pgfbase1.Page4.Container1      úRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item8"
Height = 24
Left = 372
Top = 168
Width = 200
Name = "Cbobase8"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase9      !SCHOOLS.Pgfbase1.Page4.Container1      úRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item9"
Height = 24
Left = 371
Top = 198
Width = 200
Name = "Cbobase9"
      cbobase      ..\..\common60\basectrl.vcx      combobox      	Cbobase10      !SCHOOLS.Pgfbase1.Page4.Container1      ûRowSourceType = 6
RowSource = "lkpxitems.itemname"
ControlSource = "xsupplies.item10"
Height = 24
Left = 371
Top = 229
Width = 200
Name = "Cbobase10"
      textbox      textbox      Text6      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty6"
Height = 23
Left = 579
TabIndex = 8
Top = 102
Width = 70
Name = "Text6"
      textbox      textbox      Text7      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty7"
Height = 23
Left = 579
TabIndex = 8
Top = 134
Width = 70
Name = "Text7"
      textbox      textbox      Text8      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty8"
Height = 23
Left = 579
TabIndex = 8
Top = 165
Width = 70
Name = "Text8"
      textbox      textbox      Text9      !SCHOOLS.Pgfbase1.Page4.Container1      ~Comment = ""
ControlSource = "xsupplies.qty9"
Height = 23
Left = 579
TabIndex = 8
Top = 198
Width = 70
Name = "Text9"
      textbox      textbox      Text10      !SCHOOLS.Pgfbase1.Page4.Container1      ÄComment = ""
ControlSource = "xsupplies.qty10"
Height = 23
Left = 579
TabIndex = 8
Top = 229
Width = 70
Name = "Text10"
      label      label      lblItem1      !SCHOOLS.Pgfbase1.Page4.Container1      ∆AutoSize = .T.
FontBold = .T.
FontSize = 12
FontUnderline = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Items"
Height = 22
Left = 429
Top = 70
Width = 41
TabIndex = 5
Name = "lblItem1"
      label      label      lblQty1      !SCHOOLS.Pgfbase1.Page4.Container1      ªAutoSize = .T.
FontBold = .T.
FontSize = 12
FontUnderline = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Quantity"
Left = 583
Top = 70
Width = 64
TabIndex = 7
Name = "lblQty1"
      label      label      Label2      !SCHOOLS.Pgfbase1.Page4.Container1      √AutoSize = .T.
FontBold = .T.
FontSize = 12
FontUnderline = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Items"
Height = 22
Left = 84
Top = 70
Width = 41
TabIndex = 5
Name = "Label2"
      label      label      Label3      !SCHOOLS.Pgfbase1.Page4.Container1      ∫AutoSize = .T.
FontBold = .T.
FontSize = 12
FontUnderline = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Quantity"
Left = 237
Top = 70
Width = 64
TabIndex = 7
Name = "Label3"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase1      !SCHOOLS.Pgfbase1.Page4.Container1      RTop = 8
Left = 12
Height = 23
Width = 48
Caption = "New "
Name = "Cmdbase1"
      ˙PROCEDURE Click
select xsupplies
append blank
replace xsupplies.schcode with mcust.schcode
replace xsupplies.ddate with date()

if mquotes.contryear=mcust.contryear
mprodno=mquotes.prodno
else
mprodno=''
endif

thisform.refresh
ENDPROC
     é˛Úˇ    u  u                        Õ   %         ,               ¸  U  {  F˜  ˛ ˛ >Ù  ˜ —¸Ù ˜ ˝˛ >Ù  ˜ —¸C$˝˛ %¸Ù ˜ Ù ˜ ˝˘U ˛ T˜ ¸Ù ˜ ˝˛ ˘j ˛ T˜ ¸˚  ˝˛ ˛
 ôÙ ˜	 ˛ U
 	 XSUPPLIES SCHCODE MCUST DDATE MQUOTES	 CONTRYEAR MPRODNO PRODNO THISFORM REFRESH Click,     ˇˇ1 q Q 1Ò rÅ — A ¢ 1                       Ô       )   u                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase2      !SCHOOLS.Pgfbase1.Page4.Container1      TTop = 8
Left = 63
Height = 23
Width = 48
Caption = "Delete"
Name = "Cmdbase2"
      dPROCEDURE Click
select xsupplies
delete
select mcust
skip
skip-1

thisform.refresh
ENDPROC
     ˛Úˇ    Í   Í                         «(   %   Ç       °      ë           ¸  U  -  F˜  ˛ ˛ F˜ ˛ H˛
 H¸˘ˇˇ˝˛
 ôÙ ˜ ˛ U 	 XSUPPLIES MCUST THISFORM REFRESH Click,     ˇˇ1 q A q A ° ¢ 1                       Y       )   Í                         cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase3      !SCHOOLS.Pgfbase1.Page4.Container1      çTop = 8
Left = 375
Height = 23
Width = 24
Picture = d:\common60\previous.bmp
Caption = ""
ToolTipText = "Previous"
Name = "Cmdbase3"
     PROCEDURE Click
*
**skipping breaks relation ship so don't let it go past the first or last record for parent
select xsupplies
if !empty(xsupplies.schcode)
if !bof()
skip -1
if xsupplies.schcode<> mcust.schcode
skip 
endif
endif
endif
thisform.refresh
ENDPROC
     L˛Úˇ    3  3                        9   %   √       Í      “           ¸  U  e  F˜  ˛ %¸CÙ  ˜ °
˝˘T ˛ %¸C
˝˘P ˛
 H¸˘ˇˇ˝˛ %¸Ù  ˜ Ù ˜ ˝˘L ˛ H˛ ˛ ˛ ˛
 ôÙ ˜ ˛ U 	 XSUPPLIES SCHCODE MCUST THISFORM REFRESH Click,     ˇˇ1 s 1— ° qA A A A ° 1                             )   3                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase4      !SCHOOLS.Pgfbase1.Page4.Container1      ÖTop = 8
Left = 399
Height = 23
Width = 24
Picture = d:\common60\next.bmp
Caption = ""
ToolTipText = "Next"
Name = "Cmdbase4"
     PROCEDURE Click
*skipping breaks relation ship so don't let it go past the first or last record
select xsupplies
if !empty(xsupplies.schcode)
if !eof()
skip 
if xsupplies.schcode<> mcust.schcode
skip -1
endif
else
skip -1
endif
endif
thisform.refresh
ENDPROC
     b˛Úˇ    I  I                        d   %   ’             ‰           ¸  U  w  F˜  ˛ %¸CÙ  ˜ °
˝˘f ˛ %¸C+
˝˘P ˛ H˛ %¸Ù  ˜ Ù ˜ ˝˘L ˛
 H¸˘ˇˇ˝˛ ˛ ˘b ˛
 H¸˘ˇˇ˝˛ ˛ ˛
 ôÙ ˜ ˛ U 	 XSUPPLIES SCHCODE MCUST THISFORM REFRESH Click,     ˇˇ1 r 1— A q° A Å ° A A ° 1                             )   I                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase5      !SCHOOLS.Pgfbase1.Page4.Container1      ÖTop = 8
Left = 423
Height = 23
Width = 24
Picture = d:\common60\last.bmp
Caption = ""
ToolTipText = "Last"
Name = "Cmdbase5"
     GPROCEDURE Click
 ** put on last record entered
**skipping breaks relation ship so don't let it go past the last record for parent
select xsupplies
if !empty(xsupplies.schcode)
do while xsupplies.schcode=mcust.schcode
skip
enddo
skip -1 && has skipped 1 record past parent put it back
endif
thisform.refresh
ENDPROC
     8˛Úˇ                              Å   %   ≥       ÷   
   ¬           ¸  U  U  F˜  ˛ %¸CÙ  ˜ °
˝˘D ˛ +¸Ù  ˜ Ù ˜ ˝˘6 ˛ H˛ ˛
 H¸˘ˇˇ˝˛ ˛
 ôÙ ˜ ˛ U 	 XSUPPLIES SCHCODE MCUST THISFORM REFRESH Click,     ˇˇ1 s 1ÅA A ° A ° 1                       <      )                           cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase6      !SCHOOLS.Pgfbase1.Page4.Container1      áTop = 8
Left = 352
Height = 23
Width = 24
Picture = d:\common60\first.bmp
Caption = ""
ToolTipText = "First"
Name = "Cmdbase6"
     pPROCEDURE Click
 ** put on first record entered
**skipping breaks relation ship so don't let it go past the first record for parent

select xsupplies
if !empty(xsupplies.schcode)
do while xsupplies.schcode=mcust.schcode
if !bof()
skip -1
else
exit
endif
enddo
skip 1 && has skipped 1 record back past parent put it back
endif
thisform.refresh
ENDPROC
     b˛Úˇ    I  I                        d   %   ’             ‰           ¸  U  w  F˜  ˛ %¸CÙ  ˜ °
˝˘f ˛ +¸Ù  ˜ Ù ˜ ˝˘Y ˛ %¸C
˝˘I ˛
 H¸˘ˇˇ˝˛ ˘U ˛ !˛ ˛ ˛	 H¸¯˝˛ ˛
 ôÙ ˜ ˛ U 	 XSUPPLIES SCHCODE MCUST THISFORM REFRESH Click,     ˇˇ1 t 1Å— ° Å A A A ë A ° 1                       e      )   I                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase7      !SCHOOLS.Pgfbase1.Page4.Container1      TTop = 8
Left = 117
Height = 23
Width = 48
Caption = "Print"
Name = "Cmdbase7"
      .PROCEDURE Click
Thisform.printform
ENDPROC
      …˛Úˇ    ∞   ∞                         D   %   R       g      a           ¸  U   
 ôÙ  ˜ ˛ U  THISFORM	 PRINTFORM Click,     ˇˇ1 ° 1                       #       )   ∞                         cmdmailmanager      ..\mailmanager.vcx      commandbutton      Cmdmailmanager1      !SCHOOLS.Pgfbase1.Page4.Container1     Top = 8
Left = 171
Height = 21
Width = 48
Picture = d:\mbc5\mail.bmp
Caption = "Email"
ToolTipText = "Blank Body"
Visible = .F.
ndatabasetype = 1
cdatabase = m:\mbc5\mbc.dbc
ccursorsource = cust
maincursor = cust
currentrecordonly = .T.
emailperrecipient = .F.
forcepreview = .T.
unreadonly = .T.
settings_recipientname = 2|ALLTRIM(cust.contfname)+" "+ ALLTRIM(cust.contlname) 
settings_emailaddress = 2|ALLTRIM(Cust.contemail)
settings_subject = 2|alltrim(cust.schcode)+" "+alltrim(cust.schname)+" "+alltrim(cust.schstate)+" "+alltrim(cust.schstate)
settings_body = 
settings_attachment = 1|
settings_recipientnamecc = 1|
settings_recipientnamebcc = 1|
settings_emailaddresscc = 1|
settings_emailaddressbcc = 1|
recipientname = ALLTRIM(cust.contfname)+" "+ ALLTRIM(cust.contlname) 
emailaddress = ALLTRIM(Cust.contemail)
subject = alltrim(cust.schcode)+" "+alltrim(cust.schname)
body = 
attachment = 
recipientnamecc = 
recipientnamebcc = 
emailaddresscc = 
emailaddressbcc = 
Name = "Cmdmailmanager1"
     PROCEDURE Init
dodefault()
*repl mailtemp.mailltr with filetostr('m:\mbc5\email.txt')

ENDPROC
PROCEDURE Click
*Ensures that there is a name in the 1st advisor name fields, one or the other or both must be filled.
* If left empty the mail manager crashes
if empty(mcust.contfname) and empty(mcust.contlname)&&use data fields to test, textbox is not available on this page
nodefault
Messagebox("Please enter a name for the advisor name fields.",64,"Advisor Name Field")

else
dodefault()
endif
ENDPROC
     é˛Úˇ    u  u                        Õ   %   Î         
             ¸  U   	 ô¸CÍ°˝˛ U  é  %¸CÙ  ˜ °	 CÙ  ˜ °	˝˘v ˛ ¨˛T ô¸CŸ0 Please enter a name for the advisor name fields.¯@Ÿ Advisor Name FieldÍx˝˛ ˘á ˛	 ô¸CÍ°˝˛ ˛ U  MCUST	 CONTFNAME	 CONTLNAME Init,     ˇˇ Click<     ˇˇ1 ë 4 „A AÇ ë A 1                       Y         u   ˙      )   u                        textbox      textbox      txtDdate      !SCHOOLS.Pgfbase1.Page4.Container1      ±Comment = ""
ControlSource = "xsupplies.ddate"
Height = 23
Left = 697
ReadOnly = .T.
TabIndex = 4
Top = 9
Width = 80
DisabledBackColor = 255,255,255
Name = "txtDdate"
      label      label      lblDdate      !SCHOOLS.Pgfbase1.Page4.Container1      ãAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Date Entered"
Left = 617
Top = 9
Width = 72
TabIndex = 3
Name = "lblDdate"
      txtbase      ..\..\common60\basectrl.vcx      textbox      
txtprodnum      !SCHOOLS.Pgfbase1.Page4.Container1      êControlSource = "mprodno"
Height = 23
Left = 697
ReadOnly = .T.
Top = 36
Width = 92
DisabledBackColor = 255,255,255
Name = "txtprodnum"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase1      !SCHOOLS.Pgfbase1.Page4.Container1      ^Caption = "Production No."
Height = 17
Left = 610
Top = 36
Width = 83
Name = "Lblbase1"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase4      SCHOOLS.Pgfbase1.Page4      YCaption = "Last Name"
Height = 17
Left = 425
Top = 60
Width = 63
Name = "Lblbase4"
      label      label      Label1      SCHOOLS.Pgfbase1.Page5      ±AutoSize = .T.
FontBold = .T.
FontSize = 16
FontUnderline = .T.
BackStyle = 0
Caption = "Invoice Address"
Height = 27
Left = 393
Top = 49
Width = 166
Name = "Label1"
      textbox      textbox      
txtSchname      SCHOOLS.Pgfbase1.Page5     Comment = ""
FontBold = .T.
ControlSource = "mcust.schname"
Enabled = .F.
Format = "!"
Height = 23
Left = 344
MaxLength = 34
TabIndex = 20
Top = 78
Width = 255
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
BorderColor = 64,0,64
Name = "txtSchname"
     PROCEDURE LostFocus
m.schname=mcust.schname

thisform.pgfbase1.page1.txtschname.enabled=.f.
thisform.addnew=.f.
if mquotes.schcode=mcust.schcode
repl mquotes.schname with m.schname
sele mquotes
=tableupdate(.t.)
sele mcust
endif
thisform.refresh
ENDPROC
     ©˛Úˇ    ê  ê                        ã=   %         G     /          ¸  U  â  Tı˜  ¸Ù ˜  ˝˛ TÙ Ù Ù Ù ˜ ¸-˝˛ TÙ ˜ ¸-˝˛ %¸Ù ˜	 Ù ˜	 ˝˘x ˛ >Ù ˜  —¸ı˜  ˝˛ F˜ ˛
 Ü¸CaÍì˝˛ F˜ ˛ ˛
 ôÙ ˜
 ˛ U  SCHNAME MCUST THISFORM PGFBASE1 PAGE1
 TXTSCHNAME ENABLED ADDNEW MQUOTES SCHCODE REFRESH	 LostFocus,     ˇˇ1 !r· q!q ° q A ° 1                              )   ê                        checkbox      checkbox      Check1      SCHOOLS.Pgfbase1.Page5      ºTop = 79
Left = 166
Height = 17
Width = 158
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = "Same As School Address"
ControlSource = "mcust.invsameasschool"
Name = "Check1"
     áPROCEDURE Click
IF this.value=.t.
replace mcust.invname WITH mcust.schname
replace mcust.invaddr WITH mcust.schaddr
replace mcust.invaddr2 WITH mcust.schaddr2
replace mcust.invcity WITH mcust.schcity
replace mcust.invzip with mcust.schzip
replace mcust.invstate WITH mcust.schstate
replace mcust.invphone WITH mcust.schphone

this.Parent.continvaddress.Enabled=.f.
ELSE
this.Parent.continvaddress.Enabled=.t.
replace mcust.invaddr WITH ""
replace mcust.invaddr2 WITH ""
replace mcust.invcity WITH ""
replace mcust.invzip with ""
replace mcust.invstate WITH ""
replace mcust.invphone WITH ""

ENDIF
thisform.Refresh 
ENDPROC
     Õ˛Úˇ    ¥  ¥                        ¬±   %   2      k     A          ¸  U  8 %¸Ù  ˜ a˝˘´ ˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜	 —¸Ù ˜
 ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ TÙ  Ù Ù ˜ ¸-˝˛ ˘'˛ TÙ  Ù Ù ˜ ¸a˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜	 —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ ˛
 ôÙ ˜ ˛ U  THIS VALUE MCUST INVNAME SCHNAME INVADDR SCHADDR INVADDR2 SCHADDR2 INVCITY SCHCITY INVZIP SCHZIP INVSTATE SCHSTATE INVPHONE SCHPHONE PARENT CONTINVADDRESS ENABLED THISFORM REFRESH Click,     ˇˇ1 !1111111BÅ AB ° 1                       |      )   ¥                        	container      	container      continvaddress      SCHOOLS.Pgfbase1.Page5      ZTop = 138
Left = 152
Width = 624
Height = 120
BackStyle = 0
Name = "continvaddress"
      textbox      textbox      txtContaddr      %SCHOOLS.Pgfbase1.Page5.continvaddress      îComment = ""
ControlSource = "mcust.invaddr"
Height = 23
Left = 110
MaxLength = 30
TabIndex = 12
Top = 34
Width = 218
Name = "txtContaddr"
      label      label      lblContaddr      %SCHOOLS.Pgfbase1.Page5.continvaddress      äAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Address"
Left = 51
Top = 38
Width = 46
TabIndex = 11
Name = "lblContaddr"
      textbox      textbox      txtContaddr2      %SCHOOLS.Pgfbase1.Page5.continvaddress      ñComment = ""
ControlSource = "mcust.invaddr2"
Height = 23
Left = 350
MaxLength = 30
TabIndex = 14
Top = 34
Width = 218
Name = "txtContaddr2"
      textbox      textbox      txtContcity      %SCHOOLS.Pgfbase1.Page5.continvaddress      °Comment = ""
ControlSource = "mcust.invcity"
Format = ""
Height = 23
Left = 109
MaxLength = 21
TabIndex = 16
Top = 60
Width = 120
Name = "txtContcity"
      label      label      lblContcity      %SCHOOLS.Pgfbase1.Page5.continvaddress      áAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "City"
Left = 51
Top = 64
Width = 20
TabIndex = 15
Name = "lblContcity"
      textbox      textbox      txtContstate      %SCHOOLS.Pgfbase1.Page5.continvaddress      °Comment = ""
ControlSource = "mcust.invstate"
Format = ""
Height = 23
Left = 278
MaxLength = 3
TabIndex = 18
Top = 60
Width = 33
Name = "txtContstate"
      label      label      lblContstate      %SCHOOLS.Pgfbase1.Page5.continvaddress      äAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "State"
Left = 246
Top = 64
Width = 28
TabIndex = 17
Name = "lblContstate"
      textbox      textbox      
txtContzip      %SCHOOLS.Pgfbase1.Page5.continvaddress      ´Comment = ""
ControlSource = "mcust.invzip"
Height = 23
InputMask = "99999-9999"
Left = 362
MaxLength = 10
TabIndex = 20
Top = 60
Width = 76
Name = "txtContzip"
      label      label      
lblContzip      %SCHOOLS.Pgfbase1.Page5.continvaddress      ÜAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Zip"
Left = 337
Top = 64
Width = 17
TabIndex = 19
Name = "lblContzip"
      textbox      textbox      txtContphnhom      %SCHOOLS.Pgfbase1.Page5.continvaddress      ≥Comment = ""
ControlSource = "mcust.invphone"
Height = 23
InputMask = "(999)999-9999"
Left = 274
MaxLength = 14
TabIndex = 22
Top = 92
Width = 91
Name = "txtContphnhom"
      label      label      lblContphnwrk      %SCHOOLS.Pgfbase1.Page5.continvaddress      ãAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Phone"
Left = 225
Top = 96
Width = 36
TabIndex = 23
Name = "lblContphnwrk"
      txtbase      ..\..\common60\basectrl.vcx      textbox      Txtbase1      %SCHOOLS.Pgfbase1.Page5.continvaddress      ÅComment = ""
ControlSource = "mcust.invname"
Height = 23
Left = 111
MaxLength = 34
Top = 7
Width = 255
Name = "Txtbase1"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase1      %SCHOOLS.Pgfbase1.Page5.continvaddress      DCaption = "Name on Invoice"
Left = 12
Top = 7
Name = "Lblbase1"
      label      label      Label2      SCHOOLS.Pgfbase1.Page5      sAutoSize = .T.
BackStyle = 0
Caption = "Notes"
Height = 17
Left = 248
Top = 270
Width = 35
Name = "Label2"
      editbox      editbox      Edit1      SCHOOLS.Pgfbase1.Page5      cHeight = 60
Left = 296
Top = 270
Width = 456
ControlSource = "mcust.invnotes"
Name = "Edit1"
      ±PROCEDURE Valid

IF mquotes.invno=merinvoice.invno
replace merinvoice.invaddnote WITH mcust.invnotes 
SELECT merinvoice
TABLEUPDATE(.t.,.t.)
endif
SELECT mcust
ENDPROC
     4˛Úˇ                              #œ   %   ≥       “      ¬           ¸  U  J  %¸Ù  ˜ Ù ˜ ˝˘< ˛ >Ù ˜ —¸Ù ˜ ˝˛ F˜ ˛ ô¸CaaÍì˝˛ ˛ F˜ ˛ U  MQUOTES INVNO
 MERINVOICE
 INVADDNOTE MCUST INVNOTES Valid,     ˇˇ1 r1q ± A q 1                       ¶       )                           textbox      textbox      
txtSchname      SCHOOLS.Pgfbase1.Page6      ˇComment = ""
FontBold = .T.
ControlSource = "mcust.schname"
Enabled = .F.
Format = "!"
Height = 23
Left = 265
MaxLength = 34
TabIndex = 1
Top = 19
Width = 246
DisabledBackColor = 255,255,255
DisabledForeColor = 128,0,255
Name = "txtSchname"
      textbox      textbox      txtBooktype      SCHOOLS.Pgfbase1.Page6      °Comment = ""
ControlSource = "mcust.booktype"
Format = "!"
Height = 23
Left = 253
MaxLength = 4
TabIndex = 3
Top = 369
Width = 39
Name = "txtBooktype"
      label      label      lblBooktype      SCHOOLS.Pgfbase1.Page6      çAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Book Type"
Left = 188
Top = 372
Width = 56
TabIndex = 2
Name = "lblBooktype"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase1      SCHOOLS.Pgfbase1.Page6      cTop = 515
Left = 430
Height = 24
Width = 36
Caption = "Add"
TabIndex = 10
Name = "Cmdbase1"
      ‰PROCEDURE Click
oldsel=select()
mschcode=mcust.schcode
sele shipping
*if shipping.schcode<>mschcode
append blank
repl shipping.schcode with mschcode
=tableupdate()
*endif
sele (oldsel)
thisform.refresh



ENDPROC
     L˛Úˇ    3  3                        9   %   «       Í   
   ÷           ¸  U  X  T˜  ¸CW˝˛ T˜ ¸Ù ˜ ˝˛ F˜ ˛ ˛ >Ù ˜ —¸˜ ˝˛	 Ü¸CÍì˝˛
 F¸˜  ˝˛
 ôÙ ˜ ˛ U  OLDSEL MSCHCODE MCUST SCHCODE SHIPPING THISFORM REFRESH Click,     ˇˇ1 ¡ q R ë ¢ ° 4                       Ÿ       )   3                        grid      grid      grdShipping      SCHOOLS.Pgfbase1.Page6     üColumnCount = 9
Height = 143
Left = 188
RecordSource = "shipping"
RecordSourceType = 1
RowHeight = 25
TabIndex = 11
Top = 224
Width = 576
Name = "grdShipping"
Column1.ControlSource = "shipping.dteship"
Column1.Visible = .T.
Column1.Name = "Column2"
Column2.ControlSource = "shipping.nobooks"
Column2.Visible = .T.
Column2.Name = "Column3"
Column3.ControlSource = "shipping.itemshpd"
Column3.CurrentControl = "Cbobase1"
Column3.Width = 150
Column3.Visible = .T.
Column3.Name = "Column5"
Column4.ColumnOrder = 5
Column4.ControlSource = "shipping.via"
Column4.Visible = .T.
Column4.Name = "Column6"
Column5.ColumnOrder = 6
Column5.ControlSource = "shipping.weight"
Column5.Visible = .T.
Column5.Name = "Column7"
Column6.ColumnOrder = 7
Column6.ControlSource = "shipping.shptype"
Column6.Visible = .T.
Column6.Name = "Column8"
Column7.ColumnOrder = 8
Column7.ControlSource = "shipping.shpcost"
Column7.Visible = .T.
Column7.Name = "Column9"
Column8.ColumnOrder = 9
Column8.ControlSource = "shipping.trackno"
Column8.Width = 140
Column8.Name = "Column1"
Column9.ColumnOrder = 4
Column9.ControlSource = "shipping.nobox"
Column9.Name = "Column4"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column2      ,Caption = "Date Shipped"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column2      £BorderStyle = 0
Margin = 0
ToolTipText = "Click Right Mouse Button for Today's Date"
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      RPROCEDURE RightClick
repl shipping.dteship with date()
this.refresh

ENDPROC
      Ï˛Úˇ    ”   ”                         ‹   %   n       ä      Ç           ¸  U    >Ù  ˜ —¸C$˝˛
 ôÙ ˜ ˛ U  SHIPPING DTESHIP THIS REFRESH
 RightClick,     ˇˇ1 Ò ° 2                       G       )   ”                         header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column3      'Caption = "# Books"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column3      hBorderStyle = 0
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column5      ,Caption = "Item Shipped"
Name = "Header1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column5      âRowSourceType = 6
RowSource = "itemshpd.itm_descr"
Left = 29
Style = 0
Top = 34
BoundTo = .F.
DisplayCount = 0
Name = "Cbobase1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column6      #Caption = "Via"
Name = "Header1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column6      áRowSourceType = 6
RowSource = "shipper.shpr_name"
ControlSource = "shipping.via"
Left = 10
Style = 0
Top = 34
Name = "Cbobase1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column7      &Caption = "Weight"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column7      hBorderStyle = 0
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column8      )Caption = "Ship Type"
Name = "Header1"
      cbobase      ..\..\common60\basectrl.vcx      combobox      Cbobase1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column8      [RowSourceType = 6
RowSource = "shpprty.pri_name"
Left = 14
Top = 22
Name = "Cbobase1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column9      $Caption = "Cost"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column9      hBorderStyle = 0
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column1      *Caption = "Tracking #"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column1      }BorderStyle = 0
ControlSource = "shipping.trackno"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      header      header      Header1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column4      'Caption = "# Boxes"
Name = "Header1"
      textbox      textbox      Text1      *SCHOOLS.Pgfbase1.Page6.grdShipping.Column4      YBorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
      editbox      editbox      edtShipmemo      SCHOOLS.Pgfbase1.Page6      ÖComment = ""
Height = 75
Left = 189
TabIndex = 9
Top = 432
Width = 575
ControlSource = "mcust.shipmemo"
Name = "edtShipmemo"
      label      label      lblShipmemo      SCHOOLS.Pgfbase1.Page6      ìAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Shipping Notes"
Left = 189
Top = 413
Width = 85
TabIndex = 12
Name = "lblShipmemo"
      cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase2      SCHOOLS.Pgfbase1.Page6      UTop = 515
Left = 514
Height = 23
Width = 36
Caption = "Save"
Name = "Cmdbase2"
      nPROCEDURE Click
thisform.upsupdte
sele shipping
=tableupdate(.t.)
sele mcust
=tableupdate(.t.)
ENDPROC
     ˛Úˇ    Í   Í                         «(   %   Ñ       °      ì           ¸  U  / 
 ôÙ  ˜ ˛ F˜ ˛
 Ü¸CaÍì˝˛ F˜ ˛
 Ü¸CaÍì˝˛ U  THISFORM UPSUPDTE SHIPPING MCUST Click,     ˇˇ1 ° q ° q ° 1                       c       )   Í                         	container      	container      contaddress      SCHOOLS.Pgfbase1.Page6      VTop = 77
Left = 170
Width = 612
Height = 137
BackStyle = 0
Name = "contaddress"
      ÑPROCEDURE GotFocus
IF mcust.adshpaddr=.t.
this.Parent.check1.SetFocus 
this.Enabled=.f.
ELSE
this.Enabled=.t.
endif
ENDPROC
     <˛Úˇ    #  #                        h(   %   ∏       ⁄                  ¸  U  M  %¸Ù  ˜ a˝˘0 ˛ ôÙ Ù Ù ˜ ˛ TÙ ˜ ¸-˝˛ ˘F ˛ TÙ ˜ ¸a˝˛ ˛ U  MCUST	 ADSHPADDR THIS PARENT CHECK1 SETFOCUS ENABLED GotFocus,     ˇˇ1 !· Å · A 1                       y       )   #                        textbox      textbox      txtContaddr      "SCHOOLS.Pgfbase1.Page6.contaddress      îComment = ""
ControlSource = "mcust.shpaddr"
Height = 23
Left = 108
MaxLength = 30
TabIndex = 12
Top = 77
Width = 218
Name = "txtContaddr"
      label      label      lblContaddr      "SCHOOLS.Pgfbase1.Page6.contaddress      äAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Address"
Left = 49
Top = 81
Width = 46
TabIndex = 11
Name = "lblContaddr"
      textbox      textbox      txtContaddr2      "SCHOOLS.Pgfbase1.Page6.contaddress      ñComment = ""
ControlSource = "mcust.shpaddr2"
Height = 23
Left = 348
MaxLength = 30
TabIndex = 14
Top = 77
Width = 218
Name = "txtContaddr2"
      textbox      textbox      txtContcity      "SCHOOLS.Pgfbase1.Page6.contaddress      ¢Comment = ""
ControlSource = "mcust.shpcity"
Format = ""
Height = 23
Left = 107
MaxLength = 21
TabIndex = 16
Top = 103
Width = 120
Name = "txtContcity"
      label      label      lblContcity      "SCHOOLS.Pgfbase1.Page6.contaddress      àAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "City"
Left = 49
Top = 107
Width = 20
TabIndex = 15
Name = "lblContcity"
      textbox      textbox      txtContstate      "SCHOOLS.Pgfbase1.Page6.contaddress      ¢Comment = ""
ControlSource = "mcust.shpstate"
Format = ""
Height = 23
Left = 276
MaxLength = 3
TabIndex = 18
Top = 103
Width = 33
Name = "txtContstate"
      label      label      lblContstate      "SCHOOLS.Pgfbase1.Page6.contaddress      ãAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "State"
Left = 244
Top = 107
Width = 28
TabIndex = 17
Name = "lblContstate"
      textbox      textbox      
txtContzip      "SCHOOLS.Pgfbase1.Page6.contaddress      ¨Comment = ""
ControlSource = "mcust.shpzip"
Height = 23
InputMask = "99999-9999"
Left = 360
MaxLength = 10
TabIndex = 20
Top = 103
Width = 76
Name = "txtContzip"
      label      label      
lblContzip      "SCHOOLS.Pgfbase1.Page6.contaddress      áAutoSize = .T.
WordWrap = .T.
BackStyle = 0
Caption = "Zip"
Left = 335
Top = 107
Width = 17
TabIndex = 19
Name = "lblContzip"
      label      label      Label1      "SCHOOLS.Pgfbase1.Page6.contaddress      ÆAutoSize = .T.
FontBold = .T.
FontSize = 14
FontUnderline = .T.
BackStyle = 0
Caption = "Ship Address"
Height = 25
Left = 247
Top = 12
Width = 127
Name = "Label1"
      txtbase      ..\..\common60\basectrl.vcx      textbox      shpname      "SCHOOLS.Pgfbase1.Page6.contaddress      ÅComment = ""
ControlSource = "mcust.shpname"
Height = 23
Left = 109
MaxLength = 34
Top = 42
Width = 413
Name = "shpname"
      lblbase      ..\..\common60\basectrl.vcx      label      Lblbase1      "SCHOOLS.Pgfbase1.Page6.contaddress      :Caption = "Name"
Left = 66
Top = 42
Name = "Lblbase1"
      checkbox      checkbox      Check1      SCHOOLS.Pgfbase1.Page6      ÆTop = 54
Left = 174
Height = 17
Width = 109
AutoSize = .T.
Alignment = 0
BackStyle = 0
Caption = "Same As School"
ControlSource = "mcust.adshpaddr"
Name = "Check1"
     4PROCEDURE Click
IF this.value=.t.
replace mcust.shpname WITH mcust.schname 
replace mcust.shpaddr WITH mcust.schaddr
replace mcust.shpaddr2 WITH mcust.schaddr2
replace mcust.shpcity WITH mcust.schcity
replace mcust.shpzip with mcust.schzip
replace mcust.shpstate WITH mcust.schstate

this.Parent.contaddress.Enabled=.f.
ELSE
this.Parent.contaddress.Enabled=.t.
replace mcust.shpaddr WITH ""
replace mcust.shpaddr2 WITH ""
replace mcust.shpcity WITH ""
replace mcust.shpzip with ""
replace mcust.shpstate WITH ""
ENDIF
thisform.Refresh 
ENDPROC
     è˛Úˇ    v  v                        i   %   ¯      -               ¸  U   %¸Ù  ˜ a˝˘ò ˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜	 —¸Ù ˜
 ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ >Ù ˜ —¸Ù ˜ ˝˛ TÙ  Ù Ù ˜ ¸-˝˛ ˘˛ TÙ  Ù Ù ˜ ¸a˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜	 —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ >Ù ˜ —¸Ÿ  ˝˛ ˛
 ôÙ ˜ ˛ U  THIS VALUE MCUST SHPNAME SCHNAME SHPADDR SCHADDR SHPADDR2 SCHADDR2 SHPCITY SCHCITY SHPZIP SCHZIP SHPSTATE SCHSTATE PARENT CONTADDRESS ENABLED THISFORM REFRESH Click,     ˇˇ1 !111111BÅ AA ° 1                       )      )   v                        cmdbase      ..\..\common60\basectrl.vcx      commandbutton      Cmdbase6      SCHOOLS.Pgfbase1.Page6      åTop = 394
Left = 559
Height = 23
Width = 192
Caption = "UpDate Shipping Name/Address"
TabIndex = 96
Visible = .T.
Name = "Cmdbase6"
      /PROCEDURE Click
thisform.upsupdte

ENDPROC
      »˛Úˇ    Ø   Ø                         H–   %   Q       f      `           ¸  U   
 ôÙ  ˜ ˛ U  THISFORM UPSUPDTE Click,     ˇˇ1 ° 2                       $       )   Ø                         ≈Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 1, 8, 5, 14, 11, 29, 3, 0
Arial, 0, 8, 5, 14, 11, 29, 3, 0
Arial, 4, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 7, 4, 12, 9, 24, 3, 0
      '  foxpro.hÜ  π$ ..\registry.hé π$